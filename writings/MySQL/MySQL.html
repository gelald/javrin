<!DOCTYPE html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.48" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://gelald.github.io/javrin/javrin/writings/MySQL/MySQL.html"><meta property="og:site_name" content="Javrin"><meta property="og:title" content="åŸºç¡€çŸ¥è¯†"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-07-14T05:20:02.000Z"><meta property="og:locale" content="zh-CN"><meta property="article:modified_time" content="2022-07-14T05:20:02.000Z"><link rel="icon" href="/javrin/avataaars.ico"><title>åŸºç¡€çŸ¥è¯† | Javrin</title><meta name="description" content="Javrin çŸ¥è¯†åº“">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background-color: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="stylesheet" href="/javrin/assets/style.eff89a4c.css">
    <link rel="modulepreload" href="/javrin/assets/app.e724fc18.js"><link rel="modulepreload" href="/javrin/assets/MySQL.html.11a7c0d1.js"><link rel="modulepreload" href="/javrin/assets/plugin-vue_export-helper.21dcd24c.js"><link rel="modulepreload" href="/javrin/assets/MySQL.html.2fb153ad.js"><link rel="prefetch" href="/javrin/assets/index.html.77ee5188.js"><link rel="prefetch" href="/javrin/assets/home.html.3fb9fbb2.js"><link rel="prefetch" href="/javrin/assets/index.html.5aac91a4.js"><link rel="prefetch" href="/javrin/assets/disable.html.c7e3e16d.js"><link rel="prefetch" href="/javrin/assets/encrypt.html.d2660ea5.js"><link rel="prefetch" href="/javrin/assets/markdown.html.0e6d3ae4.js"><link rel="prefetch" href="/javrin/assets/page.html.c910b6f2.js"><link rel="prefetch" href="/javrin/assets/index.html.194af9f2.js"><link rel="prefetch" href="/javrin/assets/article10.html.98dce066.js"><link rel="prefetch" href="/javrin/assets/article11.html.ca609c0f.js"><link rel="prefetch" href="/javrin/assets/article12.html.e115caf0.js"><link rel="prefetch" href="/javrin/assets/article9.html.a1a67146.js"><link rel="prefetch" href="/javrin/assets/index.html.703b6440.js"><link rel="prefetch" href="/javrin/assets/article1.html.9b2af1ae.js"><link rel="prefetch" href="/javrin/assets/article2.html.ece2c58d.js"><link rel="prefetch" href="/javrin/assets/article3.html.96e3e960.js"><link rel="prefetch" href="/javrin/assets/article4.html.2a5f83b6.js"><link rel="prefetch" href="/javrin/assets/article5.html.f37af044.js"><link rel="prefetch" href="/javrin/assets/article6.html.a0622579.js"><link rel="prefetch" href="/javrin/assets/article7.html.252406bc.js"><link rel="prefetch" href="/javrin/assets/article8.html.62c704d3.js"><link rel="prefetch" href="/javrin/assets/Lambdaè¡¨è¾¾å¼ä¸å‡½æ•°å¼ç¼–ç¨‹.html.6f3156f9.js"><link rel="prefetch" href="/javrin/assets/Object.html.87436ccd.js"><link rel="prefetch" href="/javrin/assets/SPIæœºåˆ¶.html.29a41e48.js"><link rel="prefetch" href="/javrin/assets/Stream.html.f77aaafa.js"><link rel="prefetch" href="/javrin/assets/String.html.22762e1e.js"><link rel="prefetch" href="/javrin/assets/åå°„æœºåˆ¶.html.58a802bc.js"><link rel="prefetch" href="/javrin/assets/å¼‚å¸¸æœºåˆ¶.html.793a04dc.js"><link rel="prefetch" href="/javrin/assets/æ•°æ®ä¸è¿ç®—.html.2486df80.js"><link rel="prefetch" href="/javrin/assets/æ³›å‹æœºåˆ¶.html.4ff6f17d.js"><link rel="prefetch" href="/javrin/assets/é¢å‘å¯¹è±¡.html.f95067e7.js"><link rel="prefetch" href="/javrin/assets/é¢è¯•é¢˜æ€»ç»“.html.3c09e153.js"><link rel="prefetch" href="/javrin/assets/CMSæ”¶é›†å™¨.html.597c246b.js"><link rel="prefetch" href="/javrin/assets/G1æ”¶é›†å™¨.html.f15d2a93.js"><link rel="prefetch" href="/javrin/assets/Javaå†…å­˜æ¨¡å‹ä¸å¹¶å‘.html.0e241f81.js"><link rel="prefetch" href="/javrin/assets/å†…å­˜åˆ†æ.html.3afbed39.js"><link rel="prefetch" href="/javrin/assets/åƒåœ¾å›æ”¶åŸºç¡€.html.a5f52df1.js"><link rel="prefetch" href="/javrin/assets/å­—èŠ‚ç æ–‡ä»¶.html.ec6fb317.js"><link rel="prefetch" href="/javrin/assets/ç‰©ç†å†…å­˜æ¨¡å‹.html.cf8ee88d.js"><link rel="prefetch" href="/javrin/assets/ç±»åŠ è½½æœºåˆ¶.html.3aabe6f1.js"><link rel="prefetch" href="/javrin/assets/çº¿ç¨‹å †æ ˆåˆ†æ.html.d1383386.js"><link rel="prefetch" href="/javrin/assets/è¿è¡Œæ—¶å†…å­˜ç»“æ„.html.fa6a5238.js"><link rel="prefetch" href="/javrin/assets/ArrayDeque.html.92b431ed.js"><link rel="prefetch" href="/javrin/assets/ArrayList.html.4b52ff77.js"><link rel="prefetch" href="/javrin/assets/HashMap_HashSet.html.132f5f05.js"><link rel="prefetch" href="/javrin/assets/LinkedHashMap_LinkedHashSet.html.5dd602cf.js"><link rel="prefetch" href="/javrin/assets/LinkedList.html.da2f675c.js"><link rel="prefetch" href="/javrin/assets/PriorityQueue.html.a7e415f2.js"><link rel="prefetch" href="/javrin/assets/TreeMap_TreeSet.html.52d8b8ae.js"><link rel="prefetch" href="/javrin/assets/æ€»è§ˆ.html.6f22dd1f.js"><link rel="prefetch" href="/javrin/assets/MySQLä¼˜åŒ–.html.11c080d0.js"><link rel="prefetch" href="/javrin/assets/MySQLç´¢å¼•å¤±æ•ˆåœºæ™¯.html.c9f46096.js"><link rel="prefetch" href="/javrin/assets/åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–ä¸æ€è€ƒ.html.8a3ced5f.js"><link rel="prefetch" href="/javrin/assets/Spring_SpringBoot.html.78488dc6.js"><link rel="prefetch" href="/javrin/assets/Spring-thread-pool.html.2a7ea681.js"><link rel="prefetch" href="/javrin/assets/SpringBootæ ¸å¿ƒç»„ä»¶.html.72361da4.js"><link rel="prefetch" href="/javrin/assets/SpringMVC.html.e8afd34d.js"><link rel="prefetch" href="/javrin/assets/Springå®šæ—¶ä»»åŠ¡.html.e2747d65.js"><link rel="prefetch" href="/javrin/assets/Springæ³¨è§£ç¼–ç¨‹.html.22f747b7.js"><link rel="prefetch" href="/javrin/assets/Springé¢è¯•é¢˜.html.70bfbe22.js"><link rel="prefetch" href="/javrin/assets/pretty-controller.html.2ccf2c3c.js"><link rel="prefetch" href="/javrin/assets/æ‰‹å†™Spring.html.889af9db.js"><link rel="prefetch" href="/javrin/assets/SpringCloud.html.1ca84287.js"><link rel="prefetch" href="/javrin/assets/SpringCloudAlibaba.html.9ac0667a.js"><link rel="prefetch" href="/javrin/assets/SpringCloudGateway.html.734d0114.js"><link rel="prefetch" href="/javrin/assets/SpringCloudZookeeper.html.b8820271.js"><link rel="prefetch" href="/javrin/assets/JWT.html.10192ec7.js"><link rel="prefetch" href="/javrin/assets/OAuth2.html.463dc1e4.js"><link rel="prefetch" href="/javrin/assets/SpringSecurity.html.5841c548.js"><link rel="prefetch" href="/javrin/assets/dynamic-programming.html.193327e3.js"><link rel="prefetch" href="/javrin/assets/fibonacci.html.6799924a.js"><link rel="prefetch" href="/javrin/assets/moore-voting.html.00fdc436.js"><link rel="prefetch" href="/javrin/assets/Algorithm.html.19e8c5a5.js"><link rel="prefetch" href="/javrin/assets/HashMap.html.daf9788c.js"><link rel="prefetch" href="/javrin/assets/IO.html.b86134fa.js"><link rel="prefetch" href="/javrin/assets/JVM.html.f6c85e22.js"><link rel="prefetch" href="/javrin/assets/JavaEE.html.260604e3.js"><link rel="prefetch" href="/javrin/assets/JavaSE.html.27965b7d.js"><link rel="prefetch" href="/javrin/assets/MyBatis.html.29404924.js"><link rel="prefetch" href="/javrin/assets/PrimaryKey.html.da20a223.js"><link rel="prefetch" href="/javrin/assets/Redis.html.1ec7ee16.js"><link rel="prefetch" href="/javrin/assets/SpringDataJpa.html.948c8235.js"><link rel="prefetch" href="/javrin/assets/Swagger.html.520be39e.js"><link rel="prefetch" href="/javrin/assets/XML.html.ec853687.js"><link rel="prefetch" href="/javrin/assets/å¹¶å‘.html.09f1e602.js"><link rel="prefetch" href="/javrin/assets/æ¥å£.html.9084450a.js"><link rel="prefetch" href="/javrin/assets/æœåŠ¡.html.c9c57ba5.js"><link rel="prefetch" href="/javrin/assets/é›†åˆ.html.97740e12.js"><link rel="prefetch" href="/javrin/assets/is-thread-executed-in-executor.html.a9a6a60f.js"><link rel="prefetch" href="/javrin/assets/serial-to-parallel.html.71395340.js"><link rel="prefetch" href="/javrin/assets/thread-pool.html.7e884006.js"><link rel="prefetch" href="/javrin/assets/container-communication.html.6a3ec0c7.js"><link rel="prefetch" href="/javrin/assets/docker.html.0829d70b.js"><link rel="prefetch" href="/javrin/assets/modify-docker-default-storage.html.45004919.js"><link rel="prefetch" href="/javrin/assets/CAP-theory.html.e0fccd4b.js"><link rel="prefetch" href="/javrin/assets/distributed-lock.html.bc87b989.js"><link rel="prefetch" href="/javrin/assets/distributed-transaction.html.ae371124.js"><link rel="prefetch" href="/javrin/assets/MessageQueue.html.8c0ac9f8.js"><link rel="prefetch" href="/javrin/assets/RabbitMQ.html.c0e9e164.js"><link rel="prefetch" href="/javrin/assets/RocketMQ-interview.html.aeaaeeb2.js"><link rel="prefetch" href="/javrin/assets/RocketMQ-operation.html.a65d0b35.js"><link rel="prefetch" href="/javrin/assets/RocketMQ-start.html.12598a2f.js"><link rel="prefetch" href="/javrin/assets/RocketMQ-theory.html.ea4040c4.js"><link rel="prefetch" href="/javrin/assets/RocketMQ.html.e569f128.js"><link rel="prefetch" href="/javrin/assets/Git.html.ec06dcc2.js"><link rel="prefetch" href="/javrin/assets/Maven.html.bf0ceeda.js"><link rel="prefetch" href="/javrin/assets/UML.html.247c3163.js"><link rel="prefetch" href="/javrin/assets/ZooKeeperåˆ†å¸ƒå¼é”.html.46765f5b.js"><link rel="prefetch" href="/javrin/assets/Beanè‡ªåŠ¨æ˜ å°„.html.1a5c4d8e.js"><link rel="prefetch" href="/javrin/assets/Linux.html.f3287d5d.js"><link rel="prefetch" href="/javrin/assets/Network.html.bbe4d920.js"><link rel="prefetch" href="/javrin/assets/ä¸­ä»‹è€…æ¨¡å¼.html.aeabf30c.js"><link rel="prefetch" href="/javrin/assets/äº«å…ƒæ¨¡å¼.html.d7f0a4d6.js"><link rel="prefetch" href="/javrin/assets/ä»£ç†æ¨¡å¼.html.5af6d1f0.js"><link rel="prefetch" href="/javrin/assets/å•ä¾‹æ¨¡å¼.html.07e1f693.js"><link rel="prefetch" href="/javrin/assets/åŸå‹æ¨¡å¼.html.4d60efeb.js"><link rel="prefetch" href="/javrin/assets/å‘½ä»¤æ¨¡å¼.html.6b4aebcb.js"><link rel="prefetch" href="/javrin/assets/å¤‡å¿˜å½•æ¨¡å¼.html.2f28166d.js"><link rel="prefetch" href="/javrin/assets/å§”æ´¾æ¨¡å¼.html.0508511f.js"><link rel="prefetch" href="/javrin/assets/å·¥å‚æ¨¡å¼.html.90e0f26f.js"><link rel="prefetch" href="/javrin/assets/å»ºé€ è€…æ¨¡å¼.html.52633918.js"><link rel="prefetch" href="/javrin/assets/æ¡¥æ¥æ¨¡å¼.html.bbf21e0f.js"><link rel="prefetch" href="/javrin/assets/æ¨¡æ¿æ–¹æ³•æ¨¡å¼.html.589e3592.js"><link rel="prefetch" href="/javrin/assets/çŠ¶æ€æ¨¡å¼.html.eefc4f78.js"><link rel="prefetch" href="/javrin/assets/ç­–ç•¥æ¨¡å¼.html.62be1641.js"><link rel="prefetch" href="/javrin/assets/ç»„åˆæ¨¡å¼.html.dd2609e2.js"><link rel="prefetch" href="/javrin/assets/è£…é¥°å™¨æ¨¡å¼.html.bc3a8fd0.js"><link rel="prefetch" href="/javrin/assets/è§‚å¯Ÿè€…æ¨¡å¼.html.354245b4.js"><link rel="prefetch" href="/javrin/assets/è§£é‡Šå™¨æ¨¡å¼.html.3fc2817e.js"><link rel="prefetch" href="/javrin/assets/è®¾è®¡åŸåˆ™.html.c300043b.js"><link rel="prefetch" href="/javrin/assets/è®¾è®¡æ¨¡å¼æ€»è§ˆ.html.2deb5b2d.js"><link rel="prefetch" href="/javrin/assets/è®¿é—®è€…æ¨¡å¼.html.6b49a89c.js"><link rel="prefetch" href="/javrin/assets/è´£ä»»é“¾æ¨¡å¼.html.ff702f0d.js"><link rel="prefetch" href="/javrin/assets/è¿­ä»£å™¨æ¨¡å¼.html.46d34d41.js"><link rel="prefetch" href="/javrin/assets/é€‚é…å™¨æ¨¡å¼.html.731493c4.js"><link rel="prefetch" href="/javrin/assets/é—¨é¢æ¨¡å¼.html.0df12862.js"><link rel="prefetch" href="/javrin/assets/ç»¼åˆæ¡ˆä¾‹äº‹å.html.a3fcf141.js"><link rel="prefetch" href="/javrin/assets/404.html.fd533572.js"><link rel="prefetch" href="/javrin/assets/index.html.58b16885.js"><link rel="prefetch" href="/javrin/assets/index.html.a68fd036.js"><link rel="prefetch" href="/javrin/assets/index.html.f657d11f.js"><link rel="prefetch" href="/javrin/assets/index.html.db27eb87.js"><link rel="prefetch" href="/javrin/assets/index.html.d50e9056.js"><link rel="prefetch" href="/javrin/assets/index.html.43c2e592.js"><link rel="prefetch" href="/javrin/assets/index.html.54223465.js"><link rel="prefetch" href="/javrin/assets/index.html.be7a177d.js"><link rel="prefetch" href="/javrin/assets/index.html.9a7e43fb.js"><link rel="prefetch" href="/javrin/assets/index.html.9eabc93f.js"><link rel="prefetch" href="/javrin/assets/index.html.be1bdfa2.js"><link rel="prefetch" href="/javrin/assets/index.html.a762961e.js"><link rel="prefetch" href="/javrin/assets/index.html.ae3b676a.js"><link rel="prefetch" href="/javrin/assets/index.html.072b08c6.js"><link rel="prefetch" href="/javrin/assets/index.html.27ea51d9.js"><link rel="prefetch" href="/javrin/assets/index.html.29e4d19e.js"><link rel="prefetch" href="/javrin/assets/index.html.854a2e00.js"><link rel="prefetch" href="/javrin/assets/index.html.16939a61.js"><link rel="prefetch" href="/javrin/assets/index.html.b4f308a6.js"><link rel="prefetch" href="/javrin/assets/index.html.32d0b28d.js"><link rel="prefetch" href="/javrin/assets/index.html.fa24a9b7.js"><link rel="prefetch" href="/javrin/assets/index.html.a7a3b0c7.js"><link rel="prefetch" href="/javrin/assets/index.html.e9c05b92.js"><link rel="prefetch" href="/javrin/assets/index.html.1ed944ab.js"><link rel="prefetch" href="/javrin/assets/index.html.3d442681.js"><link rel="prefetch" href="/javrin/assets/index.html.68754340.js"><link rel="prefetch" href="/javrin/assets/index.html.693d4933.js"><link rel="prefetch" href="/javrin/assets/index.html.a98dbb66.js"><link rel="prefetch" href="/javrin/assets/index.html.0cb7da4e.js"><link rel="prefetch" href="/javrin/assets/index.html.e22bd898.js"><link rel="prefetch" href="/javrin/assets/index.html.0efce88b.js"><link rel="prefetch" href="/javrin/assets/index.html.fd8842fe.js"><link rel="prefetch" href="/javrin/assets/index.html.af627ba0.js"><link rel="prefetch" href="/javrin/assets/index.html.fa05ab36.js"><link rel="prefetch" href="/javrin/assets/index.html.65705e0a.js"><link rel="prefetch" href="/javrin/assets/index.html.19f6dff5.js"><link rel="prefetch" href="/javrin/assets/index.html.18d33c2a.js"><link rel="prefetch" href="/javrin/assets/index.html.76a21b8d.js"><link rel="prefetch" href="/javrin/assets/index.html.0247c002.js"><link rel="prefetch" href="/javrin/assets/index.html.12133386.js"><link rel="prefetch" href="/javrin/assets/index.html.505afaac.js"><link rel="prefetch" href="/javrin/assets/index.html.8a044ee8.js"><link rel="prefetch" href="/javrin/assets/index.html.f654363f.js"><link rel="prefetch" href="/javrin/assets/index.html.cde2fbc1.js"><link rel="prefetch" href="/javrin/assets/index.html.c8b27756.js"><link rel="prefetch" href="/javrin/assets/index.html.cd06afca.js"><link rel="prefetch" href="/javrin/assets/index.html.1d1b8e3c.js"><link rel="prefetch" href="/javrin/assets/index.html.37bcb607.js"><link rel="prefetch" href="/javrin/assets/index.html.572e0b1a.js"><link rel="prefetch" href="/javrin/assets/index.html.1591f17b.js"><link rel="prefetch" href="/javrin/assets/index.html.44cee601.js"><link rel="prefetch" href="/javrin/assets/home.html.80e1dac2.js"><link rel="prefetch" href="/javrin/assets/index.html.18b46aa4.js"><link rel="prefetch" href="/javrin/assets/disable.html.0ed6c06f.js"><link rel="prefetch" href="/javrin/assets/encrypt.html.2033f8f7.js"><link rel="prefetch" href="/javrin/assets/markdown.html.cc917581.js"><link rel="prefetch" href="/javrin/assets/page.html.028c86b7.js"><link rel="prefetch" href="/javrin/assets/index.html.aeee064c.js"><link rel="prefetch" href="/javrin/assets/article10.html.8862a0e8.js"><link rel="prefetch" href="/javrin/assets/article11.html.c3d1a005.js"><link rel="prefetch" href="/javrin/assets/article12.html.82865b21.js"><link rel="prefetch" href="/javrin/assets/article9.html.bf1495cf.js"><link rel="prefetch" href="/javrin/assets/index.html.f3946eb4.js"><link rel="prefetch" href="/javrin/assets/article1.html.5f9de624.js"><link rel="prefetch" href="/javrin/assets/article2.html.d6ce1a76.js"><link rel="prefetch" href="/javrin/assets/article3.html.09831522.js"><link rel="prefetch" href="/javrin/assets/article4.html.bb6aacde.js"><link rel="prefetch" href="/javrin/assets/article5.html.8bf3c695.js"><link rel="prefetch" href="/javrin/assets/article6.html.5bd85ac8.js"><link rel="prefetch" href="/javrin/assets/article7.html.07599530.js"><link rel="prefetch" href="/javrin/assets/article8.html.961412ac.js"><link rel="prefetch" href="/javrin/assets/Lambdaè¡¨è¾¾å¼ä¸å‡½æ•°å¼ç¼–ç¨‹.html.8066f79e.js"><link rel="prefetch" href="/javrin/assets/Object.html.995183f6.js"><link rel="prefetch" href="/javrin/assets/SPIæœºåˆ¶.html.162e104b.js"><link rel="prefetch" href="/javrin/assets/Stream.html.23816a47.js"><link rel="prefetch" href="/javrin/assets/String.html.f285b58d.js"><link rel="prefetch" href="/javrin/assets/åå°„æœºåˆ¶.html.697a9918.js"><link rel="prefetch" href="/javrin/assets/å¼‚å¸¸æœºåˆ¶.html.635eed3f.js"><link rel="prefetch" href="/javrin/assets/æ•°æ®ä¸è¿ç®—.html.6127e84e.js"><link rel="prefetch" href="/javrin/assets/æ³›å‹æœºåˆ¶.html.339839c2.js"><link rel="prefetch" href="/javrin/assets/é¢å‘å¯¹è±¡.html.c48ec78d.js"><link rel="prefetch" href="/javrin/assets/é¢è¯•é¢˜æ€»ç»“.html.b1ef780c.js"><link rel="prefetch" href="/javrin/assets/CMSæ”¶é›†å™¨.html.fb487df4.js"><link rel="prefetch" href="/javrin/assets/G1æ”¶é›†å™¨.html.f26149e7.js"><link rel="prefetch" href="/javrin/assets/Javaå†…å­˜æ¨¡å‹ä¸å¹¶å‘.html.d9ae0d86.js"><link rel="prefetch" href="/javrin/assets/å†…å­˜åˆ†æ.html.bf74fc85.js"><link rel="prefetch" href="/javrin/assets/åƒåœ¾å›æ”¶åŸºç¡€.html.05bf8770.js"><link rel="prefetch" href="/javrin/assets/å­—èŠ‚ç æ–‡ä»¶.html.81b5d748.js"><link rel="prefetch" href="/javrin/assets/ç‰©ç†å†…å­˜æ¨¡å‹.html.ceb854b2.js"><link rel="prefetch" href="/javrin/assets/ç±»åŠ è½½æœºåˆ¶.html.5d914ea1.js"><link rel="prefetch" href="/javrin/assets/çº¿ç¨‹å †æ ˆåˆ†æ.html.29806a4e.js"><link rel="prefetch" href="/javrin/assets/è¿è¡Œæ—¶å†…å­˜ç»“æ„.html.14391e29.js"><link rel="prefetch" href="/javrin/assets/ArrayDeque.html.4057dc3e.js"><link rel="prefetch" href="/javrin/assets/ArrayList.html.6f0cd21e.js"><link rel="prefetch" href="/javrin/assets/HashMap_HashSet.html.d4d24be0.js"><link rel="prefetch" href="/javrin/assets/LinkedHashMap_LinkedHashSet.html.efaf7276.js"><link rel="prefetch" href="/javrin/assets/LinkedList.html.c38d2adc.js"><link rel="prefetch" href="/javrin/assets/PriorityQueue.html.5957b495.js"><link rel="prefetch" href="/javrin/assets/TreeMap_TreeSet.html.95585667.js"><link rel="prefetch" href="/javrin/assets/æ€»è§ˆ.html.5482d83f.js"><link rel="prefetch" href="/javrin/assets/MySQLä¼˜åŒ–.html.02e554a6.js"><link rel="prefetch" href="/javrin/assets/MySQLç´¢å¼•å¤±æ•ˆåœºæ™¯.html.80e1fce5.js"><link rel="prefetch" href="/javrin/assets/åˆ†é¡µæŸ¥è¯¢ä¼˜åŒ–ä¸æ€è€ƒ.html.4f781d17.js"><link rel="prefetch" href="/javrin/assets/Spring_SpringBoot.html.df8d9192.js"><link rel="prefetch" href="/javrin/assets/Spring-thread-pool.html.ba41cefe.js"><link rel="prefetch" href="/javrin/assets/SpringBootæ ¸å¿ƒç»„ä»¶.html.cb88f0ac.js"><link rel="prefetch" href="/javrin/assets/SpringMVC.html.84eb5c56.js"><link rel="prefetch" href="/javrin/assets/Springå®šæ—¶ä»»åŠ¡.html.a16bd477.js"><link rel="prefetch" href="/javrin/assets/Springæ³¨è§£ç¼–ç¨‹.html.0177fec1.js"><link rel="prefetch" href="/javrin/assets/Springé¢è¯•é¢˜.html.64263b66.js"><link rel="prefetch" href="/javrin/assets/pretty-controller.html.8f719e58.js"><link rel="prefetch" href="/javrin/assets/æ‰‹å†™Spring.html.771cd35d.js"><link rel="prefetch" href="/javrin/assets/SpringCloud.html.48708054.js"><link rel="prefetch" href="/javrin/assets/SpringCloudAlibaba.html.693de701.js"><link rel="prefetch" href="/javrin/assets/SpringCloudGateway.html.17c5734e.js"><link rel="prefetch" href="/javrin/assets/SpringCloudZookeeper.html.c8a1789d.js"><link rel="prefetch" href="/javrin/assets/JWT.html.0d45343d.js"><link rel="prefetch" href="/javrin/assets/OAuth2.html.3dbccdd2.js"><link rel="prefetch" href="/javrin/assets/SpringSecurity.html.e42215e2.js"><link rel="prefetch" href="/javrin/assets/dynamic-programming.html.a6f930e2.js"><link rel="prefetch" href="/javrin/assets/fibonacci.html.ebf98abc.js"><link rel="prefetch" href="/javrin/assets/moore-voting.html.64f3d5de.js"><link rel="prefetch" href="/javrin/assets/Algorithm.html.4b8a2a24.js"><link rel="prefetch" href="/javrin/assets/HashMap.html.c0a1eb5d.js"><link rel="prefetch" href="/javrin/assets/IO.html.41efa197.js"><link rel="prefetch" href="/javrin/assets/JVM.html.d746be03.js"><link rel="prefetch" href="/javrin/assets/JavaEE.html.8a5a7f01.js"><link rel="prefetch" href="/javrin/assets/JavaSE.html.1b088d70.js"><link rel="prefetch" href="/javrin/assets/MyBatis.html.b0f2d2a1.js"><link rel="prefetch" href="/javrin/assets/PrimaryKey.html.bec36801.js"><link rel="prefetch" href="/javrin/assets/Redis.html.c58fac1d.js"><link rel="prefetch" href="/javrin/assets/SpringDataJpa.html.60ec45cb.js"><link rel="prefetch" href="/javrin/assets/Swagger.html.1bee66b9.js"><link rel="prefetch" href="/javrin/assets/XML.html.481f3f46.js"><link rel="prefetch" href="/javrin/assets/å¹¶å‘.html.b83bc9e5.js"><link rel="prefetch" href="/javrin/assets/æ¥å£.html.6dfde372.js"><link rel="prefetch" href="/javrin/assets/æœåŠ¡.html.c612c367.js"><link rel="prefetch" href="/javrin/assets/é›†åˆ.html.09c731c0.js"><link rel="prefetch" href="/javrin/assets/is-thread-executed-in-executor.html.bbddca17.js"><link rel="prefetch" href="/javrin/assets/serial-to-parallel.html.6c5ef4b0.js"><link rel="prefetch" href="/javrin/assets/thread-pool.html.afd316cf.js"><link rel="prefetch" href="/javrin/assets/container-communication.html.62acdfe5.js"><link rel="prefetch" href="/javrin/assets/docker.html.f43cbe07.js"><link rel="prefetch" href="/javrin/assets/modify-docker-default-storage.html.4f6d8334.js"><link rel="prefetch" href="/javrin/assets/CAP-theory.html.0a074a3c.js"><link rel="prefetch" href="/javrin/assets/distributed-lock.html.dc2954cb.js"><link rel="prefetch" href="/javrin/assets/distributed-transaction.html.6772259f.js"><link rel="prefetch" href="/javrin/assets/MessageQueue.html.63a534a1.js"><link rel="prefetch" href="/javrin/assets/RabbitMQ.html.4a9f99a4.js"><link rel="prefetch" href="/javrin/assets/RocketMQ-interview.html.2066ada7.js"><link rel="prefetch" href="/javrin/assets/RocketMQ-operation.html.61e7b1f6.js"><link rel="prefetch" href="/javrin/assets/RocketMQ-start.html.a4e432b2.js"><link rel="prefetch" href="/javrin/assets/RocketMQ-theory.html.b3f243b0.js"><link rel="prefetch" href="/javrin/assets/RocketMQ.html.a6a8e30f.js"><link rel="prefetch" href="/javrin/assets/Git.html.0b452b32.js"><link rel="prefetch" href="/javrin/assets/Maven.html.3f0cb6d7.js"><link rel="prefetch" href="/javrin/assets/UML.html.630cf0c9.js"><link rel="prefetch" href="/javrin/assets/ZooKeeperåˆ†å¸ƒå¼é”.html.3c9bceaf.js"><link rel="prefetch" href="/javrin/assets/Beanè‡ªåŠ¨æ˜ å°„.html.f7a013f7.js"><link rel="prefetch" href="/javrin/assets/Linux.html.636a209f.js"><link rel="prefetch" href="/javrin/assets/Network.html.8f5c4585.js"><link rel="prefetch" href="/javrin/assets/ä¸­ä»‹è€…æ¨¡å¼.html.bce21418.js"><link rel="prefetch" href="/javrin/assets/äº«å…ƒæ¨¡å¼.html.bfa84d50.js"><link rel="prefetch" href="/javrin/assets/ä»£ç†æ¨¡å¼.html.fad06961.js"><link rel="prefetch" href="/javrin/assets/å•ä¾‹æ¨¡å¼.html.985647bb.js"><link rel="prefetch" href="/javrin/assets/åŸå‹æ¨¡å¼.html.7268aedb.js"><link rel="prefetch" href="/javrin/assets/å‘½ä»¤æ¨¡å¼.html.2215a63d.js"><link rel="prefetch" href="/javrin/assets/å¤‡å¿˜å½•æ¨¡å¼.html.520054df.js"><link rel="prefetch" href="/javrin/assets/å§”æ´¾æ¨¡å¼.html.5942e1f3.js"><link rel="prefetch" href="/javrin/assets/å·¥å‚æ¨¡å¼.html.738610b7.js"><link rel="prefetch" href="/javrin/assets/å»ºé€ è€…æ¨¡å¼.html.1c8b4931.js"><link rel="prefetch" href="/javrin/assets/æ¡¥æ¥æ¨¡å¼.html.d0016828.js"><link rel="prefetch" href="/javrin/assets/æ¨¡æ¿æ–¹æ³•æ¨¡å¼.html.66382232.js"><link rel="prefetch" href="/javrin/assets/çŠ¶æ€æ¨¡å¼.html.cd57ad3f.js"><link rel="prefetch" href="/javrin/assets/ç­–ç•¥æ¨¡å¼.html.d6304514.js"><link rel="prefetch" href="/javrin/assets/ç»„åˆæ¨¡å¼.html.93c0e942.js"><link rel="prefetch" href="/javrin/assets/è£…é¥°å™¨æ¨¡å¼.html.ea400f6b.js"><link rel="prefetch" href="/javrin/assets/è§‚å¯Ÿè€…æ¨¡å¼.html.dfda286f.js"><link rel="prefetch" href="/javrin/assets/è§£é‡Šå™¨æ¨¡å¼.html.74f4f499.js"><link rel="prefetch" href="/javrin/assets/è®¾è®¡åŸåˆ™.html.437b010e.js"><link rel="prefetch" href="/javrin/assets/è®¾è®¡æ¨¡å¼æ€»è§ˆ.html.80263b6f.js"><link rel="prefetch" href="/javrin/assets/è®¿é—®è€…æ¨¡å¼.html.d8b6de32.js"><link rel="prefetch" href="/javrin/assets/è´£ä»»é“¾æ¨¡å¼.html.da60762b.js"><link rel="prefetch" href="/javrin/assets/è¿­ä»£å™¨æ¨¡å¼.html.097c3a45.js"><link rel="prefetch" href="/javrin/assets/é€‚é…å™¨æ¨¡å¼.html.6056e66a.js"><link rel="prefetch" href="/javrin/assets/é—¨é¢æ¨¡å¼.html.8155e63e.js"><link rel="prefetch" href="/javrin/assets/ç»¼åˆæ¡ˆä¾‹äº‹å.html.76664a8d.js"><link rel="prefetch" href="/javrin/assets/404.html.ff871bd1.js"><link rel="prefetch" href="/javrin/assets/index.html.8f1f4448.js"><link rel="prefetch" href="/javrin/assets/index.html.ba9f914f.js"><link rel="prefetch" href="/javrin/assets/index.html.0aa3a465.js"><link rel="prefetch" href="/javrin/assets/index.html.32fb0b94.js"><link rel="prefetch" href="/javrin/assets/index.html.f24f6d46.js"><link rel="prefetch" href="/javrin/assets/index.html.ae5e48d6.js"><link rel="prefetch" href="/javrin/assets/index.html.93a5e8c8.js"><link rel="prefetch" href="/javrin/assets/index.html.9a84a574.js"><link rel="prefetch" href="/javrin/assets/index.html.5f88285c.js"><link rel="prefetch" href="/javrin/assets/index.html.b31910b3.js"><link rel="prefetch" href="/javrin/assets/index.html.9350323f.js"><link rel="prefetch" href="/javrin/assets/index.html.48a31d0e.js"><link rel="prefetch" href="/javrin/assets/index.html.4cb22318.js"><link rel="prefetch" href="/javrin/assets/index.html.565ad25b.js"><link rel="prefetch" href="/javrin/assets/index.html.a405606b.js"><link rel="prefetch" href="/javrin/assets/index.html.3293218a.js"><link rel="prefetch" href="/javrin/assets/index.html.a50372db.js"><link rel="prefetch" href="/javrin/assets/index.html.68350e3b.js"><link rel="prefetch" href="/javrin/assets/index.html.f6a7eafb.js"><link rel="prefetch" href="/javrin/assets/index.html.07493186.js"><link rel="prefetch" href="/javrin/assets/index.html.0d3e2d81.js"><link rel="prefetch" href="/javrin/assets/index.html.d45de77b.js"><link rel="prefetch" href="/javrin/assets/index.html.c783b25e.js"><link rel="prefetch" href="/javrin/assets/index.html.20108a0e.js"><link rel="prefetch" href="/javrin/assets/index.html.8d0b84d3.js"><link rel="prefetch" href="/javrin/assets/index.html.b2ebac5b.js"><link rel="prefetch" href="/javrin/assets/index.html.4cfc0112.js"><link rel="prefetch" href="/javrin/assets/index.html.6da3f996.js"><link rel="prefetch" href="/javrin/assets/index.html.104c49ab.js"><link rel="prefetch" href="/javrin/assets/index.html.2c5100d6.js"><link rel="prefetch" href="/javrin/assets/index.html.3c8a35b5.js"><link rel="prefetch" href="/javrin/assets/index.html.49b1c3c0.js"><link rel="prefetch" href="/javrin/assets/index.html.474777b4.js"><link rel="prefetch" href="/javrin/assets/index.html.00df3f01.js"><link rel="prefetch" href="/javrin/assets/index.html.ebf080cb.js"><link rel="prefetch" href="/javrin/assets/index.html.ed9346c4.js"><link rel="prefetch" href="/javrin/assets/index.html.70b8b88c.js"><link rel="prefetch" href="/javrin/assets/index.html.127a2536.js"><link rel="prefetch" href="/javrin/assets/index.html.136878d6.js"><link rel="prefetch" href="/javrin/assets/index.html.02049daf.js"><link rel="prefetch" href="/javrin/assets/index.html.6cc8c914.js"><link rel="prefetch" href="/javrin/assets/index.html.a325457a.js"><link rel="prefetch" href="/javrin/assets/index.html.25521c10.js"><link rel="prefetch" href="/javrin/assets/index.html.3ac818bd.js"><link rel="prefetch" href="/javrin/assets/index.html.3ea42312.js"><link rel="prefetch" href="/javrin/assets/index.html.0da30468.js"><link rel="prefetch" href="/javrin/assets/index.html.b6b4b025.js"><link rel="prefetch" href="/javrin/assets/index.html.ad409790.js"><link rel="prefetch" href="/javrin/assets/index.html.4f68b8a5.js"><link rel="prefetch" href="/javrin/assets/index.html.256fdd73.js"><link rel="prefetch" href="/javrin/assets/404.24939123.js"><link rel="prefetch" href="/javrin/assets/Layout.17bc5953.js"><link rel="prefetch" href="/javrin/assets/Blog.5b5dc532.js"><link rel="prefetch" href="/javrin/assets/giscus.es.b79aa1b4.js"><link rel="prefetch" href="/javrin/assets/photoswipe.esm.351abe37.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!----><a href="/javrin/" class="brand"><img class="logo" src="/javrin/logo.svg" alt="Javrin"><!----><span class="site-name hide-in-pad">Javrin</span></a><!----></div><div class="navbar-center"><!----><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/javrin/" class="nav-link" aria-label="ä¸»é¡µ"><span class="icon iconfont icon-home" style=""></span>ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><a href="/javrin/writings" class="nav-link active" aria-label="åšå®¢æ–‡ç« "><span class="icon iconfont icon-list" style=""></span>åšå®¢æ–‡ç« <!----></a></div><div class="nav-item hide-in-mobile"><a href="/javrin/learning" class="nav-link" aria-label="å­¦ä¹ é¡¹ç›®"><span class="icon iconfont icon-computer" style=""></span>å­¦ä¹ é¡¹ç›®<!----></a></div><div class="nav-item hide-in-mobile"><a href="https://vuepress-theme-hope.github.io/v2/zh/" rel="noopener noreferrer" target="_blank" aria-label="ä¸»é¢˜æ–‡æ¡£" class="nav-link"><span class="icon iconfont icon-note" style=""></span>ä¸»é¢˜æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div></nav><!----></div><div class="navbar-right"><!----><!----><div class="nav-item"><a class="repo-link" href="https://github.com/gelald/javrin" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!----><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/javrin/" class="nav-link sidebar-link sidebar-page" aria-label="ä¸»é¡µ"><span class="icon iconfont icon-home" style=""></span>ä¸»é¡µ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-list" style=""></span><a href="/javrin/writings/" class="title">åšå®¢æ–‡ç« </a><span class="arrow right"></span></button><!----></section><!--]--></li><li><!--[--><section class="sidebar-group"><p class="sidebar-heading clickable"><span class="icon iconfont icon-computer" style=""></span><a href="/javrin/learning/" class="title">å­¦ä¹ é¡¹ç›®</a><!----></p><ul class="sidebar-links"></ul></section><!--]--></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->åŸºç¡€çŸ¥è¯†</h1><div class="page-info"><span class="author-info" aria-label="ä½œè€…ğŸ–Š" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="author-item" href="https://github.com/gelald" target="_blank" rel="noopener noreferrer">gelald</a></span><span property="author" content="gelald"></span></span><!----><!----><!----><!----><span class="reading-time-info" aria-label="é˜…è¯»æ—¶é—´âŒ›" data-balloon-pos="down" isoriginal="false" pageview="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>å¤§çº¦ 79 åˆ†é’Ÿ</span><meta property="timeRequired" content="PT79M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">æ­¤é¡µå†…å®¹</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ•°æ®ç±»å‹" class="router-link-active router-link-exact-active toc-link level2">æ•°æ®ç±»å‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ddl" class="router-link-active router-link-exact-active toc-link level2">DDL</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ“ä½œæ•°æ®åº“" class="router-link-active router-link-exact-active toc-link level3">æ“ä½œæ•°æ®åº“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ“ä½œè¡¨" class="router-link-active router-link-exact-active toc-link level3">æ“ä½œè¡¨</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#dml" class="router-link-active router-link-exact-active toc-link level2">DML</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ·»åŠ æ•°æ®" class="router-link-active router-link-exact-active toc-link level3">æ·»åŠ æ•°æ®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#åˆ é™¤æ•°æ®" class="router-link-active router-link-exact-active toc-link level3">åˆ é™¤æ•°æ®</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ä¿®æ”¹æ•°æ®" class="router-link-active router-link-exact-active toc-link level3">ä¿®æ”¹æ•°æ®</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#dql" class="router-link-active router-link-exact-active toc-link level2">DQL</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#åŸºæœ¬è¯­æ³•" class="router-link-active router-link-exact-active toc-link level3">åŸºæœ¬è¯­æ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#åŸºç¡€æŸ¥è¯¢" class="router-link-active router-link-exact-active toc-link level3">åŸºç¡€æŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ¡ä»¶æŸ¥è¯¢" class="router-link-active router-link-exact-active toc-link level3">æ¡ä»¶æŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ¨¡ç³ŠæŸ¥è¯¢" class="router-link-active router-link-exact-active toc-link level3">æ¨¡ç³ŠæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ’åºæŸ¥è¯¢" class="router-link-active router-link-exact-active toc-link level3">æ’åºæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#èšåˆå‡½æ•°" class="router-link-active router-link-exact-active toc-link level3">èšåˆå‡½æ•°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#åˆ†ç»„æŸ¥è¯¢" class="router-link-active router-link-exact-active toc-link level3">åˆ†ç»„æŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#åˆ†é¡µæŸ¥è¯¢" class="router-link-active router-link-exact-active toc-link level3">åˆ†é¡µæŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#åˆå¹¶æŸ¥è¯¢" class="router-link-active router-link-exact-active toc-link level3">åˆå¹¶æŸ¥è¯¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å¤šè¡¨æŸ¥è¯¢" class="router-link-active router-link-exact-active toc-link level3">å¤šè¡¨æŸ¥è¯¢-----</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#dcl" class="router-link-active router-link-exact-active toc-link level2">DCL</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ç®¡ç†å‘˜æˆ·" class="router-link-active router-link-exact-active toc-link level3">ç®¡ç†å‘˜æˆ·</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æˆæƒ" class="router-link-active router-link-exact-active toc-link level3">æˆæƒ</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#çº¦æŸ" class="router-link-active router-link-exact-active toc-link level2">çº¦æŸ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#åˆ†ç±»" class="router-link-active router-link-exact-active toc-link level3">åˆ†ç±»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#éç©ºçº¦æŸ-not-null" class="router-link-active router-link-exact-active toc-link level3">éç©ºçº¦æŸ not null</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å”¯ä¸€çº¦æŸ-unique" class="router-link-active router-link-exact-active toc-link level3">å”¯ä¸€çº¦æŸ unique</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ä¸»é”®çº¦æŸ-primary-key" class="router-link-active router-link-exact-active toc-link level3">ä¸»é”®çº¦æŸ primary key</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å¤–é”®çº¦æŸ-foreign-key" class="router-link-active router-link-exact-active toc-link level3">å¤–é”®çº¦æŸ foreign key</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ•°æ®åº“è¿˜åŸä¸å¤‡ä»½" class="router-link-active router-link-exact-active toc-link level2">æ•°æ®åº“è¿˜åŸä¸å¤‡ä»½</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#select-è¯­å¥å®Œæ•´çš„æ‰§è¡Œé¡ºåº" class="router-link-active router-link-exact-active toc-link level2">select è¯­å¥å®Œæ•´çš„æ‰§è¡Œé¡ºåº</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#inå’ŒexistsåŒºåˆ«" class="router-link-active router-link-exact-active toc-link level2">Inå’ŒExistsåŒºåˆ«</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#in" class="router-link-active router-link-exact-active toc-link level3">In</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#exists" class="router-link-active router-link-exact-active toc-link level3">Exists</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#åº”ç”¨åœºæ™¯" class="router-link-active router-link-exact-active toc-link level3">åº”ç”¨åœºæ™¯</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å¸¸ç”¨æ“ä½œ" class="router-link-active router-link-exact-active toc-link level2">å¸¸ç”¨æ“ä½œ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å­—ç¬¦ä¸²æˆªå–" class="router-link-active router-link-exact-active toc-link level3">å­—ç¬¦ä¸²æˆªå–</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ç±»å‹è½¬æ¢" class="router-link-active router-link-exact-active toc-link level3">ç±»å‹è½¬æ¢</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å­—æ®µé€’å¢èµ‹å€¼" class="router-link-active router-link-exact-active toc-link level3">å­—æ®µé€’å¢èµ‹å€¼</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ ¼å¼åŒ–å­—ç¬¦ä¸²è¡¥0" class="router-link-active router-link-exact-active toc-link level3">æ ¼å¼åŒ–å­—ç¬¦ä¸²è¡¥0</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#explainè§£æ" class="router-link-active router-link-exact-active toc-link level2">explainè§£æ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#id" class="router-link-active router-link-exact-active toc-link level3">id</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#select-type" class="router-link-active router-link-exact-active toc-link level3">select_type</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#type-è¿æ¥ç±»å‹" class="router-link-active router-link-exact-active toc-link level3">type(è¿æ¥ç±»å‹)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#possible-keys-å¯èƒ½ç”¨åˆ°çš„ç´¢å¼•" class="router-link-active router-link-exact-active toc-link level3">possible_keys(å¯èƒ½ç”¨åˆ°çš„ç´¢å¼•)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#key-å®é™…ç”¨åˆ°çš„ç´¢å¼•" class="router-link-active router-link-exact-active toc-link level3">key(å®é™…ç”¨åˆ°çš„ç´¢å¼•)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#key-len-ç´¢å¼•çš„é•¿åº¦" class="router-link-active router-link-exact-active toc-link level3">key_len(ç´¢å¼•çš„é•¿åº¦)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#rows-ä¼°ç®—æ‰¾åˆ°å¯¹åº”è®°å½•æ‰€éœ€è¦çš„è¡Œæ•°" class="router-link-active router-link-exact-active toc-link level3">rows(ä¼°ç®—æ‰¾åˆ°å¯¹åº”è®°å½•æ‰€éœ€è¦çš„è¡Œæ•°)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#extra" class="router-link-active router-link-exact-active toc-link level3">Extra</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#innodb" class="router-link-active router-link-exact-active toc-link level2">InnoDB</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#myisam" class="router-link-active router-link-exact-active toc-link level2">MyISAM</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ¦‚å¿µ" class="router-link-active router-link-exact-active toc-link level2">æ¦‚å¿µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ“ä½œ" class="router-link-active router-link-exact-active toc-link level2">æ“ä½œ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å››å¤§ç‰¹å¾" class="router-link-active router-link-exact-active toc-link level2">å››å¤§ç‰¹å¾</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#äº‹åŠ¡å››å¤§ç‰¹æ€§ä¸­åŸå­æ€§ã€æŒä¹…æ€§ã€éš”ç¦»æ€§å®ç°åŸç†" class="router-link-active router-link-exact-active toc-link level2">äº‹åŠ¡å››å¤§ç‰¹æ€§ä¸­åŸå­æ€§ã€æŒä¹…æ€§ã€éš”ç¦»æ€§å®ç°åŸç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#äº‹åŠ¡å¹¶å‘ä¸‰å¤§é—®é¢˜" class="router-link-active router-link-exact-active toc-link level2">äº‹åŠ¡å¹¶å‘ä¸‰å¤§é—®é¢˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#éš”ç¦»çº§åˆ«" class="router-link-active router-link-exact-active toc-link level2">éš”ç¦»çº§åˆ«</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ­»é”" class="router-link-active router-link-exact-active toc-link level3">æ­»é”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#innodbè§£å†³å¹»è¯»çš„æ–¹å¼" class="router-link-active router-link-exact-active toc-link level3">InnoDBè§£å†³å¹»è¯»çš„æ–¹å¼</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#é”ç²’åº¦" class="router-link-active router-link-exact-active toc-link level2">é”ç²’åº¦</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#è¡¨é”" class="router-link-active router-link-exact-active toc-link level3">è¡¨é”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#è¡Œçº§é”" class="router-link-active router-link-exact-active toc-link level3">è¡Œçº§é”</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#é”ç±»å‹" class="router-link-active router-link-exact-active toc-link level2">é”ç±»å‹</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å…±äº«é”-è¯»-è¡Œ" class="router-link-active router-link-exact-active toc-link level3">å…±äº«é”(è¯»)(è¡Œ)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ’ä»–é”-å†™-è¡Œ" class="router-link-active router-link-exact-active toc-link level3">æ’ä»–é”(å†™)(è¡Œ)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ„å‘å…±äº«é”-è¡¨" class="router-link-active router-link-exact-active toc-link level3">æ„å‘å…±äº«é”(è¡¨)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ„å‘æ’ä»–é”-è¡¨" class="router-link-active router-link-exact-active toc-link level3">æ„å‘æ’ä»–é”(è¡¨)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ„å‘é”çš„æ„ä¹‰" class="router-link-active router-link-exact-active toc-link level3">æ„å‘é”çš„æ„ä¹‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#é”çš„å†…å®¹" class="router-link-active router-link-exact-active toc-link level3">é”çš„å†…å®¹</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#è¡Œé”ç®—æ³•" class="router-link-active router-link-exact-active toc-link level2">è¡Œé”ç®—æ³•</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#è®°å½•é”" class="router-link-active router-link-exact-active toc-link level3">è®°å½•é”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#é—´éš™é”" class="router-link-active router-link-exact-active toc-link level3">é—´éš™é”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ä¸´é”®é”" class="router-link-active router-link-exact-active toc-link level3">ä¸´é”®é”</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ä¹è§‚é”å’Œæ‚²è§‚é”çš„åŒºåˆ«" class="router-link-active router-link-exact-active toc-link level2">ä¹è§‚é”å’Œæ‚²è§‚é”çš„åŒºåˆ«</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#é”å…¼å®¹æƒ…å†µ" class="router-link-active router-link-exact-active toc-link level2">é”å…¼å®¹æƒ…å†µ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å…±äº«é”ã€æ’ä»–é”ã€æ„å‘é”" class="router-link-active router-link-exact-active toc-link level3">å…±äº«é”ã€æ’ä»–é”ã€æ„å‘é”</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#é—´éš™é”ã€è®°å½•é”ã€ä¸´é”®é”" class="router-link-active router-link-exact-active toc-link level3">é—´éš™é”ã€è®°å½•é”ã€ä¸´é”®é”</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æŸ¥çœ‹åŠ é”æ–¹å¼" class="router-link-active router-link-exact-active toc-link level2">æŸ¥çœ‹åŠ é”æ–¹å¼</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å‚æ•°å«ä¹‰" class="router-link-active router-link-exact-active toc-link level3">å‚æ•°å«ä¹‰</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#é”™è¯¯æ—¥å¿—" class="router-link-active router-link-exact-active toc-link level2">é”™è¯¯æ—¥å¿—</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—" class="router-link-active router-link-exact-active toc-link level2">ä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ…¢æŸ¥è¯¢æ—¥å¿—" class="router-link-active router-link-exact-active toc-link level2">æ…¢æŸ¥è¯¢æ—¥å¿—</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#äºŒè¿›åˆ¶æ—¥å¿—-binlog" class="router-link-active router-link-exact-active toc-link level2">äºŒè¿›åˆ¶æ—¥å¿—(binlog)</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—" class="router-link-active router-link-exact-active toc-link level3">æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#åˆ é™¤äºŒè¿›åˆ¶æ—¥å¿—" class="router-link-active router-link-exact-active toc-link level3">åˆ é™¤äºŒè¿›åˆ¶æ—¥å¿—</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#binlogæ—¥å¿—æ ¼å¼" class="router-link-active router-link-exact-active toc-link level3">binlogæ—¥å¿—æ ¼å¼</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#binlog-åˆ·ç›˜æ—¶æœº" class="router-link-active router-link-exact-active toc-link level3">binlog åˆ·ç›˜æ—¶æœº</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#äºŒè¿›åˆ¶æ—¥å¿—ç›¸å…³å˜é‡" class="router-link-active router-link-exact-active toc-link level3">äºŒè¿›åˆ¶æ—¥å¿—ç›¸å…³å˜é‡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#äºŒè¿›åˆ¶æ—¥å¿—å®šç‚¹è¿˜åŸæ•°æ®åº“" class="router-link-active router-link-exact-active toc-link level3">äºŒè¿›åˆ¶æ—¥å¿—å®šç‚¹è¿˜åŸæ•°æ®åº“</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#äº‹åŠ¡æ—¥å¿—" class="router-link-active router-link-exact-active toc-link level2">äº‹åŠ¡æ—¥å¿—</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#redo-log" class="router-link-active router-link-exact-active toc-link level3">redo log</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#undo-log" class="router-link-active router-link-exact-active toc-link level3">undo log</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ä¸¤é˜¶æ®µæäº¤" class="router-link-active router-link-exact-active toc-link level2">ä¸¤é˜¶æ®µæäº¤</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#redo-logå’Œbinlogä¸¤ä»½æ—¥å¿—ä¸ä¸€è‡´å¯¼è‡´çš„é—®é¢˜" class="router-link-active router-link-exact-active toc-link level3">redo logå’Œbinlogä¸¤ä»½æ—¥å¿—ä¸ä¸€è‡´å¯¼è‡´çš„é—®é¢˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ä¸¤é˜¶æ®µæäº¤åŸç†" class="router-link-active router-link-exact-active toc-link level3">ä¸¤é˜¶æ®µæäº¤åŸç†</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å¤šè¡¨ä¹‹é—´çš„å…³ç³»" class="router-link-active router-link-exact-active toc-link level2">å¤šè¡¨ä¹‹é—´çš„å…³ç³»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#èŒƒå¼" class="router-link-active router-link-exact-active toc-link level2">èŒƒå¼</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#åŠ¨æ€å­—æ®µ" class="router-link-active router-link-exact-active toc-link level2">åŠ¨æ€å­—æ®µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#è¡Œè½¬åˆ—ã€åˆ—è½¬è¡Œ" class="router-link-active router-link-exact-active toc-link level2">è¡Œè½¬åˆ—ã€åˆ—è½¬è¡Œ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å‚ç›´åˆ‡åˆ†" class="router-link-active router-link-exact-active toc-link level2">å‚ç›´åˆ‡åˆ†</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å‚ç›´åˆ†åº“" class="router-link-active router-link-exact-active toc-link level3">å‚ç›´åˆ†åº“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å‚ç›´åˆ†è¡¨" class="router-link-active router-link-exact-active toc-link level3">å‚ç›´åˆ†è¡¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ä¼˜ç¼ºç‚¹" class="router-link-active router-link-exact-active toc-link level3">ä¼˜ç¼ºç‚¹</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ°´å¹³åˆ‡åˆ†" class="router-link-active router-link-exact-active toc-link level2">æ°´å¹³åˆ‡åˆ†</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ•°æ®åˆ†ç‰‡è§„åˆ™" class="router-link-active router-link-exact-active toc-link level3">æ•°æ®åˆ†ç‰‡è§„åˆ™</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ä¼˜ç¼ºç‚¹-1" class="router-link-active router-link-exact-active toc-link level3">ä¼˜ç¼ºç‚¹</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å¸¦æ¥çš„é—®é¢˜" class="router-link-active router-link-exact-active toc-link level2">å¸¦æ¥çš„é—®é¢˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#åˆ‡åˆ†åœºæ™¯" class="router-link-active router-link-exact-active toc-link level2">åˆ‡åˆ†åœºæ™¯</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ¡ˆä¾‹" class="router-link-active router-link-exact-active toc-link level2">æ¡ˆä¾‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å‰–æmysqlæŸ¥è¯¢" class="router-link-active router-link-exact-active toc-link level2">å‰–æMySQLæŸ¥è¯¢</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å‰–ææœåŠ¡å™¨è´Ÿè½½" class="router-link-active router-link-exact-active toc-link level3">å‰–ææœåŠ¡å™¨è´Ÿè½½</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å‰–æå•æ¡è®°å½•" class="router-link-active router-link-exact-active toc-link level3">å‰–æå•æ¡è®°å½•</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#é€‰æ‹©ä¼˜åŒ–çš„æ•°æ®ç±»å‹" class="router-link-active router-link-exact-active toc-link level2">é€‰æ‹©ä¼˜åŒ–çš„æ•°æ®ç±»å‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å…·ä½“åšæ³•" class="router-link-active router-link-exact-active toc-link level2">å…·ä½“åšæ³•</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ç´¢å¼•é¿é›·" class="router-link-active router-link-exact-active toc-link level2">ç´¢å¼•é¿é›·</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ä¸€æ¡æŸ¥è¯¢è¯­å¥æ‰§è¡Œçš„æµç¨‹" class="router-link-active router-link-exact-active toc-link level2">ä¸€æ¡æŸ¥è¯¢è¯­å¥æ‰§è¡Œçš„æµç¨‹</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å®¢æˆ·ç«¯-client" class="router-link-active router-link-exact-active toc-link level3">å®¢æˆ·ç«¯(Client)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æŸ¥è¯¢ç¼“å­˜-query-cache" class="router-link-active router-link-exact-active toc-link level3">æŸ¥è¯¢ç¼“å­˜(Query Cache)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#è§£æå™¨-parse" class="router-link-active router-link-exact-active toc-link level3">è§£æå™¨ (Parse)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#é¢„å¤„ç†å™¨-preprocessor" class="router-link-active router-link-exact-active toc-link level3">é¢„å¤„ç†å™¨(Preprocessor)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æŸ¥è¯¢ä¼˜åŒ–å™¨-query-optimizer" class="router-link-active router-link-exact-active toc-link level3">æŸ¥è¯¢ä¼˜åŒ–å™¨(Query Optimizer)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å­˜å‚¨å¼•æ“-store-engine" class="router-link-active router-link-exact-active toc-link level3">å­˜å‚¨å¼•æ“(Store Engine)</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ‰§è¡Œå¼•æ“" class="router-link-active router-link-exact-active toc-link level3">æ‰§è¡Œå¼•æ“</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æè¿°ä¸€æ¡æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œæµç¨‹" class="router-link-active router-link-exact-active toc-link level3">æè¿°ä¸€æ¡æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œæµç¨‹</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#mysqlä½“ç³»æ¶æ„" class="router-link-active router-link-exact-active toc-link level2">MySQLä½“ç³»æ¶æ„</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#innodbå­˜å‚¨ç»“æ„" class="router-link-active router-link-exact-active toc-link level3">InnoDBå­˜å‚¨ç»“æ„</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ä¸€æ¡æ›´æ–°è¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹" class="router-link-active router-link-exact-active toc-link level2">ä¸€æ¡æ›´æ–°è¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ›´æ–°è¯­å¥æ‰§è¡Œçš„è¿‡ç¨‹ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨xaä¸¤é˜¶æ®µçš„æäº¤" class="router-link-active router-link-exact-active toc-link level3">æ›´æ–°è¯­å¥æ‰§è¡Œçš„è¿‡ç¨‹ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨XAä¸¤é˜¶æ®µçš„æäº¤</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#è„é¡µä¸ºä»€ä¹ˆä¼šä½¿sqlå˜æ…¢" class="router-link-active router-link-exact-active toc-link level3">è„é¡µä¸ºä»€ä¹ˆä¼šä½¿SQLå˜æ…¢</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ç´¢å¼•æ¦‚å¿µ" class="router-link-active router-link-exact-active toc-link level2">ç´¢å¼•æ¦‚å¿µ</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ç´¢å¼•å·¥ä½œåŸç†ç¤ºä¾‹" class="router-link-active router-link-exact-active toc-link level3">ç´¢å¼•å·¥ä½œåŸç†ç¤ºä¾‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ç´¢å¼•ç±»å‹" class="router-link-active router-link-exact-active toc-link level3">ç´¢å¼•ç±»å‹</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ç´¢å¼•æ–¹æ³•" class="router-link-active router-link-exact-active toc-link level3">ç´¢å¼•æ–¹æ³•</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ç´¢å¼•ç»“æ„" class="router-link-active router-link-exact-active toc-link level2">ç´¢å¼•ç»“æ„</a></li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ç´¢å¼•æ•°æ®ç»“æ„" class="router-link-active router-link-exact-active toc-link level3">ç´¢å¼•æ•°æ®ç»“æ„</a></li><!----><!--]--></ul><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ç´¢å¼•ä½¿ç”¨åŸåˆ™" class="router-link-active router-link-exact-active toc-link level2">ç´¢å¼•ä½¿ç”¨åŸåˆ™</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#ä¼˜åŒ–æ‰‹æ®µ" class="router-link-active router-link-exact-active toc-link level2">ä¼˜åŒ–æ‰‹æ®µ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#avlæ ‘ã€bæ ‘ã€b-æ ‘åˆ†åˆ«è§£å†³äº†çš„é—®é¢˜" class="router-link-active router-link-exact-active toc-link level2">AVLæ ‘ã€Bæ ‘ã€B+æ ‘åˆ†åˆ«è§£å†³äº†çš„é—®é¢˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#innodbå»ºè®®ä½¿ç”¨è‡ªå¢ä½œä¸ºä¸»é”®ç”Ÿæˆçš„ç­–ç•¥" class="router-link-active router-link-exact-active toc-link level2">InnoDBå»ºè®®ä½¿ç”¨è‡ªå¢ä½œä¸ºä¸»é”®ç”Ÿæˆçš„ç­–ç•¥</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#æ•°æ®åº“äº‹åŠ¡å®šä¹‰" class="router-link-active router-link-exact-active toc-link level2">æ•°æ®åº“äº‹åŠ¡å®šä¹‰</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#äº‹åŠ¡å¹¶å‘ä¼šå¸¦æ¥çš„é—®é¢˜" class="router-link-active router-link-exact-active toc-link level2">äº‹åŠ¡å¹¶å‘ä¼šå¸¦æ¥çš„é—®é¢˜</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#äº‹åŠ¡éš”ç¦»æ€§å’Œé”çš„å…³ç³»" class="router-link-active router-link-exact-active toc-link level2">äº‹åŠ¡éš”ç¦»æ€§å’Œé”çš„å…³ç³»</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#è¡Œé”çš„åŸç†å’Œç®—æ³•è¯¦è§£" class="router-link-active router-link-exact-active toc-link level2">è¡Œé”çš„åŸç†å’Œç®—æ³•è¯¦è§£</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#å†™" class="router-link-active router-link-exact-active toc-link level2">å†™</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/javrin/writings/MySQL/MySQL.html#è¯»" class="router-link-active router-link-exact-active toc-link level2">è¯»</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h1 id="åŸºç¡€çŸ¥è¯†" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€çŸ¥è¯†" aria-hidden="true">#</a> åŸºç¡€çŸ¥è¯†</h1><p><strong>SQLçš„æ¦‚å¿µ</strong>ï¼šStructured Query Languageï¼Œç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ã€‚å®šä¹‰äº†æ“ä½œæ‰€æœ‰å…³ç³»å‹æ•°æ®åº“çš„è§„åˆ™ã€‚</p><p>SQLè¯­å¥åˆ†ç±»</p><ul><li>DDL(Data Definition Language)æ•°æ®å®šä¹‰è¯­è¨€ <ul><li>å®šä¹‰æ•°æ®åº“ã€è¡¨ã€è§†å›¾ã€åˆ—ç­‰ã€‚</li><li>å…³é”®å­—ï¼š<code>CREATE</code>ã€<code>DROP</code>ã€<code>ALTER</code>ç­‰</li></ul></li><li>DML(Manipulation)æ•°æ®æ“ä½œè¯­è¨€ <ul><li>å¯¹è¡¨ä¸­æ•°æ®è¿›è¡Œå¢åˆ æ”¹</li><li>å…³é”®å­—ï¼š<code>INSERT</code>ã€<code>DELETE</code>ã€<code>UPDATE</code>ç­‰</li></ul></li><li>DQL(Query)æ•°æ®æŸ¥è¯¢è¯­è¨€ <ul><li>å¯¹è¡¨ä¸­æ•°æ®è¿›è¡ŒæŸ¥è¯¢</li><li>å…³é”®å­—ï¼š<code>SELECT</code>ã€<code>WHERE</code>ç­‰</li></ul></li><li>DCL(Control)æ•°æ®æ§åˆ¶è¯­è¨€ <ul><li>å®šä¹‰æ•°æ®åº“çš„è®¿é—®æƒé™å’Œå®‰å…¨çº§åˆ«ä»¥åŠåˆ›å»ºç”¨æˆ·</li><li>å…³é”®å­—ï¼š<code>GRANT</code>ã€<code>REVOKE</code>ç­‰</li></ul></li></ul><p><strong>æ¶æ„å›¾</strong></p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/007S8ZIlgy1gfsrmbg5m2j30c40ha0yn.jpg" alt=""></p><h2 id="æ•°æ®ç±»å‹" tabindex="-1"><a class="header-anchor" href="#æ•°æ®ç±»å‹" aria-hidden="true">#</a> æ•°æ®ç±»å‹</h2><ul><li><p>æ•´æ•°ç±»å‹</p><blockquote><p>æ˜¾ç¤ºå®½åº¦å’Œæ•°æ®ç±»å‹çš„å–å€¼èŒƒå›´æ˜¯æ— å…³çš„ã€‚æ˜¾ç¤ºå®½åº¦åªæ˜¯æŒ‡æ˜ MySQL æœ€å¤§å¯èƒ½æ˜¾ç¤ºçš„æ•°å­—ä¸ªæ•°ï¼Œå¹¶ä¸”éœ€è¦å¯ç”¨å¡«å……é›¶çš„é€‰é¡¹æ‰æœ‰æ•ˆï¼Œæ•°å€¼çš„ä½æ•°å°äºæŒ‡å®šçš„å®½åº¦æ—¶ä¼šç”±0å¡«å……ã€‚å¦‚æœæ’å…¥äº†å¤§äºæ˜¾ç¤ºå®½åº¦çš„å€¼ï¼Œåªè¦è¯¥å€¼ä¸è¶…è¿‡è¯¥ç±»å‹æ•´æ•°çš„å–å€¼èŒƒå›´ï¼Œæ•°å€¼ä¾ç„¶å¯ä»¥æ’å…¥ï¼Œè€Œä¸”èƒ½å¤Ÿæ˜¾ç¤ºå‡ºæ¥ã€‚ä¾‹å¦‚ï¼Œyear å­—æ®µæ’å…¥ 19999ï¼Œå½“ä½¿ç”¨ SELECT æŸ¥è¯¢è¯¥åˆ—å€¼çš„æ—¶å€™ï¼ŒMySQL æ˜¾ç¤ºçš„å°†æ˜¯å®Œæ•´çš„å¸¦æœ‰ 5 ä½æ•°å­—çš„ 19999ï¼Œè€Œä¸æ˜¯ 4 ä½æ•°å­—çš„å€¼</p></blockquote><ul><li><p>tinyintï¼Œ1ä¸ªå­—èŠ‚ï¼Œ-128<sub>127(æœ‰ç¬¦å·)ã€0</sub>255(æ— ç¬¦å·)</p><blockquote><p><strong>Javaä¸­Booleanç±»å‹å˜é‡å¯ä»¥ç”¨tinyintç±»å‹çš„å­—æ®µ</strong>ï¼ŒMySQLé‡Œæœ‰å››ä¸ªå¸¸é‡ï¼štrueã€falseã€TRUEã€FALSEåˆ†åˆ«ä»£è¡¨1ã€0ã€1ã€0ã€‚MySQLä¿å­˜booleanå€¼æ—¶ç”¨1ä»£è¡¨TRUEï¼Œ0ä»£è¡¨FALSE</p></blockquote></li><li><p>smallintï¼Œ2ä¸ªå­—èŠ‚</p></li><li><p>mediumintï¼Œ3ä¸ªå­—èŠ‚</p></li><li><p>intï¼Œ4ä¸ªå­—èŠ‚</p></li><li><p>bigintï¼Œ8ä¸ªå­—èŠ‚</p></li></ul></li><li><p>å°æ•°ç±»å‹</p><blockquote><p>æµ®ç‚¹ç±»å‹å’Œå®šç‚¹ç±»å‹éƒ½å¯ä»¥ç”¨<code>(M, D)</code>æ¥è¡¨ç¤ºï¼Œå…¶ä¸­<code>M</code>ç§°ä¸ºç²¾åº¦ï¼Œè¡¨ç¤ºæ€»å…±çš„ä½æ•°ï¼›<code>D</code>ç§°ä¸ºæ ‡åº¦ï¼Œè¡¨ç¤ºå°æ•°çš„ä½æ•°ã€‚</p><p>æµ®ç‚¹æ•°ç±»å‹çš„å–å€¼èŒƒå›´ä¸º Mï¼ˆ1ï½255ï¼‰å’Œ Dï¼ˆ1ï½30ï¼Œä¸”ä¸èƒ½å¤§äº M-2ï¼‰ï¼Œåˆ†åˆ«è¡¨ç¤ºæ˜¾ç¤ºå®½åº¦å’Œå°æ•°ä½æ•°ã€‚M å’Œ D åœ¨ FLOAT å’ŒDOUBLE ä¸­æ˜¯å¯é€‰çš„ï¼ŒFLOAT å’Œ DOUBLE ç±»å‹å°†é»˜è®¤ä¼šæŒ‰ç…§å®é™…çš„ç²¾åº¦ï¼ˆç”±è®¡ç®—æœºç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿå†³å®šï¼‰ã€‚<strong>DECIMAL çš„é»˜è®¤ D å€¼ä¸º 0ã€M å€¼ä¸º 10</strong>ã€‚</p><p>ä¸è®ºæ˜¯å®šç‚¹è¿˜æ˜¯æµ®ç‚¹ç±»å‹ï¼Œå¦‚æœç”¨æˆ·æŒ‡å®šçš„ç²¾åº¦<strong>è¶…å‡ºç²¾åº¦èŒƒå›´ï¼Œåˆ™ä¼šå››èˆäº”å…¥è¿›è¡Œå¤„ç†</strong>ã€‚</p></blockquote><ul><li><p>æµ®ç‚¹ç±»å‹</p><ul><li>floatï¼Œå•ç²¾åº¦ï¼Œ4ä¸ªå­—èŠ‚</li><li>doubleï¼ŒåŒç²¾åº¦ï¼Œ8ä¸ªå­—èŠ‚</li></ul></li><li><p>å®šç‚¹ç±»å‹</p><ul><li><p>decimalï¼ŒM+2ä¸ªå­—èŠ‚</p><blockquote><p>åœ¨ MySQL ä¸­ï¼Œå®šç‚¹æ•°ä»¥å­—ç¬¦ä¸²å½¢å¼å­˜å‚¨ï¼Œåœ¨å¯¹ç²¾åº¦è¦æ±‚æ¯”è¾ƒé«˜çš„æ—¶å€™ï¼ˆå¦‚è´§å¸ã€ç§‘å­¦æ•°æ®ï¼‰ï¼Œä½¿ç”¨ DECIMAL çš„ç±»å‹æ¯”è¾ƒå¥½ï¼Œå¦å¤–ä¸¤ä¸ªæµ®ç‚¹æ•°è¿›è¡Œå‡æ³•å’Œæ¯”è¾ƒè¿ç®—æ—¶ä¹Ÿå®¹æ˜“å‡ºé—®é¢˜ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨æµ®ç‚¹æ•°æ—¶éœ€è¦æ³¨æ„ï¼Œå¹¶å°½é‡<strong>é¿å…åšæµ®ç‚¹æ•°æ¯”è¾ƒ</strong></p></blockquote></li></ul></li></ul></li><li><p>æ—¥æœŸç±»å‹</p><ul><li>yearï¼Œæ ¼å¼<code>yyyy</code>ï¼ŒèŒƒå›´<code>1901~2155</code>ï¼Œ1ä¸ªå­—èŠ‚ã€‚å¯ä»¥æ¥å—æ•´å‹å’Œå­—ç¬¦ä¸²ï¼Œæ‰€ä»¥ç¨‹åºä¸­è®°å½•å¹´ä»½æ—¶å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²</li><li>timeï¼Œæ ¼å¼<code>HH:mm:ss</code>ï¼ŒèŒƒå›´<code>-838:59:59 ~ 838:59:59</code>ï¼Œ3ä¸ªå­—èŠ‚</li><li>dateï¼Œæ ¼å¼<code>yyyy-MM-dd</code>ï¼ŒèŒƒå›´<code>1000-01-01 ~ 9999-12-3</code>ï¼Œ3ä¸ªå­—èŠ‚</li><li>datetimeï¼Œæ ¼å¼<code>yyyy-MM-dd HH:mm:ss</code>ï¼ŒèŒƒå›´<code>1000-01-01 00:00:00 ~ 9999-12-31 23:59:59</code>ï¼Œ8ä¸ªå­—èŠ‚</li><li>timestampï¼Œæ ¼å¼<code>yyyy-MM-dd HH:mm:ss</code>ï¼ŒèŒƒå›´<code>1980-01-01 00:00:01 UTC ~ 2040-01-19 03:14:07 UTC</code>ï¼Œ4ä¸ªå­—èŠ‚ã€‚å¦‚æœä¸ç»™è¿™ä¸ªå­—æ®µèµ‹å€¼ï¼Œæˆ–è€…èµ‹å€¼ä¸ºnullï¼Œé‚£ä¹ˆé»˜è®¤ä½¿ç”¨ç³»ç»Ÿå½“å‰æ—¶é—´æ¥è‡ªåŠ¨èµ‹å€¼</li><li>datetimeå’Œtimestampçš„åŒºåˆ« <ul><li><strong>å­˜å‚¨æ–¹å¼ä¸ä¸€æ ·</strong>ï¼Œtimestampå­˜å‚¨æ—¶ä»å®¢æˆ·ç«¯æ—¶åŒºè½¬æ¢æˆUTCè¿›è¡Œå­˜å‚¨ï¼ŒæŸ¥è¯¢æ—¶ä»UTCè½¬æ¢åˆ°å®¢æˆ·ç«¯æ—¶åŒºè¿”å›ï¼›datetimeä¸è½¬æ¢ï¼ŒåŸæ ·å­˜å‚¨å’Œè¯»å–</li><li><strong>æ—¶é—´èŒƒå›´ä¸ä¸€æ ·</strong>ï¼Œtimestampå­˜å‚¨çš„èŒƒå›´ä¸º1970-01-01ï½ 2038-01-19ï¼›datetimeå­˜å‚¨çš„èŒƒå›´ä¸º1000-01-01 ï½ 9999-12-31</li></ul></li></ul></li><li><p>å­—ç¬¦ä¸²ç±»å‹</p><blockquote><p>å­—ç¬¦ä¸²ç±»å‹å¯ä»¥åœ¨å®šä¹‰æ—¶ä½¿ç”¨Mæ¥æŒ‡å®šé•¿åº¦</p></blockquote><ul><li><p>char(M)ï¼Œå›ºå®šé•¿åº¦å­—ç¬¦ä¸²ï¼ŒMä¸ªå­—èŠ‚</p></li><li><p>varchar(M)ï¼Œå¯å˜é•¿åº¦å­—ç¬¦ä¸²ï¼Œå½“å®é™…å­˜å‚¨çš„é•¿åº¦Lå°äºMï¼Œåˆ™éœ€è¦L+1ä¸ªå­—èŠ‚ï¼›å½“å®é™…å­˜å‚¨çš„é•¿åº¦ç­‰äºMï¼Œåˆ™éœ€è¦M+1ä¸ªå­—èŠ‚</p></li><li><p>enumï¼Œä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œå€¼ä¸ºè¡¨åˆ›å»ºæ—¶åˆ—è§„å®šä¸­æšä¸¾çš„ä¸€åˆ—å€¼ï¼Œè¯­æ³•<code>&lt;å­—æ®µå&gt; ENUM( &#39;å€¼1&#39;, &#39;å€¼1&#39;, â€¦, &#39;å€¼n&#39; )</code>ï¼Œä» 1 å¼€å§‹ç¼–å·ã€‚ä¾ç…§åˆ—ç´¢å¼•é¡ºåºæ’åˆ—ï¼Œå¹¶ä¸”ç©ºå­—ç¬¦ä¸²æ’åœ¨éç©ºå­—ç¬¦ä¸²å‰ï¼ŒNULL å€¼æ’åœ¨å…¶ä»–æ‰€æœ‰æšä¸¾å€¼å‰ã€‚ENUM åˆ—æ€»æœ‰ä¸€ä¸ªé»˜è®¤å€¼ã€‚å¦‚æœå°† ENUM åˆ—å£°æ˜ä¸º NULLï¼ŒNULL å€¼åˆ™ä¸ºè¯¥åˆ—çš„ä¸€ä¸ªæœ‰æ•ˆå€¼ï¼Œå¹¶ä¸”é»˜è®¤å€¼ä¸º NULLã€‚å¦‚æœ ENUM åˆ—è¢«å£°æ˜ä¸º NOT NULLï¼Œå…¶é»˜è®¤å€¼ä¸ºå…è®¸çš„å€¼åˆ—è¡¨çš„ç¬¬ 1 ä¸ªå…ƒç´ </p><p>ä¾‹å­ï¼šå®šä¹‰enumç±»å‹çš„åˆ—(&#39;first&#39;, &#39;second&#39;, &#39;third&#39;)ï¼Œå€¼ä¸ç´¢å¼•çš„å¯¹åº”å…³ç³»å¦‚ä¸‹ï¼š</p><table><thead><tr><th style="text-align:center;">ç´¢å¼•</th><th style="text-align:center;">å€¼</th></tr></thead><tbody><tr><td style="text-align:center;">null</td><td style="text-align:center;">null</td></tr><tr><td style="text-align:center;">0</td><td style="text-align:center;">&quot;&quot;</td></tr><tr><td style="text-align:center;">1</td><td style="text-align:center;">&quot;first&quot;</td></tr><tr><td style="text-align:center;">2</td><td style="text-align:center;">&quot;second&quot;</td></tr><tr><td style="text-align:center;">3</td><td style="text-align:center;">&quot;third&quot;</td></tr></tbody></table></li><li><p>setï¼Œä¸€ä¸ªå­—ç¬¦ä¸²çš„å¯¹è±¡ï¼Œå¯ä»¥æœ‰é›¶æˆ–å¤šä¸ªå€¼ï¼Œå€¼ä¸ºè¡¨åˆ›å»ºæ—¶è§„å®šçš„ä¸€åˆ—å€¼ï¼Œè¯­æ³•<code>SET( &#39;å€¼1&#39;, &#39;å€¼2&#39;, â€¦, &#39;å€¼n&#39; )</code>ï¼ŒMySQLä¼šè‡ªåŠ¨åˆ é™¤é‡å¤å€¼</p></li><li><p>å¤§æ–‡æœ¬ï¼Œé€‚åˆä¿å­˜æ–‡ç« ã€è¯„è®ºç­‰</p><ul><li>tinytextï¼Œé•¿åº¦ä¸º255ï¼ŒL+1ä¸ªå­—èŠ‚</li><li>textï¼Œé•¿åº¦ä¸º65535ï¼ŒL+2ä¸ªå­—èŠ‚</li><li>mediumtextï¼Œé•¿åº¦ä¸º16777215ï¼ŒL+3ä¸ªå­—èŠ‚</li><li>longtextï¼Œé•¿åº¦ä¸º4294967295ï¼ŒL+4ä¸ªå­—èŠ‚</li></ul></li></ul></li><li><p>äºŒè¿›åˆ¶ç±»å‹</p><blockquote><p>äºŒè¿›åˆ¶ç±»å‹å¯ä»¥åœ¨å®šä¹‰æ—¶ä½¿ç”¨Mæ¥æŒ‡å®šé•¿åº¦</p></blockquote><ul><li>textï¼Œæ–‡æœ¬ç±»å‹ï¼Œä¸€èˆ¬ç”¨æ¥å­˜å‚¨æ–‡æœ¬ï¼Œæœ€å¤§é•¿åº¦65535å­—èŠ‚</li><li>bit(M)ï¼Œä»¥<strong>äºŒè¿›åˆ¶çš„å½¢å¼</strong>ä¿å­˜ï¼ŒM è¡¨ç¤ºæ¯ä¸ªå€¼çš„ä½æ•°ï¼ŒèŒƒå›´ä¸º 1ï½64ã€‚å¦‚æœ M è¢«çœç•¥ï¼Œé»˜è®¤å€¼ä¸º 1ï¼Œå¤§çº¦(M+7)/8ä¸ªå­—èŠ‚</li><li>binary(M)ï¼Œå›ºå®šé•¿åº¦çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼ŒMä¸ªå­—èŠ‚</li><li>varbinary(M)ï¼Œå¯å˜é•¿åº¦çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ï¼ŒM+1ä¸ªå­—èŠ‚</li><li>äºŒè¿›åˆ¶å¯¹è±¡ <ul><li>tinyblobï¼Œ255ä¸ªå­—èŠ‚</li><li>blobï¼Œ65535ä¸ªå­—èŠ‚</li><li>mediumblobï¼Œ16777215ä¸ªå­—èŠ‚</li><li>longblobï¼Œ4294967295ä¸ªå­—èŠ‚</li></ul></li></ul></li></ul><h2 id="ddl" tabindex="-1"><a class="header-anchor" href="#ddl" aria-hidden="true">#</a> DDL</h2><h3 id="æ“ä½œæ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#æ“ä½œæ•°æ®åº“" aria-hidden="true">#</a> æ“ä½œæ•°æ®åº“</h3><ul><li><p>Createï¼šåˆ›å»º</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>create database æ•°æ®åº“åç§°; -- åˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“

create database æ•°æ®åº“åç§° character set å­—ç¬¦é›†; -- åˆ›å»ºä¸€ä¸ªæ–°çš„æŒ‡å®šå­—ç¬¦é›†çš„æ•°æ®åº“

create database if not exists æ•°æ®åº“åç§°; -- å¦‚æœæ•°æ®åº“ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºï¼›å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¸åˆ›å»º
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Retrieveï¼šæŸ¥è¯¢</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>show databases; -- æŸ¥è¯¢æ‰€æœ‰æ•°æ®åº“

show create database æ•°æ®åº“åç§°; -- æŸ¥è¯¢æŸä¸ªæ•°æ®åº“çš„åˆ›å»ºè¯­å¥å’Œå­—ç¬¦é›†
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Updateï¼šä¿®æ”¹</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>alter database æ•°æ®åº“åç§° character set å­—ç¬¦é›†; -- ä¿®æ”¹æ•°æ®åº“çš„å­—ç¬¦é›†
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>Deleteï¼šåˆ é™¤</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>drop database æ•°æ®åº“åç§°; -- åˆ é™¤æ•°æ®åº“

drop database if exists æ•°æ®åº“åç§°; -- å¦‚æœæ•°æ®åº“å­˜åœ¨ï¼Œåˆ™åˆ é™¤ï¼›å¦‚æœå­˜åœ¨ï¼Œåˆ™ä¸åˆ é™¤
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ä½¿ç”¨æ•°æ®åº“</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select database(); -- æŸ¥è¯¢å½“å‰æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“åç§°

use æ•°æ®åº“åç§°; -- ä½¿ç”¨æŸä¸ªæ•°æ®åº“
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="æ“ä½œè¡¨" tabindex="-1"><a class="header-anchor" href="#æ“ä½œè¡¨" aria-hidden="true">#</a> æ“ä½œè¡¨</h3><ul><li><p>Createï¼šåˆ›å»º</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>create table è¡¨å(			-- åˆ›å»ºè¡¨çš„åŸºæœ¬è¯­æ³•
		åˆ—å1 æ•°æ®ç±»å‹1,
  	åˆ—å2 æ•°æ®ç±»å‹2,
  	...
  	åˆ—ån æ•°æ®ç±»å‹n
);

-- åœ¨æ•°æ®ç±»å‹åæ¥ default xx ç»™è¿™ä¸ªåˆ—ä¸€ä¸ªé»˜è®¤å€¼

create table æ–°è¡¨å like è¢«å¤åˆ¶çš„è¡¨å; -- å¤åˆ¶ä¸€ä»½è¡¨ç»“æ„ç›¸åŒçš„è¡¨
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä¾‹å­</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>create table student(
		id int,
  	name varchar(32),
  	age int,
  	score double(4, 1),
  	birthday date,
  	insert_time timestamp
);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Retrieveï¼šæŸ¥è¯¢</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>show tables; -- æŸ¥è¯¢æŸä¸ªæ•°æ®åº“ä¸­æ‰€æœ‰çš„è¡¨åç§°

desc è¡¨å; -- æŸ¥è¯¢æŸä¸ªè¡¨çš„ç»“æ„(å­—æ®µã€ç±»å‹ç­‰ä¿¡æ¯)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Updateï¼šä¿®æ”¹</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>alter table è¡¨å rename to æ–°è¡¨å; -- ä¿®æ”¹è¡¨å

show create table è¡¨å; -- æŸ¥çœ‹å»ºè¡¨è¯­å¥

alter table è¡¨å character set å­—ç¬¦é›† -- ä¿®æ”¹è¡¨çš„å­—ç¬¦é›†

alter table è¡¨å add åˆ—å æ•°æ®ç±»å‹; -- æ–°å¢ä¸€åˆ—

alter table è¡¨å change åˆ—å æ–°åˆ—å æ–°æ•°æ®ç±»å‹; -- ä¿®æ”¹åˆ—
alter table è¡¨å modify åˆ—å æ–°æ•°æ®ç±»å‹; -- ä¿®æ”¹åˆ—çš„æ•°æ®ç±»å‹

alter table è¡¨å drop åˆ—å; -- åˆ é™¤åˆ—
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Deleteï¼šåˆ é™¤</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>drop table è¡¨å;	-- åˆ é™¤è¡¨

drop table if exists è¡¨å; -- åˆ é™¤å‰åˆ é™¤
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="dml" tabindex="-1"><a class="header-anchor" href="#dml" aria-hidden="true">#</a> DML</h2><h3 id="æ·»åŠ æ•°æ®" tabindex="-1"><a class="header-anchor" href="#æ·»åŠ æ•°æ®" aria-hidden="true">#</a> æ·»åŠ æ•°æ®</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>insert into è¡¨å(åˆ—å1, åˆ—å2,...åˆ—ån) values(å€¼1, å€¼2,...å€¼n); -- ç»™å¯¹åº”çš„åˆ—æ·»åŠ æ•°æ®
-- åˆ—åå’Œå€¼è¦ä¸€ä¸€å¯¹åº”
-- å¦‚æœè¡¨ååä¸å®šä¹‰åˆ—ååˆ™é»˜è®¤ç»™æ‰€æœ‰åˆ—æ·»åŠ å€¼ï¼Œä½†æ˜¯è¦ç»™å¤Ÿåˆ—
insert into è¡¨å values(å€¼1, å€¼2,...å€¼n); -- ç»™æ‰€æœ‰çš„åˆ—æ·»åŠ æ•°æ®
-- é™¤äº†æ•°å­—ç±»å‹ï¼Œå…¶ä»–ç±»å‹éƒ½éœ€è¦ä½¿ç”¨å¼•å·
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åˆ é™¤æ•°æ®" tabindex="-1"><a class="header-anchor" href="#åˆ é™¤æ•°æ®" aria-hidden="true">#</a> åˆ é™¤æ•°æ®</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>delete from è¡¨å [where æ¡ä»¶]; -- æŒ‰æ¡ä»¶åˆ é™¤æ•°æ®
-- å¦‚æœä¸åŠ æ¡ä»¶ï¼Œåˆ™åˆ é™¤è¡¨ä¸­æ‰€æœ‰è®°å½•

truncate table è¡¨å; -- åˆ é™¤è¡¨ï¼Œç„¶åå†åˆ›å»ºä¸€ä¸ªä¸€æ‘¸ä¸€æ ·çš„ç©ºè¡¨ æ•°æ®é‡å¤§çš„æ—¶å€™æ¯”ç›´æ¥drop tableæ•ˆç‡è¦é«˜
-- truncateå’Œä¸å¸¦whereå­å¥çš„deleteè¯­å¥ä½œç”¨ä¸€æ ·
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="ä¿®æ”¹æ•°æ®" tabindex="-1"><a class="header-anchor" href="#ä¿®æ”¹æ•°æ®" aria-hidden="true">#</a> ä¿®æ”¹æ•°æ®</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>update è¡¨å set åˆ—å1 = å€¼1, åˆ—å2 = å€¼2,...[where æ¡ä»¶]; -- ä¿®æ”¹æ•°æ®
-- å¦‚æœä¸åŠ æ¡ä»¶ï¼Œåˆ™ä¿®æ”¹è¡¨ä¸­æ‰€æœ‰è®°å½•

-- mysqlä¸æ”¯æŒä¿®æ”¹ç»“æœé›†çš„æ•°æ®
update(select ...)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="dql" tabindex="-1"><a class="header-anchor" href="#dql" aria-hidden="true">#</a> DQL</h2><h3 id="åŸºæœ¬è¯­æ³•" tabindex="-1"><a class="header-anchor" href="#åŸºæœ¬è¯­æ³•" aria-hidden="true">#</a> åŸºæœ¬è¯­æ³•</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select 					-- æŸ¥è¯¢è¯­å¥åŸºæœ¬è¯­æ³•
		å­—æ®µåˆ—è¡¨
from
		è¡¨ååˆ—è¡¨
where
		æ¡ä»¶åˆ—è¡¨
group by
		åˆ†ç»„å­—æ®µ
having
		åˆ†ç»„ä¹‹åçš„æ¡ä»¶
order by
		æ’åº
limit
		æ•°æ®é‡é™å®š;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åŸºç¡€æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#åŸºç¡€æŸ¥è¯¢" aria-hidden="true">#</a> åŸºç¡€æŸ¥è¯¢</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select * from è¡¨å; -- æŸ¥è¯¢è¡¨ä¸­æ‰€æœ‰æ•°æ®

select åˆ—å1, åˆ—å2,... from è¡¨å; -- æŒ‰åˆ—æŸ¥è¯¢æ•°æ®

select distinct åˆ—å from è¡¨å; -- å»é™¤é‡å¤çš„ç»“æœé›†
-- åœ¨æŸ¥è¯¢æ—¶distinctå…³é”®å­—ä¼šåº”ç”¨äºæ‰€æœ‰åˆ—è€Œä¸æ˜¯å‰ç½®å®ƒçš„åˆ—

-- å¦‚æœæœ‰nullå€¼å‚ä¸è®¡ç®—ï¼Œè®¡ç®—ç»“æœéƒ½æ˜¯null
-- è§£å†³æ–¹æ³• ifnull(åŸå€¼ï¼Œå¦‚æœæ˜¯nullæ›¿æ¢çš„å€¼)
select ifnull(åˆ—å, 0)+ifnull(åˆ—å, 0) from è¡¨å;

select åˆ—å (as) åˆ«å from è¡¨å; -- ç»™æŸ¥è¯¢çš„åˆ—åèµ·åˆ«å aså¯ä»¥çœç•¥
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ¡ä»¶æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#æ¡ä»¶æŸ¥è¯¢" aria-hidden="true">#</a> æ¡ä»¶æŸ¥è¯¢</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- è¿ç®—ç¬¦
&gt;ã€&lt;ã€&lt;=ã€&gt;=ã€=ã€&lt;&gt; 	 -- æ¯”è¾ƒåˆ¤æ–­ç¬¦å· ä¸ç­‰äºï¼š&lt;&gt;
between...and...		-- åœ¨...èŒƒå›´ä¸­
in() 								-- æ‹¬å·å†…å¡«å†™ å­æŸ¥è¯¢æˆ–é›†åˆ
is null 						-- æŸ¥è¯¢nullå€¼ ä¸ä¸ºnullå€¼ï¼šis not null
and &amp;&amp;
or ||
not !
like								-- æ¨¡ç³ŠæŸ¥è¯¢
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ¨¡ç³ŠæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#æ¨¡ç³ŠæŸ¥è¯¢" aria-hidden="true">#</a> æ¨¡ç³ŠæŸ¥è¯¢</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- å ä½ç¬¦
_ -- å•ä¸ªä»»æ„å­—ç¬¦
% -- å¤šä¸ªä»»æ„å­—ç¬¦

-- ä¾‹å­
-- æŸ¥è¯¢å§“åä¸‰ä¸ªå­—çš„äºº
select name from student where name like &#39;___&#39;;
-- æŸ¥è¯¢å§“åç¬¬äºŒä¸ªå­—æ˜¯ä¼Ÿçš„äºº
select name from student where name like &#39;_ä¼Ÿ%&#39;;
-- æŸ¥è¯¢å§“ååŒ…å«ä¼Ÿçš„äºº
select name from student where name like &#39;%ä¼Ÿ%&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ’åºæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#æ’åºæŸ¥è¯¢" aria-hidden="true">#</a> æ’åºæŸ¥è¯¢</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- è¯­æ³•
order by æ’åºå­—æ®µ1 æ’åºæ–¹å¼1, æ’åºå­—æ®µ2 æ’åºæ–¹å¼2...;
-- åé¢çš„æ’åºæ¡ä»¶åªæœ‰å½“å‰é¢çš„ä¸€æ ·çš„æ¡ä»¶ä¸‹æ‰ä¼šä½¿ç”¨åé¢çš„æ’åºæ¡ä»¶

-- æ’åºæ–¹å¼
asc -- å‡åº é»˜è®¤
desc -- é™åº
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="èšåˆå‡½æ•°" tabindex="-1"><a class="header-anchor" href="#èšåˆå‡½æ•°" aria-hidden="true">#</a> èšåˆå‡½æ•°</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- å°†ä¸€åˆ—æ•°æ®ä½œä¸ºä¸€ä¸ªæ•´ä½“ï¼Œè¿›è¡Œçºµå‘è®¡ç®—
-- å¸¸ç”¨èšåˆå‡½æ•° (æ’é™¤äº†nullå€¼ï¼Œæ³¨æ„)
count -- è®¡ç®—æ•°é‡
max -- æœ€å¤§å€¼
min -- æœ€å°å€¼
sum -- æ±‚å’Œ
avg -- è®¡ç®—å¹³å‡å€¼

-- ä¾‹å­
select count(`name`) from student; -- ç»Ÿè®¡ä¸€ä¸ªæœ‰å¤šå°‘ä¸ªå­¦ç”Ÿ
select count(ifnull(english, 0)) from student; -- é¿å…è‹±è¯­æˆç»©ä¸ºnullä¸è®¡ç®—
select count(*) from student; -- åªè¦è¿™ä¸€è¡Œæ•°æ®æœ‰ä¸€åˆ—ä¸ä¸ºnullï¼Œå°±ç®—ä¸€æ¡è®°å½•

select max(math) from student; -- ç»Ÿè®¡æ•°å­¦æˆç»©æœ€é«˜åˆ†
select min(math) from student; -- ç»Ÿè®¡æ•°å­¦æˆç»©æœ€ä½åˆ†

select sum(math) from student; -- ç»Ÿè®¡å„ä¸ªåŒå­¦çš„æ•°å­¦æˆç»©ä¹‹å’Œ

select avg(math) from sutdent; -- è®¡ç®—æ•°å­¦æˆç»©çš„å¹³å‡åˆ†
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åˆ†ç»„æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#åˆ†ç»„æŸ¥è¯¢" aria-hidden="true">#</a> åˆ†ç»„æŸ¥è¯¢</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- è¯­æ³•
group by åˆ†ç»„å­—æ®µ having æ¡ä»¶;
-- åˆ†ç»„ååªèƒ½æŸ¥ï¼šåˆ†ç»„å­—æ®µã€èšåˆå‡½æ•°ï¼›æŸ¥å…¶ä»–å­—æ®µæ²¡æœ‰æ„ä¹‰
-- whereä¸havingçš„åŒºåˆ«
-- 1.whereä½œç”¨åœ¨åˆ†ç»„ä¹‹å‰è¿›è¡Œé™å®šï¼Œå¦‚æœä¸æ»¡è¶³æ¡ä»¶ï¼Œåˆ™ä¸å‚ä¸åˆ†ç»„;
--   havingåœ¨åˆ†ç»„ä¹‹åé™å®šï¼Œå¦‚æœä¸æ»¡è¶³ç»“æœï¼Œåˆ™ä¸ä¼šè¢«æŸ¥è¯¢å‡ºæ¥
-- 2.whereåä¸å¯æ¥èšåˆå‡½æ•°ï¼Œhavingåå¯ä»¥è¿›è¡Œèšåˆå‡½æ•°çš„åˆ¤æ–­

-- ä¾‹å­
-- æŸ¥è¯¢ç”·ç”Ÿå¥³ç”Ÿçš„æ•°å­¦å¹³å‡åˆ†
SELECT sex &#39;æ€§åˆ«&#39;, AVG(math) &#39;æ•°å­¦å¹³å‡åˆ†&#39;, COUNT(Id) &#39;äººæ•°&#39; FROM `student3 GROUP BY sex;

-- 70åˆ†ä»¥ä¸‹çš„ä¸å‚ä¸åˆ†ç»„
SELECT sex &#39;æ€§åˆ«&#39;, AVG(math) &#39;æ•°å­¦å¹³å‡åˆ†&#39;, COUNT(Id) &#39;äººæ•°&#39; FROM `student3` WHERE math &gt; 70 GROUP BY sex;

-- åˆ†ç»„ååªçœ‹äººæ•°å¤§äº2çš„æ•°æ®
SELECT sex &#39;æ€§åˆ«&#39;, AVG(math) &#39;æ•°å­¦å¹³å‡åˆ†&#39;, COUNT(Id) &#39;äººæ•°&#39; FROM `student3` WHERE math &gt; 70 GROUP BY sex HAVING COUNT(Id) &gt; 2;
-- å¯ä»¥ç»™COUNT(Id) èµ·åˆ«å
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åˆ†é¡µæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#åˆ†é¡µæŸ¥è¯¢" aria-hidden="true">#</a> åˆ†é¡µæŸ¥è¯¢</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- è¯­æ³•
limit å¼€å§‹çš„ç´¢å¼•,æ¯é¡µæŸ¥è¯¢çš„æ¡æ•°;
-- æ³¨æ„ï¼šå¼€å§‹çš„ç´¢å¼•æ˜¯è¯¥é¡µå¼€å§‹çš„ç´¢å¼•ï¼Œä¸æ˜¯é¡µç 
-- å…¬å¼ï¼š(å½“å‰é¡µç  - 1) * æ¯é¡µæ˜¾ç¤ºçš„æ¡æ•°
-- æœ€åä¸€é¡µï¼šæœ‰å¤šå°‘æ¡æ˜¾ç¤ºå¤šå°‘æ¡

-- ä¾‹å­
select * from student limit 0,3; -- ç¬¬ä¸€é¡µ
select * from student limit 3,3; -- ç¬¬äºŒé¡µ
select * from student limit 6,3; -- ç¬¬ä¸‰é¡µ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="åˆå¹¶æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#åˆå¹¶æŸ¥è¯¢" aria-hidden="true">#</a> åˆå¹¶æŸ¥è¯¢</h3><ul><li><p>union(æ— é‡å¤å¹¶é›†) åˆå¹¶æ—¶ï¼Œä¸¤ä¸ªè¡¨å¯¹åº”çš„<strong>åˆ—æ•°å’Œæ•°æ®ç±»å‹å¿…é¡»ç›¸åŒ</strong></p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select * from A
union
select * from B;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>union all(æœ‰é‡å¤å¹¶é›†) ç›¸åŒæ•°æ®ä¸å»é‡ï¼Œæœ‰å¤šå°‘æ˜¾ç¤ºå¤šå°‘</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select * from A
union all
select * from B;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>intersect(äº¤é›†) æ˜¾ç¤ºåŒæ—¶æ»¡è¶³ä¸¤ä¸ªæŸ¥è¯¢çš„è®°å½• <strong>mysqlä¸æ”¯æŒ</strong></p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>minus(å·®é›†) æ˜¾ç¤ºæ»¡è¶³å‰ä¸€ä¸ªæŸ¥è¯¢ä½†ä¸æ»¡è¶³åä¸€ä¸ªæŸ¥è¯¢çš„è®°å½• <strong>mysqlä¸æ”¯æŒ</strong></p></li><li><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><h3 id="å¤šè¡¨æŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#å¤šè¡¨æŸ¥è¯¢" aria-hidden="true">#</a> å¤šè¡¨æŸ¥è¯¢-----</h3><ul><li><p>ç¬›å¡å°”ç§¯ ä¸¤ä¸ªé›†åˆå–å¥¹ä»¬çš„æ‰€æœ‰ç»„åˆæƒ…å†µ(å¹¶ä¸æ˜¯æ‰€æœ‰éƒ½æ˜¯æ­£ç¡®çš„æ•°æ®)ï¼Œæ‰€ä»¥è¦æ¶ˆé™¤æ— ç”¨æ•°æ®</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select * from table_a, table_b;
-- è·å–table_aå’Œtable_bçš„ç¬›å¡å°”ç§¯
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å†…è¿æ¥æŸ¥è¯¢</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- éšå¼å†…è¿æ¥ï¼šä½¿ç”¨whereæ¡ä»¶æ¶ˆé™¤æ— ç”¨æ•°æ®
-- ä¾‹å­
select * from emp, dept where emp.dept_id = dept.id;
select t1.name, t2.name from emp t1, dept t2 where t1.dept_id = t2.id;

-- æ˜¾å¼å†…è¿æ¥
-- è¯­æ³•
select å­—æ®µå from è¡¨å1 [inner] join è¡¨å2 on æ¡ä»¶; -- innerå¯ä»¥çœç•¥
-- ä¾‹å­
-- æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥çš„åå­—åŠå…¶éƒ¨é—¨çš„åå­—
select t1.name, t2.name from emp t1 inner join dept t2 on t1.dept.id = t2.id;


-- æ³¨æ„
-- æŸ¥è¯¢çš„è¡¨ã€æŸ¥è¯¢çš„æ¡ä»¶ã€æŸ¥è¯¢çš„å­—æ®µ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å¤–è¿æ¥æŸ¥è¯¢</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- å·¦å¤–è¿æ¥
-- è¯­æ³•
select å­—æ®µå from è¡¨å1 left [outer] join è¡¨å2 on æ¡ä»¶; -- outerå¯ä»¥çœç•¥
-- æŸ¥è¯¢çš„æ˜¯å·¦è¡¨æ‰€æœ‰æ•°æ®åŠå…¶äº¤é›†éƒ¨åˆ†,åœ¨å†…è¿æ¥åŸºç¡€ä¸Šä¿è¯å·¦è¡¨æ•°æ®å®Œæ•´,å¦‚æœä¸åŒ¹é…æ˜¾ç¤ºä¸ºnull
-- ä¾‹å­
-- æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥çš„åå­—åŠå…¶éƒ¨é—¨çš„åå­—ï¼Œæ²¡æœ‰éƒ¨é—¨çš„ä¹ŸæŸ¥å‡ºæ¥
select t1.name, t2.name from emp t1 left join dept t2 on emp.dept_id = t2.id;

-- å³å¤–è¿æ¥
-- è¯­æ³•
select å­—æ®µå from è¡¨å1 right [outer] join è¡¨å2 on æ¡ä»¶; -- outerå¯ä»¥çœç•¥
-- æŸ¥è¯¢çš„å³è¡¨æ‰€æœ‰æ•°æ®åŠå…¶äº¤é›†éƒ¨åˆ†
-- ä¾‹å­
-- æ²¡æœ‰éƒ¨é—¨çš„å‘˜å·¥æŸ¥è¯¢ä¸å‡ºæ¥
select t1.name, t2.name from emp t1 right join dept t2 on emp.dept_id = t2.id;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å­æŸ¥è¯¢</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- æŸ¥è¯¢ä¸­åµŒå¥—æŸ¥è¯¢ï¼Œç§°ä¸ºå­æŸ¥è¯¢

-- å­æŸ¥è¯¢çš„ç»“æœæ˜¯å•è¡Œå•åˆ—çš„
		-- å­æŸ¥è¯¢å¯ä»¥ä½œä¸ºæ¡ä»¶ï¼Œä½¿ç”¨è¿ç®—ç¬¦å»åˆ¤æ–­ï¼š&lt; &lt;= &gt; &gt;= =
-- ä¾‹å­ æŸ¥è¯¢å·¥èµ„å°äºå¹³å‡å·¥èµ„çš„äºº
select name from emp where salary &lt;= (select avg(salary) from emp);


-- å­æŸ¥è¯¢çš„ç»“æœæ˜¯å¤šè¡Œå•åˆ—çš„
		-- å­æŸ¥è¯¢å¯ä»¥ä½œä¸ºæ¡ä»¶ï¼Œä½¿ç”¨è¿ç®—ç¬¦å»åˆ¤æ–­ï¼šinã€not in
-- ä¾‹å­ æŸ¥è¯¢è´¢åŠ¡éƒ¨å’Œå¸‚åœºéƒ¨çš„å‘˜å·¥
select name from emp where dept_id in (select id from dept where name = &#39;è´¢åŠ¡éƒ¨&#39; or name = &#39;å¸‚åœºéƒ¨&#39;);


-- å­æŸ¥è¯¢çš„ç»“æœæ˜¯å¤šè¡Œå¤šåˆ—çš„
		-- å­æŸ¥è¯¢å¯ä»¥ä½œä¸ºè™šæ‹Ÿè¡¨ï¼Œå¯ä»¥å¯¹å…¶è¿›è¡Œæ™®é€šçš„è¡¨æŸ¥è¯¢
-- ä¾‹å­ æŸ¥è¯¢å‘˜å·¥å…¥èŒæ—¥æœŸæ˜¯2011-11-11ä¹‹åçš„å‘˜å·¥ä¿¡æ¯å’Œéƒ¨é—¨ä¿¡æ¯
select t1.name, t2.name from (select * from emp where join_date &gt; &#39;2011-11-11&#39;) t1, dept t2 where t1.dept_id = t2.id;
-- æ™®é€šå†…è¿æ¥æŸ¥è¯¢åšæ³•ï¼š
select t1.name, t2.name from emp t1 where t1.join_date &gt; &#39;2011-11-11&#39; join dept t2 on t1.dept = t2.id;
select t1.name, t2.name from emp t1, dept t2 where t1.dept_id = t2.id and t1.join_date &gt; &#39;2011-11-11&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç»ƒä¹ </p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- 1.æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥ä¿¡æ¯ã€‚æŸ¥è¯¢å‘˜å·¥ç¼–å·ï¼Œå‘˜å·¥å§“åï¼Œå·¥èµ„ï¼ŒèŒåŠ¡åç§°ï¼ŒèŒåŠ¡æè¿°
SELECT 
	t1.id, 
	t1.ename, 
	t1.salary, 
	t2.jname, 
	t2.description 
FROM 
	emp t1, 
	job t2 
WHERE 
	t1.job_id = t2.id;


-- 2.æŸ¥è¯¢å‘˜å·¥ç¼–å·ï¼Œå‘˜å·¥å§“åï¼Œå·¥èµ„ï¼ŒèŒåŠ¡åç§°ï¼ŒèŒåŠ¡æè¿°ï¼Œéƒ¨é—¨åç§°ï¼Œéƒ¨é—¨ä½ç½®
SELECT 
	t1.id, 
	t1.ename, 
	t1.salary, 
	t2.jname, 
	t2.description, 
	t3.dname, 
	t3.loc 
FROM 
	emp t1, 
	job t2, 
	dept t3 
WHERE 
	t1.job_id = t2.id 
	AND t1.dept_id = t3.id;


-- 3.æŸ¥è¯¢å‘˜å·¥å§“åï¼Œå·¥èµ„ï¼Œå·¥èµ„ç­‰çº§
SELECT
	t1.ename,
	t1.salary,
	t2.grade
FROM
	emp t1,
	salarygrade t2
WHERE
	t1.salary BETWEEN t2.losalary AND t2.hisalary;


-- 4.æŸ¥è¯¢å‘˜å·¥å§“åï¼Œå·¥èµ„ï¼ŒèŒåŠ¡åç§°ï¼ŒèŒåŠ¡æè¿°ï¼Œéƒ¨é—¨åç§°ï¼Œéƒ¨é—¨ä½ç½®ï¼Œå·¥èµ„ç­‰çº§
SELECT
	t1.ename,
	t1.salary,
	t2.jname,
	t2.description,
	t3.dname,
	t3.loc,
	t4.grade
FROM
	emp t1,
	job t2,
	dept t3,
	salarygrade t4
WHERE
	t1.job_id = t2.id 
	AND t1.dept_id = t3.id 
	AND t1.salary BETWEEN t4.losalary AND t4.hisalary;


-- 5.æŸ¥è¯¢å‡ºéƒ¨é—¨ç¼–å·ã€éƒ¨é—¨åç§°ã€éƒ¨é—¨ä½ç½®ã€éƒ¨é—¨äººæ•°
SELECT 
	t1.id,
	t1.dname,
	t1.loc,
	t2.`count`
FROM
	dept t1,
	(SELECT
		dept_id,
		COUNT(id) `count`
	FROM
		emp
	GROUP BY dept_id) t2
WHERE 
	t1.id = t2.dept_id;
 

-- 6.æŸ¥è¯¢æ‰€æœ‰å‘˜å·¥çš„å§“ååŠå…¶ç›´æ¥ä¸Šçº§çš„å§“å,æ²¡æœ‰é¢†å¯¼çš„å‘˜å·¥ä¹Ÿéœ€è¦æŸ¥è¯¢
SELECT
	t1.ename,
	t2.ename
FROM
	emp t1
LEFT JOIN
	emp t2
ON
	t1.mgr = t2.id;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="dcl" tabindex="-1"><a class="header-anchor" href="#dcl" aria-hidden="true">#</a> DCL</h2><h3 id="ç®¡ç†å‘˜æˆ·" tabindex="-1"><a class="header-anchor" href="#ç®¡ç†å‘˜æˆ·" aria-hidden="true">#</a> ç®¡ç†å‘˜æˆ·</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- æŸ¥è¯¢ç”¨æˆ·
select * from user;
-- é€šé…ç¬¦ï¼š% è¡¨ç¤ºå¯ä»¥åœ¨ä»»æ„ä¸»æœºä½¿ç”¨ç”¨æˆ·ç™»é™†æ•°æ®åº“

-- åˆ›å»ºç”¨æˆ·
create user &#39;ç”¨æˆ·å&#39;@&#39;ä¸»æœºå&#39; identified by &#39;å¯†ç &#39;;

-- åˆ é™¤ç”¨æˆ·
drop user &#39;ç”¨æˆ·å&#39;@&#39;ä¸»æœºå&#39;;

-- ä¿®æ”¹å¯†ç 
update user set password = password(&#39;æ–°å¯†ç &#39;) where user = &#39;ç”¨æˆ·å&#39;;
-- æˆ–
set password for &#39;ç”¨æˆ·å&#39;@&#39;ä¸»æœºå&#39; = password(&#39;æ–°å¯†ç &#39;)ï¼›

-- å¿˜è®°rootç”¨æˆ·å¯†ç 
-- 1.åœæ­¢mysqlæœåŠ¡ net stop mysql 
-- 2.ä½¿ç”¨æ— éªŒè¯æ–¹å¼å¯åŠ¨mysqlæœåŠ¡ mysqld --skip-grant-tables
-- 3.æ— éœ€ç”¨æˆ·å ç™»é™†mysqlæœåŠ¡
-- 4.è®¾ç½®rootç”¨æˆ·å¯†ç 
-- 5.æ€æ‰mysqldçš„è¿›ç¨‹
-- 6.å¯åŠ¨mysqlæœåŠ¡ï¼Œä½¿ç”¨æ–°å¯†ç ç™»é™†
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æˆæƒ" tabindex="-1"><a class="header-anchor" href="#æˆæƒ" aria-hidden="true">#</a> æˆæƒ</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- æŸ¥è¯¢æƒé™
SHOW GRANTS FOR &#39;ç”¨æˆ·å&#39;@&#39;ä¸»æœºå&#39;;

-- æˆäºˆæƒé™
GRANT æƒé™åˆ—è¡¨ on &#39;æ•°æ®åº“å&#39;.&#39;è¡¨å&#39; to &#39;ç”¨æˆ·å&#39;@&#39;ä¸»æœºå&#39;;
-- æˆäºˆæ‰€æœ‰æƒé™ on *.*

-- æ’¤é”€æƒé™
revoke æƒé™åˆ—è¡¨ on &#39;æ•°æ®åº“å&#39;.&#39;è¡¨å&#39; from &#39;ç”¨æˆ·å&#39;@&#39;ä¸»æœºå&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="çº¦æŸ" tabindex="-1"><a class="header-anchor" href="#çº¦æŸ" aria-hidden="true">#</a> çº¦æŸ</h2><p>æ¦‚å¿µï¼šå¯¹è¡¨ä¸­çš„<strong>æ•°æ®</strong>è¿›è¡Œé™å®šï¼Œä»è€Œä¿è¯æ•°æ®æ­£ç¡®æ€§ã€æœ‰æ•ˆæ€§ã€å®Œæ•´æ€§</p><h3 id="åˆ†ç±»" tabindex="-1"><a class="header-anchor" href="#åˆ†ç±»" aria-hidden="true">#</a> åˆ†ç±»</h3><ul><li>ä¸»é”®çº¦æŸï¼šprimary key</li><li>éç©ºçº¦æŸï¼šnot null</li><li>å”¯ä¸€çº¦æŸï¼šunique</li><li>å¤–é”®çº¦æŸï¼šforeign key</li></ul><h3 id="éç©ºçº¦æŸ-not-null" tabindex="-1"><a class="header-anchor" href="#éç©ºçº¦æŸ-not-null" aria-hidden="true">#</a> éç©ºçº¦æŸ not null</h3><ul><li><p>åˆ›å»ºè¡¨æ—¶æ·»åŠ çº¦æŸ</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>CREATE TABLE stu(
	id INT,
	name VARCHAR(20) NOT NULL -- nameä¸ºéç©º
);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åˆ é™¤éç©ºçº¦æŸ</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>alter table stu modify name varchar(20); -- åé¢ä¸å†™å°±ä»£è¡¨nameè¿™ä¸€åˆ—æ²¡æœ‰å…¶ä»–çº¦æŸäº†
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>ä¿®æ”¹è¡¨æ–¹å¼æ·»åŠ çº¦æŸ</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>alter table stu modify name varchar(20) not null;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><h3 id="å”¯ä¸€çº¦æŸ-unique" tabindex="-1"><a class="header-anchor" href="#å”¯ä¸€çº¦æŸ-unique" aria-hidden="true">#</a> å”¯ä¸€çº¦æŸ unique</h3><ul><li><p>åˆ›å»ºè¡¨æ—¶æ·»åŠ çº¦æŸ</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>CREATE TABLE stu(
	id INT,
	phone VARCHAR(20) UNIQUE -- æ·»åŠ å”¯ä¸€çº¦æŸ
);

-- æ³¨æ„ å”¯ä¸€çº¦æŸé™å®šçš„åˆ—çš„å€¼å¯ä»¥æœ‰å¤šä¸ªnull
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åˆ é™¤å”¯ä¸€çº¦æŸ</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>alter table stu drop index phone; -- åˆ é™¤å”¯ä¸€ç´¢å¼•
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>ä¿®æ”¹è¡¨æ–¹å¼æ·»åŠ çº¦æŸ</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>alter table stu modify phone varchar(20) unique; -- æ·»åŠ ä¹‹å‰åº”å…ˆæ£€æŸ¥åŸæœ‰æ•°æ®æ˜¯å¦ç¬¦åˆçº¦æŸ
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><h3 id="ä¸»é”®çº¦æŸ-primary-key" tabindex="-1"><a class="header-anchor" href="#ä¸»é”®çº¦æŸ-primary-key" aria-hidden="true">#</a> ä¸»é”®çº¦æŸ primary key</h3><ul><li><p>å«ä¹‰ï¼šéç©ºä¸”å”¯ä¸€ not null+uniqueï¼Œ è¡¨ä¸­è®°å½•çš„å”¯ä¸€æ ‡è¯†</p></li><li><p>ä¸€å¼ è¡¨åªèƒ½æœ‰ä¸€ä¸ªå­—æ®µä¸ºä¸»é”®</p></li><li><p>åˆ›å»ºè¡¨æ—¶æ·»åŠ çº¦æŸ</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>create table stu(
	id int primary key, -- ç»™idæ·»åŠ ä¸»é”®çº¦æŸ
  name varchar(20)
);

-- èšåˆä¸»é”®
primary key(col1, col2);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åˆ é™¤ä¸»é”®</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>alter table stu drop primary key; -- ç”±äºä¸€ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ï¼Œæ‰€ä»¥å¯ä»¥ä¸ç”¨æŒ‡å®šå­—æ®µå
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>ä¿®æ”¹è¡¨æ–¹å¼æ·»åŠ ä¸»é”®</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>alter table stu modify id int primary key;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>è‡ªåŠ¨å¢é•¿</p><ul><li><p>æ¦‚å¿µå¦‚æœæŸä¸€åˆ—æ˜¯æ•°å€¼ç±»å‹ï¼Œä½¿ç”¨auto_increment å¯ä»¥å®Œæˆè‡ªåŠ¨å¢é•¿ï¼Œä¹‹åèµ‹å€¼çš„æ—¶å€™èµ‹nullå€¼ä¹Ÿä¸ä¼šå½±å“ï¼Œnullå€¼ä¹‹å‰è‡ªå¢ã€‚è‡ªå¢æ˜¯æŒ‰ç…§ä¸Šä¸€æ¡è®°å½•çš„å€¼æ¥è‡ªå¢ï¼Œæ— è®ºå‰é¢çš„å€¼æ˜¯å¦è¿ç»­ã€‚</p></li><li><p>åˆ›å»ºè¡¨æ—¶æ·»åŠ ä¸»é”®çº¦æŸå¹¶å®Œæˆè‡ªåŠ¨å¢é•¿</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>create table stu(
	id int primary key auto_increment, -- ç»™idæ·»åŠ ä¸»é”®çº¦æŸ
  name varchar(20)
);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åˆ é™¤è‡ªåŠ¨å¢é•¿</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>alter table stu modify id int; -- åˆ é™¤è‡ªåŠ¨å¢é•¿ï¼Œä½†æ˜¯æ— æ³•åˆ é™¤ä¸»é”®
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>ä¿®æ”¹è¡¨çš„æ–¹å¼æ·»åŠ è‡ªåŠ¨å¢é•¿</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>alter table stu modify id int auto_increment;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul></li></ul><h3 id="å¤–é”®çº¦æŸ-foreign-key" tabindex="-1"><a class="header-anchor" href="#å¤–é”®çº¦æŸ-foreign-key" aria-hidden="true">#</a> å¤–é”®çº¦æŸ foreign key</h3><ul><li><p>è®©è¡¨äºè¡¨äº§ç”Ÿå…³ç³»ï¼Œä¿è¯æ•°æ®çš„æ­£ç¡®æ€§</p></li><li><p>åˆ›å»ºè¡¨æ—¶å»ºç«‹å¤–é”®</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- è¯­æ³•
create table è¡¨å {
	...
	å¤–é”®åˆ—
	constraint å¤–é”®åç§° foreign key (å¤–é”®åˆ—) references ä¸»è¡¨åç§°(åˆ—å)
}

-- å¯ä»¥çœç•¥constraint å¤–é”®åç§°ï¼Œ ç³»ç»Ÿä¼šåˆ†é…ä¸€ä¸ªå”¯ä¸€çš„åç§°ç»™è¿™ä¸ªå¤–é”®
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åˆ é™¤å¤–é”®</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>alter table è¡¨å drop foreign key å¤–é”®å;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>æ·»åŠ å¤–é”®</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>alter table è¡¨å add constraint å¤–é”®å foreign key (å¤–é”®åˆ—) references ä¸»è¡¨åç§°(åˆ—å);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>çº§è”æ“ä½œ</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- è¯­æ³•
alter table è¡¨å add constraint å¤–é”®å foreign key (å¤–é”®åˆ—) references ä¸»è¡¨åç§°(åˆ—å)
on update cascade on delete cascade;


-- åˆ†ç±»
-- çº§è”æ›´æ–°ã€çº§è”åˆ é™¤
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="æ•°æ®åº“è¿˜åŸä¸å¤‡ä»½" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åº“è¿˜åŸä¸å¤‡ä»½" aria-hidden="true">#</a> æ•°æ®åº“è¿˜åŸä¸å¤‡ä»½</h2><ul><li><p>å‘½ä»¤è¡Œæ–¹å¼</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>å¤‡ä»½ï¼šmysqldump -uç”¨æˆ·å -på¯†ç  æ•°æ®åº“å &gt; ä¿å­˜çš„è·¯å¾„

è¿˜åŸï¼š
	1.ç™»é™†æ•°æ®åº“
	2.åˆ›å»ºæ•°æ®åº“
	3.ä½¿ç”¨æ•°æ®åº“
	4.æ‰§è¡Œæ–‡ä»¶ source æ–‡ä»¶è·¯å¾„
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å›¾å½¢åŒ–å·¥å…·æ–¹å¼</p></li></ul><h2 id="select-è¯­å¥å®Œæ•´çš„æ‰§è¡Œé¡ºåº" tabindex="-1"><a class="header-anchor" href="#select-è¯­å¥å®Œæ•´çš„æ‰§è¡Œé¡ºåº" aria-hidden="true">#</a> select è¯­å¥å®Œæ•´çš„æ‰§è¡Œé¡ºåº</h2><ol><li><strong>from å­å¥ç»„è£…æ¥è‡ªä¸åŒæ•°æ®æºçš„æ•°æ®</strong>ï¼Œæ‰€ä»¥ä¸ºè¡¨åˆ›å»ºåˆ«åï¼Œåˆ«çš„åœ°æ–¹èƒ½ç”¨</li><li><strong>join...on å­å¥</strong></li><li><strong>where å­å¥åŸºäºæŒ‡å®šçš„æ¡ä»¶å¯¹è®°å½•è¡Œè¿›è¡Œç­›é€‰</strong></li><li><strong>group by å­å¥å°†æ•°æ®åˆ’åˆ†ä¸ºå¤šä¸ªåˆ†ç»„</strong></li><li><strong>ä½¿ç”¨èšé›†å‡½æ•°è¿›è¡Œè®¡ç®—</strong></li><li><strong>ä½¿ç”¨ having å­å¥ç­›é€‰åˆ†ç»„</strong></li><li>è®¡ç®—æ‰€æœ‰çš„è¡¨è¾¾å¼</li><li><strong>select çš„å­—æ®µ</strong></li><li>distinct</li><li><strong>ä½¿ç”¨ order by å¯¹ç»“æœé›†è¿›è¡Œæ’åº</strong></li></ol><h2 id="inå’ŒexistsåŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#inå’ŒexistsåŒºåˆ«" aria-hidden="true">#</a> Inå’ŒExistsåŒºåˆ«</h2><h3 id="in" tabindex="-1"><a class="header-anchor" href="#in" aria-hidden="true">#</a> In</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select 
	*
from
	A
where
	A.field IN (
    select 
    	B.field
    from
    	B
  )
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œé¡ºåº</p><ol><li>æ‰§è¡Œå­æŸ¥è¯¢</li><li>å°†æŸ¥è¯¢ç»“æœå’ŒåŸæœ‰çš„Aè¡¨åšç¬›å¡å°”ç§¯</li><li>å†æ ¹æ®<code>where A.field IN B.field</code>çš„æ¡ä»¶è¿›è¡Œç­›é€‰</li></ol><h3 id="exists" tabindex="-1"><a class="header-anchor" href="#exists" aria-hidden="true">#</a> Exists</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>SELECT
	A.*
FROM
	A
WHERE
	EXISTS (
		SELECT
			B.user_id
		FROM
			B
		WHERE
			A.id = B.user_id
	)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ‰§è¡Œé¡ºåº</p><ol><li>æ‰§è¡Œä¸»æŸ¥è¯¢</li><li>å°†æŸ¥è¯¢ç»“æœæ‰§è¡Œ<code>EXISTS</code>å­å¥</li><li>ä¾æ¬¡å»åˆ¤æ–­åé¢çš„æ¡ä»¶æ˜¯å¦æˆç«‹</li></ol><h3 id="åº”ç”¨åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#åº”ç”¨åœºæ™¯" aria-hidden="true">#</a> åº”ç”¨åœºæ™¯</h3><p>å¦‚æœ<strong>å­æŸ¥è¯¢</strong>å¾—å‡ºçš„ç»“æœé›†<strong>è®°å½•è¾ƒå°‘</strong>ï¼Œ<strong>ä¸»æŸ¥è¯¢</strong>ä¸­çš„<strong>è¡¨è¾ƒå¤§</strong>ä¸”åˆæœ‰ç´¢å¼•æ—¶åº”è¯¥ç”¨<code>in</code></p><p>å¦‚æœ<strong>ä¸»æŸ¥è¯¢è®°å½•è¾ƒå°‘</strong>ï¼Œ<strong>å­æŸ¥è¯¢ä¸­çš„è¡¨å¤§</strong>ï¼Œåˆæœ‰ç´¢å¼•æ—¶ä½¿ç”¨<code>exists</code></p><p>å¦‚æœæ˜¯existsï¼Œé‚£ä¹ˆä»¥å¤–å±‚è¡¨ä¸ºé©±åŠ¨è¡¨ï¼Œå…ˆè¢«è®¿é—®ï¼Œå¦‚æœæ˜¯INï¼Œé‚£ä¹ˆå…ˆæ‰§è¡Œå­æŸ¥è¯¢ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šä»¥é©±åŠ¨è¡¨çš„å¿«é€Ÿè¿”å›ä¸ºç›®æ ‡</p><p>å¦‚æœæŸ¥è¯¢è¯­å¥ä½¿ç”¨äº†not in é‚£ä¹ˆå†…å¤–è¡¨éƒ½è¿›è¡Œå…¨è¡¨æ‰«æï¼Œæ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼›è€Œnot extsts çš„å­æŸ¥è¯¢ä¾ç„¶èƒ½ç”¨åˆ°è¡¨ä¸Šçš„ç´¢å¼•ã€‚<strong>æ‰€ä»¥æ— è®ºé‚£ä¸ªè¡¨å¤§ï¼Œç”¨not existséƒ½æ¯”not inè¦å¿«</strong>ã€‚</p><h2 id="å¸¸ç”¨æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#å¸¸ç”¨æ“ä½œ" aria-hidden="true">#</a> å¸¸ç”¨æ“ä½œ</h2><h3 id="å­—ç¬¦ä¸²æˆªå–" tabindex="-1"><a class="header-anchor" href="#å­—ç¬¦ä¸²æˆªå–" aria-hidden="true">#</a> å­—ç¬¦ä¸²æˆªå–</h3><ul><li>left(str, length): ä»å­—ç¬¦ä¸²å·¦è¾¹æˆªå–lengthçš„é•¿åº¦</li><li>right(str, length): ä»å­—ç¬¦ä¸²å³è¾¹æˆªå–lengthçš„é•¿åº¦</li><li>substring(str, pos, len): ä»å­—ç¬¦ä¸²çš„ç¬¬posä¸ªä½ç½®å¼€å§‹æˆªå–ï¼Œlenä¸ºç©ºçš„è¯ä»£è¡¨æˆªå–åˆ°ç»“å°¾</li></ul><h3 id="ç±»å‹è½¬æ¢" tabindex="-1"><a class="header-anchor" href="#ç±»å‹è½¬æ¢" aria-hidden="true">#</a> ç±»å‹è½¬æ¢</h3><ul><li>cast(value as type)</li><li>convert(value, type)</li><li>type: DECIMALæµ®ç‚¹æ•°ã€SIGNEDæ•´å‹ã€UNSIGNEDæ— ç¬¦å·æ•´æ•°</li></ul><h3 id="å­—æ®µé€’å¢èµ‹å€¼" tabindex="-1"><a class="header-anchor" href="#å­—æ®µé€’å¢èµ‹å€¼" aria-hidden="true">#</a> å­—æ®µé€’å¢èµ‹å€¼</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- è®¾ç½®ä¸€ä¸ªå˜é‡ æ³¨æ„@
set @r:=0;
-- èµ‹å€¼
update tablename set id=(@r:=@r+1)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ ¼å¼åŒ–å­—ç¬¦ä¸²è¡¥0" tabindex="-1"><a class="header-anchor" href="#æ ¼å¼åŒ–å­—ç¬¦ä¸²è¡¥0" aria-hidden="true">#</a> æ ¼å¼åŒ–å­—ç¬¦ä¸²è¡¥0</h3><ul><li>LPAD(str, len, 0): å·¦è¾¹è¡¥0</li><li>RPAD(str, len, 0): å³è¾¹è¡¥0</li><li>å¦‚æœlenå°äºstrçš„é•¿åº¦ï¼Œåˆ™æˆªå–str</li></ul><h2 id="explainè§£æ" tabindex="-1"><a class="header-anchor" href="#explainè§£æ" aria-hidden="true">#</a> explainè§£æ</h2><h3 id="id" tabindex="-1"><a class="header-anchor" href="#id" aria-hidden="true">#</a> id</h3><ul><li><p>æœ‰å¤šå°‘ä¸ªä¸åŒçš„idå°±è¯´æ˜æœ‰å¤šå°‘ä¸ªæŸ¥è¯¢(ä¸»æŸ¥è¯¢+å­æŸ¥è¯¢)ï¼Œä»idå¤§åˆ°å°æ‰§è¡Œ</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- æŸ¥è¯¢mysqlè¯¾ç¨‹çš„è€å¸ˆæ‰‹æœºå·
explain
select tc.phone
from teacher_contact tc
where tcid = (
	select tcid
	from teacher t
	where t.tid = (
  	select c.tid
  	from course c
  	where c.cname = &#39;mysql&#39;
  )
);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/image-20200930181447617.png" alt="image-20200930181447617"></p></li><li><p>ç›¸åŒçš„idï¼Œtableåˆ—ä»ä¸Šåˆ°ä¸‹æŸ¥è¯¢ã€‚(æ•°æ®é‡ä¼šå½±å“sqlè¯­å¥æ‰§è¡Œé¡ºåº--å°è¡¨é©±åŠ¨å¤§è¡¨)</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- æŸ¥è¯¢è¯¾ç¨‹idä¸º2ï¼Œæˆ–è€…è”ç³»è¡¨idä¸º3çš„è€å¸ˆ
explain
select t.tname, c.cname, tc.phone
from teacher t, course c, teacher_contact tc
where t.tid = c.tid
and t.tcid = tc.tcid
and (
  c.cid = 2 or tc.tcid = 3
);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢è¡¨çš„é¡ºåºæ˜¯ tc--t--c</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/image-20201003152102982.png" alt="image-20201003152102982"></p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- åˆ æ‰ä¸‰è¡Œ
delete from teacher where tid in (4,5,6);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>æŸ¥è¯¢è¡¨çš„é¡ºåºæ˜¯ t--c--tc</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/image-20201003152450710.png" alt="image-20201003152450710"></p><p>å…³è”æŸ¥è¯¢æœ¬è´¨æ˜¯ç¬›å¡å°”ç§¯ï¼Œæœ€ç»ˆæ•°é‡ç­‰äºa * b * cï¼Œ<strong>æŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šé€‰æ‹©ä¸­é—´ç»“æœæ¯”è¾ƒå°‘çš„æ‰§è¡Œæ–¹å¼</strong></p></li></ul><h3 id="select-type" tabindex="-1"><a class="header-anchor" href="#select-type" aria-hidden="true">#</a> select_type</h3><ul><li><p>SIMPLEã€‚æ²¡æœ‰å­æŸ¥è¯¢ï¼Œæ²¡æœ‰å…³è”æŸ¥è¯¢</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>explain select * from teacher;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>PRIMARYã€‚åµŒå¥—æŸ¥è¯¢ä¸­æœ€å¤–å±‚çš„æŸ¥è¯¢</p></li><li><p>SUBQUERYã€‚å­æŸ¥è¯¢</p></li><li><p>DERIVEDã€‚è¡ç”ŸæŸ¥è¯¢ï¼ŒæŸ¥è¯¢ä¸­å‡ºç°ä¸´æ—¶ç»“æœï¼Œä¸­é—´æ‹¬å·éƒ¨åˆ†å«ä¸´æ—¶è¡¨æˆ–æ´¾ç”Ÿè¡¨</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>explain select cr.name
from (
	select * from course where t.id = 1
	union
  select * from course where t.id = 2 
) cr;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/image-20201003153741682.png" alt="image-20201003153741682"></p></li><li><p>UNIONã€‚ç”¨åˆ°äº†unionå…³é”®å­—çš„æŸ¥è¯¢</p></li></ul><h3 id="type-è¿æ¥ç±»å‹" tabindex="-1"><a class="header-anchor" href="#type-è¿æ¥ç±»å‹" aria-hidden="true">#</a> type(è¿æ¥ç±»å‹)</h3><p>æŒ‰æ•ˆç‡ä»ä¸Šå¾€ä¸‹æ’åº</p><ul><li>å¯é‡ä¸å¯æ±‚ <ul><li>nullã€‚MySQL åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­åˆ†è§£è¯­å¥ï¼Œ<strong>æ‰§è¡Œæ—¶ç”šè‡³ä¸ç”¨è®¿é—®è¡¨æˆ–ç´¢å¼•</strong>ï¼Œä¾‹å¦‚ä»ä¸€ä¸ªç´¢å¼•åˆ—é‡Œé€‰å–æœ€å°å€¼å¯ä»¥é€šè¿‡å•ç‹¬ç´¢å¼•æŸ¥æ‰¾å®Œæˆã€‚</li><li>systemï¼Œconstç±»å‹çš„ä¸€ç§ç‰¹ä¾‹ï¼Œè·Ÿè¿æ¥ä¸­mysqlåº“æœ‰å…³è”ã€‚<strong>å½“æŸ¥è¯¢ç³»ç»Ÿè¡¨ä¸­åªæœ‰ä¸€è¡Œç»“æœçš„æƒ…å†µ</strong></li><li>constï¼Œå¸¸é‡ã€‚<strong>å•è¡¨æŸ¥è¯¢</strong>ï¼Œå½“ä½¿ç”¨ä¸»é”®ç´¢å¼•æˆ–å”¯ä¸€ç´¢å¼•æŸ¥è¯¢åˆ°åªæœ‰ä¸€è¡Œç»“æœçš„æƒ…å†µï¼Œæ€§èƒ½éå¸¸å¥½çš„ä¸€ç§æŸ¥è¯¢</li><li>eq_refã€‚<strong>å…³è”æŸ¥è¯¢ä¸­</strong>ï¼Œç”¨ç´¢å¼•å»æŸ¥è¯¢æ•°æ®æ—¶ï¼Œä¸€ä¸ªç´¢å¼•åªæœ‰ä¸€æ¡è®°å½•å¯¹åº”(<strong>å”¯ä¸€ç´¢å¼•unique indexï¼Œèšé›†ç´¢å¼•primary index</strong>)ï¼Œå½“æ‰¾åˆ°ä¸€æ¡æ•°æ®åé©¬ä¸Šåœæ­¢æœç´¢ã€‚</li></ul></li><li>ä¼˜åŒ–çš„ç›®æ ‡ <ul><li>refã€‚å…³è”æŸ¥è¯¢ä¸­ï¼Œä½¿ç”¨éå”¯ä¸€ç´¢å¼•æŸ¥è¯¢æ•°æ®ï¼Œä¸€ä¸ªç´¢å¼•å¯èƒ½å¯¹åº”å¤šæ¡è®°å½•ï¼Œæ‰€ä»¥æœç´¢åˆ°ä¸€æ¡è®°å½•åï¼Œè¦è¿›è¡Œç›®æ ‡å€¼é™„è¿‘çš„å°èŒƒå›´æ‰«æï¼Œä½†ä¹Ÿä¸ä¼šè¿›è¡Œå…¨è¡¨æ‰«æ</li><li>rangeã€‚èŒƒå›´æŸ¥è¯¢ï¼Œå¤§äºã€å°äºã€<code>in</code>ã€<code>between and</code>ã€‚åªæ£€ç´¢ç»™å®šèŒƒå›´çš„è¡Œï¼Œä½¿ç”¨ä¸€ä¸ªç´¢å¼•æ¥é€‰æ‹©è¡Œ</li></ul></li><li>ä¸€å®šéœ€è¦ä¼˜åŒ–çš„æƒ…å†µ <ul><li>indexã€‚æ²¡æœ‰è¿‡æ»¤æ¡ä»¶ï¼ŒæŸ¥è¯¢ç´¢å¼•ä¸Šå…¨éƒ¨çš„æ•°æ®ï¼Œ<strong>éå†ç´¢å¼•æ ‘</strong>ã€‚</li><li>allã€‚æ²¡æœ‰ç”¨åˆ°ä»»ä½•ç´¢å¼•æˆ–è¿™å¼ è¡¨æ²¡æœ‰ç´¢å¼•ï¼Œä»£è¡¨<strong>å…¨è¡¨æ‰«æ</strong>ã€‚</li></ul></li></ul><h3 id="possible-keys-å¯èƒ½ç”¨åˆ°çš„ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#possible-keys-å¯èƒ½ç”¨åˆ°çš„ç´¢å¼•" aria-hidden="true">#</a> possible_keys(å¯èƒ½ç”¨åˆ°çš„ç´¢å¼•)</h3><h3 id="key-å®é™…ç”¨åˆ°çš„ç´¢å¼•" tabindex="-1"><a class="header-anchor" href="#key-å®é™…ç”¨åˆ°çš„ç´¢å¼•" aria-hidden="true">#</a> key(å®é™…ç”¨åˆ°çš„ç´¢å¼•)</h3><p>possible_keysä¸ºnullï¼Œkeyä¸ä¸ºnullçš„æƒ…å†µ</p><blockquote><p>å½“è¡¨ä¸­å­˜åœ¨è”åˆç´¢å¼•(a,b,c)æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹sqlè¯­å¥ select b from tab where b = &#39;xxx&#39;;</p><p>possible_keysä¸ºnullï¼Œkeyä¸ºcomidx_a_b_cï¼ŒExtraæœ‰Using index</p><p>å’Œç´¢å¼•è¦†ç›–æœ‰ä¸€å®šè”ç³»ï¼šç†è®ºä¸Šæ²¡æœ‰ä½¿ç”¨åˆ°ç´¢å¼•ï¼Œä½†æ˜¯ç”±äºæŸ¥è¯¢çš„æ•°æ®åˆšå¥½åœ¨ç´¢å¼•çš„å­—æ®µä¸­ï¼Œæ‰€ä»¥è¿˜æ˜¯ä¼šåœ¨ç´¢å¼•ä¸­æ£€ç´¢æ•°æ®</p></blockquote><h3 id="key-len-ç´¢å¼•çš„é•¿åº¦" tabindex="-1"><a class="header-anchor" href="#key-len-ç´¢å¼•çš„é•¿åº¦" aria-hidden="true">#</a> key_len(ç´¢å¼•çš„é•¿åº¦)</h3><p>æ ¹æ®å®é™…ç”¨åˆ°çš„ç´¢å¼•æ¥è®¡ç®—ç´¢å¼•çš„é•¿åº¦ï¼Œä¸ç´¢å¼•å­—æ®µçš„ç±»å‹åŠå…¶é•¿åº¦æœ‰å…³ç³»ï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªå€¼å»åˆ¤æ–­æ˜¯ä¸æ˜¯ç”¨åˆ°æœŸæœ›çš„ç´¢å¼•</p><h3 id="rows-ä¼°ç®—æ‰¾åˆ°å¯¹åº”è®°å½•æ‰€éœ€è¦çš„è¡Œæ•°" tabindex="-1"><a class="header-anchor" href="#rows-ä¼°ç®—æ‰¾åˆ°å¯¹åº”è®°å½•æ‰€éœ€è¦çš„è¡Œæ•°" aria-hidden="true">#</a> rows(ä¼°ç®—æ‰¾åˆ°å¯¹åº”è®°å½•æ‰€éœ€è¦çš„è¡Œæ•°)</h3><h3 id="extra" tabindex="-1"><a class="header-anchor" href="#extra" aria-hidden="true">#</a> Extra</h3><ul><li>æ¯”è¾ƒå¥½çš„æƒ…å†µ <ul><li><code>Using index</code> è¦†ç›–ç´¢å¼•ï¼Œç´¢å¼•è¦†ç›–äº†æŸ¥è¯¢çš„åˆ—ï¼Œä¸éœ€è¦å›è¡¨</li><li><code>Using index condition</code> ç´¢å¼•ä¸‹æ¨ï¼ŒæœåŠ¡ç«¯æŠŠæ¡ä»¶ä¸‹æ¨ç»™å­˜å‚¨å¼•æ“</li></ul></li><li>æ™®é€šçš„ <ul><li><code>Using where</code> ä¸ç”¨è¯»å–è¡¨ä¸­æ‰€æœ‰ä¿¡æ¯ï¼Œä»…é€šè¿‡ç´¢å¼•å°±å¯ä»¥è·å–æ‰€éœ€æ•°æ®ï¼Œè¿™å‘ç”Ÿåœ¨å¯¹è¡¨çš„å…¨éƒ¨çš„è¯·æ±‚åˆ—éƒ½æ˜¯åŒä¸€ä¸ªç´¢å¼•çš„éƒ¨åˆ†çš„æ—¶å€™ï¼Œä»å­˜å‚¨å¼•æ“ä¸­è·å–æ•°æ®åè¿˜éœ€è¦åœ¨æœåŠ¡ç«¯ä¸­å†æ¬¡è¿‡æ»¤</li><li><code>Using filesort</code> ä¸èƒ½åŸºäºç´¢å¼•(whereå­å¥ä¸­çš„æ¡ä»¶)æ’åºï¼Œä½¿ç”¨äº†é¢å¤–çš„æ–¹å¼(orderå­—å¥)æ¥æ’åº</li><li><code>Using temporary</code> ä½¿ç”¨äº†ä¸´æ—¶è¡¨ã€‚ <ul><li>åœ¨æ²¡æœ‰ç´¢å¼•çš„åˆ—ä¸Šä½¿ç”¨<code>distinct</code>æŸ¥è¯¢æ—¶</li><li>åœ¨æ²¡æœ‰ç´¢å¼•çš„åˆ—ä¸Šä½¿ç”¨<code>group by</code>æ“ä½œ</li><li>åš<code>join</code>æŸ¥è¯¢æ—¶ï¼Œå¯¹ä»»æ„ä¸€ä¸ªåˆ—è¿›è¡Œ<code>group by</code>æ“ä½œ</li><li>æ’åº<code>order by</code>æ“ä½œ</li></ul></li></ul></li></ul><h1 id="å­˜å‚¨å¼•æ“" tabindex="-1"><a class="header-anchor" href="#å­˜å‚¨å¼•æ“" aria-hidden="true">#</a> å­˜å‚¨å¼•æ“</h1><p>MyISAMã€InnoDBã€HEAPã€BOBã€ARCHIVEã€CSVç­‰</p><h2 id="innodb" tabindex="-1"><a class="header-anchor" href="#innodb" aria-hidden="true">#</a> InnoDB</h2><p>MySQLé»˜è®¤äº‹åŠ¡å‹å¼•æ“</p><ul><li>æ•°æ®å­˜å‚¨åœ¨è¡¨ç©ºé—´(ç”±InnoDBç®¡ç†çš„ä¸€ä¸ªé»‘ç›’å­ï¼Œç”±ä¸€ç³»åˆ—æ•°æ®æ–‡ä»¶ç»„æˆ)ä¸­ã€‚</li><li>é‡‡ç”¨MVCCæ¥æ”¯æŒé«˜å¹¶å‘ï¼Œå®ç°äº†å››ä¸ªæ ‡å‡†çš„éš”ç¦»çº§åˆ«ã€‚é»˜è®¤æ˜¯repeatable readã€‚é€šè¿‡<strong>é—´éš™é”</strong>çš„ç­–ç•¥é˜²æ­¢å¹»è¯»çš„å‡ºç°</li><li>åŸºäºç°‡ç»„ç´¢å¼•å»ºç«‹çš„</li><li>æ”¯æŒ<strong>äº‹åŠ¡</strong></li><li>æ”¯æŒ<strong>å¤–é”®</strong></li><li>æ”¯æŒ<strong>è¡Œçº§é”</strong>ï¼›åˆé€‚äºæ’å…¥å’Œæ›´æ–°æ“ä½œæ¯”è¾ƒå¤šçš„åº”ç”¨ï¼Œé€‚åˆå¤§æ•°æ®ï¼Œå¤§å¹¶å‘ã€‚</li></ul><h2 id="myisam" tabindex="-1"><a class="header-anchor" href="#myisam" aria-hidden="true">#</a> MyISAM</h2><ul><li>å°†è¡¨å­˜å‚¨åœ¨ä¸¤ä¸ªæ–‡ä»¶ä¸­ï¼šæ•°æ®æ–‡ä»¶(.MYD)ã€ç´¢å¼•æ–‡ä»¶(.MYI)</li><li><strong>è¡¨çº§é”</strong>ï¼›é’ˆå¯¹è¡¨åŠ é”ï¼Œè¯»å–æ—¶ä¼šå¯¹æ‰€æœ‰éœ€è¦è¯»çš„è¡¨åŠ ä¸Šå…±äº«é”ï¼Œå†™å…¥æ—¶å¯¹è¡¨åŠ ä¸Šæ’ä»–é”ã€‚æ”¯æŒå¹¶å‘æ’å…¥ï¼ŒæŸ¥è¯¢çš„åŒæ—¶å¯ä»¥æ’å…¥æ–°è®°å½•ã€‚é€‚åˆç”¨äº<strong>é¢‘ç¹æŸ¥è¯¢</strong>çš„åº”ç”¨ã€‚è¡¨é”ï¼Œä¸ä¼šå‡ºç°æ­»é”ï¼Œé€‚åˆ<strong>å°æ•°æ®ï¼Œå°å¹¶å‘</strong>ã€‚</li><li>ç´¢å¼•ï¼Œå°±ç®—æ˜¯blobå’Œtextç±»å‹ä¹Ÿå¯ä»¥åŸºäºå‰500ä¸ªå­—ç¬¦æ¥å»ºç«‹ç´¢å¼•ã€‚ä¹Ÿæ”¯æŒå…¨æ–‡ç´¢å¼•ï¼Œæ˜¯ä¸€ç§åŸºäºåˆ†è¯åˆ›å»ºçš„</li></ul><h1 id="äº‹åŠ¡" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡" aria-hidden="true">#</a> äº‹åŠ¡</h1><h2 id="æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#æ¦‚å¿µ" aria-hidden="true">#</a> æ¦‚å¿µ</h2><p>æ•°æ®åº“æœ€å°çš„å·¥ä½œå•å…ƒ</p><p>å¦‚æœä¸€ä¸ªåŒ…å«å¤šä¸ªæ­¥éª¤çš„ä¸šåŠ¡æ“ä½œï¼Œè¢«äº‹åŠ¡ç®¡ç†ï¼Œé‚£ä¹ˆè¿™äº›æ“ä½œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥ã€‚</p><h2 id="æ“ä½œ" tabindex="-1"><a class="header-anchor" href="#æ“ä½œ" aria-hidden="true">#</a> æ“ä½œ</h2><ul><li>å¼€å¯äº‹åŠ¡ï¼š<code>start transaction</code></li><li>äº‹åŠ¡å›æ»šï¼š<code>rollback</code></li><li>äº‹åŠ¡æäº¤ï¼š<code>commit</code></li></ul><p>å¼€å¯äº‹åŠ¡åï¼Œæ²¡æœ‰è¿›è¡Œå›æ»šæˆ–æäº¤ä¹‹å‰ï¼Œæ•°æ®ä¼šå‘ç”Ÿâ€œä¸´æ—¶â€çš„å˜åŒ–ï¼Œä½†æ˜¯è¿™ä¸ªå˜åŒ–ä¸æ˜¯æŒä¹…çš„ï¼Œå½“å…³é—­å½“å‰çª—å£ï¼Œæ•°æ®å°±ä¼šè‡ªåŠ¨é»˜è®¤å›æ»šåˆ°ä¹‹å‰çš„çŠ¶æ€ã€‚å¦‚æœå‘ç°è¿‡ç¨‹ä¸­æœ‰å¤±è´¥çš„ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å›æ»šï¼Œå›æ»šåˆ°äº‹åŠ¡å¼€å¯çš„æ—¶å€™æ•°æ®çš„çŠ¶æ€ï¼›å¦‚æœæ•´ä¸ªè¿‡ç¨‹éƒ½æˆåŠŸï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨äº‹åŠ¡æäº¤ï¼Œè®©è¿™ä¸ªä¸´æ—¶çš„å˜åŒ–å˜æˆæŒä¹…çš„å˜åŒ–ã€‚</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- å¼€å¯äº‹åŠ¡
start transaction

-- è½¬è´¦
update account set balance = balance - 500 where name = &#39;å¼ ä¸‰&#39;;
-- å‡ºé”™äº† å¯¼è‡´å¼ ä¸‰çš„é’±æ‰£äº†ï¼Œä½†æ˜¯æå››çš„é’±æ²¡æœ‰æ‰£åˆ°
update account set balance = balance + 500 where name = &#39;æå››&#39;;

-- å‘ç°äº‹åŠ¡æœ‰é—®é¢˜ï¼Œè¿›è¡Œäº‹åŠ¡å›æ»š
rollback;

-- å‘ç°äº‹åŠ¡æ²¡æœ‰é—®é¢˜ï¼Œè¿›è¡Œäº‹åŠ¡æäº¤
commit;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>äº‹åŠ¡æäº¤çš„ä¸¤ç§æ–¹å¼</p><ul><li>è‡ªåŠ¨ <ul><li>mysqlå°±æ˜¯é»˜è®¤è‡ªåŠ¨æäº¤çš„ã€‚ä¸€æ¡DMLè¯­å¥å°±ä¼šè‡ªåŠ¨æäº¤ä¸€æ¬¡äº‹åŠ¡</li></ul></li><li>æ‰‹åŠ¨ <ul><li>éœ€è¦å…ˆ<code>start transaction</code>å¼€å¯äº‹åŠ¡ï¼Œå†<code>commit</code>æäº¤äº‹åŠ¡ï¼›åœ¨å¤„ç†è¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°é”™è¯¯ï¼ŒMySQLä¸€èˆ¬ä¼šè‡ªåŠ¨å›æ»š</li></ul></li></ul><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- æŸ¥çœ‹äº‹åŠ¡é»˜è®¤çš„æäº¤æ–¹å¼
select @@autocommit; -- 1 è‡ªåŠ¨æäº¤ 2 æ‰‹åŠ¨æäº¤

-- ä¿®æ”¹é»˜è®¤æäº¤æ–¹å¼
set @@autocommit = 0;
-- ä¿®æ”¹ä¹‹åæ¯æ¬¡çš„dmlè¯­å¥çš„æ‰§è¡Œè‹¥æƒ³æŒä¹…åŒ–æ”¹å˜å°±è¦æ‰‹åŠ¨æ‰§è¡Œcommitè¯­å¥
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="å››å¤§ç‰¹å¾" tabindex="-1"><a class="header-anchor" href="#å››å¤§ç‰¹å¾" aria-hidden="true">#</a> å››å¤§ç‰¹å¾</h2><ul><li>åŸå­æ€§(Atomicity)ï¼šäº‹åŠ¡æ˜¯ä¸å¯å†åˆ†å‰²çš„æœ€å°æ“ä½œå•ä½ï¼Œäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆåŒæ—¶æˆåŠŸï¼Œè¦ä¹ˆåŒæ—¶å¤±è´¥</li><li>ä¸€è‡´æ€§(Consiitency)ï¼šäº‹åŠ¡æ“ä½œå‰åï¼Œæ•°æ®ã€ç»“æ„å®Œæ•´æ€§ä¸è¢«ç ´å</li><li>éš”ç¦»æ€§(Isolation)ï¼šå¤šä¸ªäº‹åŠ¡ä¹‹é—´ï¼Œç›¸äº’ç‹¬ç«‹ã€‚ä¸€ä¸ªäº‹åŠ¡æ‰€åšçš„ä¿®æ”¹åœ¨æœ€ç»ˆæäº¤å‰ï¼Œå¯¹å…¶ä»–çš„äº‹åŠ¡ä¸å¯è§</li><li>æŒä¹…æ€§(Durability)ï¼šå¦‚æœäº‹åŠ¡æäº¤æˆ–è€…å›æ»šï¼Œé‚£ä¹ˆå®ƒä¼šæŒä¹…åœ°æ›´æ–°æ•°æ®åº“</li><li>Cæ˜¯ç›®çš„ï¼ŒAIDæ˜¯æ‰‹æ®µ</li></ul><h2 id="äº‹åŠ¡å››å¤§ç‰¹æ€§ä¸­åŸå­æ€§ã€æŒä¹…æ€§ã€éš”ç¦»æ€§å®ç°åŸç†" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡å››å¤§ç‰¹æ€§ä¸­åŸå­æ€§ã€æŒä¹…æ€§ã€éš”ç¦»æ€§å®ç°åŸç†" aria-hidden="true">#</a> äº‹åŠ¡å››å¤§ç‰¹æ€§ä¸­åŸå­æ€§ã€æŒä¹…æ€§ã€éš”ç¦»æ€§å®ç°åŸç†</h2><blockquote><p>åŸå­æ€§ï¼šå½“äº‹åŠ¡æ‰§è¡Œæ—¶ï¼Œå…ˆè®°å½•undolog(undologè®°å½•çš„æ˜¯æ“ä½œå‰çš„å€¼)ï¼Œéšåè®°å½•redolog(redologè®°å½•çš„æ˜¯æ“ä½œåçš„å€¼)ã€‚å½“æœªæäº¤äº‹åŠ¡æ—¶å‘ç”Ÿå®•æœºï¼Œå…ˆæ‰§è¡Œredologï¼ŒæŠŠå€¼æ›´æ–°æˆæ“ä½œåçš„å€¼ï¼Œå†æ‰§è¡Œundologï¼ŒæŠŠå€¼æ›´æ–°å›æ“ä½œå‰çš„å€¼ï¼Œä»è€Œä¿è¯äº‹åŠ¡çš„æ‰§è¡ŒçŠ¶æ€ä¸€è‡´</p><p>éš”ç¦»æ€§ï¼šä¸¤ç§æ–¹æ¡ˆï¼š1ã€åŠ é”ï¼›2ã€MVCCã€‚ä¿è¯åœ¨ä¸åŒçš„äº‹åŠ¡ä¸­ä¿è¯å‰åä¸¤æ¬¡æ‰§è¡Œç›¸åŒçš„æŸ¥è¯¢æ“ä½œè¯»å–åˆ°ç›¸åŒçš„æ•°æ®</p><p>æŒä¹…æ€§ï¼šå› ä¸ºæ“ä½œæ—¶ï¼Œæ•°æ®ä¼šå†™å…¥redologï¼Œæ‰€ä»¥å³ä½¿å‘ç”Ÿå®•æœºäº†ï¼Œä¹Ÿèƒ½ä»redologä¸­å»æ¢å¤ä¿®æ”¹çš„æ•°æ®ï¼Œä¿è¯äº†æ•°æ®çš„æŒä¹…æ€§</p></blockquote><h2 id="äº‹åŠ¡å¹¶å‘ä¸‰å¤§é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡å¹¶å‘ä¸‰å¤§é—®é¢˜" aria-hidden="true">#</a> äº‹åŠ¡å¹¶å‘ä¸‰å¤§é—®é¢˜</h2><p>æ¦‚å¿µï¼šå¤šä¸ªäº‹åŠ¡ä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ä½†æ˜¯å¤šä¸ªäº‹åŠ¡æ“ä½œåŒä¸€æ‰¹æ•°æ®ï¼Œåˆ™ä¼šå¼•å‘ä¸€äº›é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡è®¾ç½®ä¸åŒçš„éš”ç¦»çº§åˆ«æ¥è§„é¿è¿™äº›é—®é¢˜</p><p>å­˜åœ¨çš„é—®é¢˜ï¼š</p><ol><li>è„è¯»ï¼šä¸€ä¸ªäº‹åŠ¡<strong>è¯»å–</strong>å¦ä¸€ä¸ªäº‹åŠ¡ä¸­<strong>æ²¡æœ‰æäº¤çš„æ•°æ®</strong></li><li>ä¸å¯é‡å¤è¯»(è™šè¯»)ï¼šåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œä¸¤æ¬¡è¯»å–çš„<strong>æ•°æ®å†…å®¹ä¸ä¸€è‡´</strong>ã€‚è¿™æ˜¯äº‹åŠ¡ **update **æˆ– <strong>delete</strong> å¼•å‘çš„ã€‚</li><li>å¹»è¯»ï¼šæŸä¸ªäº‹åŠ¡åœ¨è¯»å–æŸä¸ªèŒƒå›´å†…çš„è®°å½•æ—¶ï¼Œå¦ä¸€ä¸ªäº‹åŠ¡åˆä»åœ¨èŒƒå›´æ’å…¥äº†æ–°çºªå½•ï¼Œå½“å‰çš„äº‹åŠ¡åœ¨è¯»å–è¯¥èŒƒå›´çš„è®°å½•æ—¶ï¼Œå°±ä¼šäº§ç”Ÿå¹»è¯»ã€‚åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œä¸¤æ¬¡è¯»å–çš„<strong>æ•°æ®çš„æ•°é‡ä¸ä¸€è‡´</strong>ã€‚è¿™æ˜¯ <strong>insert</strong> æ—¶å¼•å‘çš„é—®é¢˜</li></ol><h2 id="éš”ç¦»çº§åˆ«" tabindex="-1"><a class="header-anchor" href="#éš”ç¦»çº§åˆ«" aria-hidden="true">#</a> éš”ç¦»çº§åˆ«</h2><ol><li><p>read uncommittedï¼šè¯»æœªæäº¤ã€‚äº§ç”Ÿé—®é¢˜ï¼šè„è¯»ã€è™šè¯»ã€å¹»è¯»ã€‚</p><p><strong>åœ¨åŒä¸€äº‹åŠ¡å†…ï¼Œè¯»å–åˆ°å¦ä¸€äº‹åŠ¡æœªæäº¤çš„æ•°æ®</strong></p></li><li><p>read committedï¼šè¯»å·²æäº¤ã€‚äº§ç”Ÿé—®é¢˜ï¼šè™šè¯»ã€å¹»è¯»ã€‚</p><p><strong>åœ¨åŒä¸€äº‹åŠ¡å†…ï¼Œè¯»å–åˆ°å¦ä¸€äº‹åŠ¡å·²æäº¤çš„æ•°æ®ã€‚</strong></p></li><li><p>repeatable readï¼šå¯é‡å¤è¯»ã€‚äº§ç”Ÿé—®é¢˜ï¼šå¹»è¯»(MySQLé»˜è®¤çº§åˆ«)ã€‚</p><p><strong>åœ¨åŒä¸€äº‹åŠ¡å†…ï¼Œå¤šæ¬¡è¯»å–çš„æ•°æ®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé™¤éæäº¤äº‹åŠ¡ï¼Œå¦åˆ™æ— æ³•è¯»å–å…¶ä»–äº‹åŠ¡æäº¤çš„æ•°æ®</strong></p></li><li><p>serializableï¼šä¸²è¡ŒåŒ–ã€‚å¯ä»¥è§£å†³æ‰€æœ‰é—®é¢˜ï¼Œåœ¨è¯»å–çš„æ¯ä¸€è¡Œæ•°æ®ä¸Šéƒ½åŠ é”</p><p><strong>é”è¡¨æ“ä½œã€‚åœ¨ä¸€ä¸ªäº‹åŠ¡æ“ä½œè¿™ä¸ªè¡¨çš„è¿‡ç¨‹ä¸­ï¼Œå¦å¤–çš„äº‹åŠ¡ä¸å…è®¸æ“ä½œè¿™ä¸ªè¡¨ï¼Œåªæœ‰é”æ‰“å¼€äº†ï¼Œæ‰å¯ä»¥æ“ä½œ</strong></p></li></ol><table><thead><tr><th>äº‹åŠ¡éš”ç¦»çº§åˆ«</th><th>è„è¯»</th><th>ä¸å¯é‡å¤è¯»(è™šè¯»)</th><th>å¹»è¯»</th></tr></thead><tbody><tr><td>Read Uncommitted</td><td>å¯èƒ½</td><td>å¯èƒ½</td><td>å¯èƒ½</td></tr><tr><td>Read Committed</td><td>ä¸å¯èƒ½</td><td>å¯èƒ½</td><td>å¯èƒ½</td></tr><tr><td>Repeatable Read</td><td>ä¸å¯èƒ½</td><td>ä¸å¯èƒ½</td><td>å¯¹InnoDBä¸å¯èƒ½</td></tr><tr><td>Serializable</td><td>ä¸å¯èƒ½</td><td>ä¸å¯èƒ½</td><td>ä¸å¯èƒ½</td></tr></tbody></table><p>æ³¨æ„ï¼šéš”ç¦»çº§åˆ«ä»å°åˆ°å¤§ï¼Œ<strong>å®‰å…¨æ€§è¶Šæ¥è¶Šé«˜</strong>ï¼Œä½†<strong>æ•ˆç‡è¶Šæ¥è¶Šä½</strong></p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- æŸ¥è¯¢éš”ç¦»çº§åˆ«
SELECT @@transaction_isolation;

-- è®¾ç½®éš”ç¦»çº§åˆ«(é‡å¯ç”Ÿæ•ˆ)
set global transaction isolation level çº§åˆ«;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="æ­»é”" tabindex="-1"><a class="header-anchor" href="#æ­»é”" aria-hidden="true">#</a> æ­»é”</h3><p>ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„äº‹åŠ¡åœ¨åŒä¸€ä¸ªèµ„æºä¸Šç›¸äº’å ç”¨ï¼Œå¹¶è¯·æ±‚é”å®šå¯¹æ–¹å ç”¨çš„èµ„æºï¼Œä»è€Œå¯¼è‡´æ¶æ€§å¾ªç¯çš„ç°è±¡</p><p><strong>è§£å†³æ–¹æ³•</strong>ï¼š</p><p>InnoDBï¼šå°†æŒæœ‰<strong>æœ€å°‘è¡Œçº§æ’ä»–é”</strong>çš„äº‹åŠ¡è¿›è¡Œå›æ»š</p><h3 id="innodbè§£å†³å¹»è¯»çš„æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#innodbè§£å†³å¹»è¯»çš„æ–¹å¼" aria-hidden="true">#</a> InnoDBè§£å†³å¹»è¯»çš„æ–¹å¼</h3><p>MVCC</p><p>åŸºäºç‰ˆæœ¬Id</p><p>ä¸´é”®é”</p><p>å½“å‰è¯»éœ€è¦åŠ é”ï¼ŒMVCCä¸­çš„å¿«ç…§è¯»(æ•°æ®çš„å‰¯æœ¬)ä¸éœ€è¦åŠ é”</p><h1 id="é”" tabindex="-1"><a class="header-anchor" href="#é”" aria-hidden="true">#</a> é”</h1><p>ä½œç”¨ï¼šäº‹åŠ¡è·å–é”è¿™ç§æ§åˆ¶èµ„æºï¼Œç”¨äºä¿æŠ¤æ•°æ®èµ„æºï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œå†²çªçš„æˆ–ä¸å…¼å®¹çš„è®¿é—®ï¼Œè§£å†³äº‹åŠ¡å¯¹äºæ•°æ®å¹¶å‘è®¿é—®çš„é—®é¢˜</p><h2 id="é”ç²’åº¦" tabindex="-1"><a class="header-anchor" href="#é”ç²’åº¦" aria-hidden="true">#</a> é”ç²’åº¦</h2><ul><li>é”å®šç²’åº¦ï¼šè¡¨é” &gt; è¡Œé”</li><li>åŠ é”æ•ˆç‡ï¼šè¡¨é” &gt; è¡Œé”ï¼Œå› ä¸ºè¡Œé”éœ€è¦å…ˆä»è¡¨ä¸­æ£€ç´¢åˆ°ä¹‹åæ‰å¯ä»¥åŠ é”</li><li>å†²çªæ¦‚ç‡ï¼šè¡¨é” &gt; è¡Œé”</li><li>å¹¶å‘æ€§èƒ½ï¼šè¡¨é” &lt; è¡Œé”</li></ul><p>InnoDBæ”¯æŒè¡Œé”å’Œè¡¨é”ï¼›MyISAMæ”¯æŒè¡¨é”</p><h3 id="è¡¨é”" tabindex="-1"><a class="header-anchor" href="#è¡¨é”" aria-hidden="true">#</a> è¡¨é”</h3><p>å¼€é”€æœ€å°çš„ç­–ç•¥ã€‚é”å®šæ•´å¼ è¡¨ï¼Œå½“ä¸€ä¸ªç”¨æˆ·åœ¨å¯¹è¡¨è¿›è¡Œæ–°å¢ã€åˆ é™¤ã€ä¿®æ”¹æ“ä½œæ—¶ï¼Œéœ€è¦å…ˆè·å–å†™é”ï¼Œè¿™ä¼šé˜»å¡å…¶ä»–ç”¨æˆ·å¯¹è¿™å¼ è¡¨çš„è¯»å–å’Œä¿®æ”¹æ“ä½œã€‚</p><p>å†™é”ä¼šæ¯”è¯»é”æœ‰æ›´é«˜ä¼˜å…ˆçº§ï¼Œå†™é”å¯ä»¥åœ¨é”é˜Ÿåˆ—ä¸­æ’å…¥åˆ°è¯»é”çš„å‰é¢ï¼Œè¯»é”ä¸å¯ä»¥ã€‚</p><h3 id="è¡Œçº§é”" tabindex="-1"><a class="header-anchor" href="#è¡Œçº§é”" aria-hidden="true">#</a> è¡Œçº§é”</h3><p>é”æœºåˆ¶éƒ½æ˜¯åœ¨<strong>å­˜å‚¨å¼•æ“å±‚å®ç°</strong>çš„ï¼Œé™¤äº†æœåŠ¡å™¨æŸäº›æƒ…å†µä¼šåŠ è¡¨é”(å¦‚ä¿®æ”¹è¡¨ALTER TABLEçš„æ—¶å€™)</p><h2 id="é”ç±»å‹" tabindex="-1"><a class="header-anchor" href="#é”ç±»å‹" aria-hidden="true">#</a> é”ç±»å‹</h2><p>äº‹åŠ¡ç»“æŸæ—¶è‡ªåŠ¨é‡Šæ”¾é”</p><h3 id="å…±äº«é”-è¯»-è¡Œ" tabindex="-1"><a class="header-anchor" href="#å…±äº«é”-è¯»-è¡Œ" aria-hidden="true">#</a> å…±äº«é”(è¯»)(è¡Œ)</h3><ul><li><p>å½“è¯•å›¾<strong>è¯»å–</strong>æ•°æ®æ—¶ï¼Œäº‹åŠ¡ä¼šä¸ºæ‰€ä¾èµ–çš„æ•°æ®èµ„æºè¯·æ±‚å…±äº«é”</p></li><li><p>æŒæœ‰å…±äº«é”æ—¶é—´ï¼šä»äº‹åŠ¡å¾—åˆ°å…±äº«é”åˆ°è¯»æ“ä½œå®Œæˆ</p></li><li><p>å¤šä¸ªäº‹åŠ¡å¯ä»¥åœ¨<strong>åŒä¸€é˜¶æ®µç”¨å…±äº«é”ä½œç”¨äºåŒä¸€æ•°æ®èµ„æº</strong></p></li><li><p>åŠ é”æ–¹å¼</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>select * from student where id = 1 LOCK IN SHARE MODE;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><h3 id="æ’ä»–é”-å†™-è¡Œ" tabindex="-1"><a class="header-anchor" href="#æ’ä»–é”-å†™-è¡Œ" aria-hidden="true">#</a> æ’ä»–é”(å†™)(è¡Œ)</h3><ul><li><p>å½“è¯•å›¾<strong>ä¿®æ”¹</strong>æ•°æ®æ—¶ï¼Œäº‹åŠ¡åªèƒ½ä¸ºæ‰€ä¾èµ–çš„æ•°æ®èµ„æºè¯·æ±‚æ’ä»–é”</p></li><li><p>æŒæœ‰æ’ä»–é”æ—¶é—´ï¼šä¸€æ—¦æŸä¸ªäº‹åŠ¡å¾—åˆ°äº†æ’ä»–é”ï¼Œåˆ™è¿™ä¸ªäº‹åŠ¡å°†ä¸€ç›´æŒæœ‰æ’ä»–é”ç›´åˆ°äº‹åŠ¡å®Œæˆ</p></li><li><p>ä¸€ä¸ªäº‹åŠ¡è·å¾—äº†ä¸€è¡Œæ•°æ®çš„æ’ä»–é”ï¼Œå…¶ä»–äº‹åŠ¡å°±ä¸èƒ½å†è·å–è¯¥è¡Œçš„é”(å…±äº«ã€æ’ä»–)ï¼Œåªæœ‰è·å–äº†æ’ä»–é”çš„äº‹åŠ¡æ‰å¯ä»¥å¯¹æ•°æ®è¿›è¡Œè¯»å–å’Œä¿®æ”¹</p></li><li><p>åŠ é”æ–¹å¼</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- è‡ªåŠ¨
delete / update / insert é»˜è®¤åŠ ä¸Šæ’ä»–é”
-- æ‰‹åŠ¨
select * from student where id = 1 FOR UPDATE;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h3 id="æ„å‘å…±äº«é”-è¡¨" tabindex="-1"><a class="header-anchor" href="#æ„å‘å…±äº«é”-è¡¨" aria-hidden="true">#</a> æ„å‘å…±äº«é”(è¡¨)</h3><p>æ„å‘é”æ˜¯å­˜å‚¨å¼•æ“ç»´æŠ¤çš„ï¼Œç”¨æˆ·æ— æ³•æ‰‹åŠ¨æ“ä½œæ„å‘é”</p><p>è¡¨ç¤ºäº‹åŠ¡å‡†å¤‡ç»™æ•°æ®è¡ŒåŠ å…¥å…±äº«é”ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€è¡Œæ•°æ®åŠ å…±äº«é”å‰å¿…é¡»å…ˆå–å¾—è¯¥è¡¨çš„æ„å‘å…±äº«é”</p><h3 id="æ„å‘æ’ä»–é”-è¡¨" tabindex="-1"><a class="header-anchor" href="#æ„å‘æ’ä»–é”-è¡¨" aria-hidden="true">#</a> æ„å‘æ’ä»–é”(è¡¨)</h3><p>è¡¨ç¤ºäº‹åŠ¡å‡†å¤‡ç»™æ•°æ®è¡ŒåŠ å…¥æ’ä»–é”ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€è¡Œæ•°æ®åŠ æ’ä»–é”å‰å¿…é¡»å…ˆå–å¾—è¯¥è¡¨çš„æ„å‘æ’ä»–é”</p><h3 id="æ„å‘é”çš„æ„ä¹‰" tabindex="-1"><a class="header-anchor" href="#æ„å‘é”çš„æ„ä¹‰" aria-hidden="true">#</a> æ„å‘é”çš„æ„ä¹‰</h3><p>å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ ‡å¿—ï¼Œä¸€ä¸ªäº‹åŠ¡è¦æˆåŠŸåœ°é”å®šä¸€å¼ è¡¨çš„å‰æï¼šå¿…é¡»ç¡®è®¤æ²¡æœ‰å…¶ä»–äº‹åŠ¡å·²ç»é”å®šäº†è¿™å¼ è¡¨çš„ä»»æ„ä¸€è¡Œæ•°æ®ã€‚æ„å‘é”çš„å­˜åœ¨å¯ä»¥ä½¿å¾—åŠ é”å‰ä¸éœ€è¦è¿›è¡Œå…¨è¡¨æ‰«æï¼Œæ‰€ä»¥åŠ é”çš„æ•ˆç‡å°±æ›´ç¨³å®šäº†</p><h3 id="é”çš„å†…å®¹" tabindex="-1"><a class="header-anchor" href="#é”çš„å†…å®¹" aria-hidden="true">#</a> é”çš„å†…å®¹</h3><p>ä¸åŠ ç´¢å¼•ï¼Œé”è¡¨</p><p>å»ºç«‹ä¸»é”®ç´¢å¼•ï¼Œé”è¡Œ</p><p>å»ºç«‹ä¸»é”®ç´¢å¼•ï¼Œå»ºç«‹å”¯ä¸€ç´¢å¼•ï¼Œé”è¡Œ</p><ul><li><p><strong>é”çš„å†…å®¹æ˜¯ç´¢å¼•</strong></p></li><li><p>æ²¡æœ‰ç´¢å¼•æ—¶ï¼ŒåŠ è¡Œé”ä¼šé”è¡¨</p></li></ul><blockquote><p>å› ä¸ºæ²¡æœ‰ç›´æ¥ä½¿ç”¨ç´¢å¼•æ¥åŠ é”ï¼ŒInnoDBåšäº†ä¸€ä¸ªå…¨è¡¨æ‰«æï¼ŒæŠŠè¿™å¼ è¡¨æ‰€æœ‰çš„éšå«çš„é»˜è®¤çš„èšé›†ç´¢å¼•å…¨éƒ¨é”ä½äº†ï¼Œæ‰€ä»¥é€ æˆäº†é”è¡¨çš„å‡è±¡ã€‚</p></blockquote><ul><li>é€šè¿‡å”¯ä¸€ç´¢å¼•åŠ é”æ—¶ä¼šæŠŠä¸»é”®ç´¢å¼•ä¹Ÿé”ä½</li></ul><blockquote><p>å› ä¸ºå”¯ä¸€ç´¢å¼•å­˜äº†äºŒçº§ç´¢å¼•æœ¬èº«è¿˜å­˜äº†ä¸»é”®å€¼ï¼Œé”å®šäº†è¾…åŠ©ç´¢å¼•åï¼Œä¼šæŠŠä¸»é”®ç´¢å¼•ä¹Ÿé”ä½</p></blockquote><h2 id="è¡Œé”ç®—æ³•" tabindex="-1"><a class="header-anchor" href="#è¡Œé”ç®—æ³•" aria-hidden="true">#</a> è¡Œé”ç®—æ³•</h2><p><strong>ç´¢å¼•åŒºé—´åˆ’åˆ†</strong></p><ul><li><p>è®°å½•ï¼šå…·ä½“çš„ç´¢å¼•å€¼</p></li><li><p>é—´éš™ï¼šæ¯ä¸ªè®°å½•ä¹‹é—´çš„ç©ºå†…å®¹çš„åŒºé—´</p></li><li><p>ä¸´é”®ï¼šé—´éš™+ä¸‹ä¸€ä¸ªè®°å½•ï¼Œ<strong>å·¦å¼€å³é—­</strong></p></li><li><p>Nä¸ªè®°å½•ï¼ŒN+1é—´éš™</p></li></ul><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/image-20200928225821932.png" alt="image-20200928225821932"></p><h3 id="è®°å½•é”" tabindex="-1"><a class="header-anchor" href="#è®°å½•é”" aria-hidden="true">#</a> è®°å½•é”</h3><p>ä½¿ç”¨æ¡ä»¶ï¼šå”¯ä¸€æ€§ç´¢å¼•(å”¯ä¸€ç´¢å¼•æˆ–èšé›†ç´¢å¼•)ç­‰å€¼æŸ¥è¯¢(ä½¿ç”¨<code>=</code>ï¼Œä¸æ˜¯èŒƒå›´æŸ¥è¯¢)ï¼Œç²¾å‡†åŒ¹é…åˆ°æŸä¸€æ¡è®°å½•</p><p>é”å®šå†…å®¹ï¼šç´¢å¼•</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/image-20200928231714612.png" alt="image-20200928231714612"></p><h3 id="é—´éš™é”" tabindex="-1"><a class="header-anchor" href="#é—´éš™é”" aria-hidden="true">#</a> é—´éš™é”</h3><p><strong>åªæœ‰åœ¨å¯é‡å¤è¯»çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ä¸‹å­˜åœ¨</strong></p><p>ä½¿ç”¨æ¡ä»¶ï¼šæŸ¥è¯¢æ—¶æ²¡æœ‰å‘½ä¸­ä»»ä½•ä¸€æ¡è®°å½•ï¼Œæ— è®ºä½¿ç”¨èŒƒå›´æŸ¥è¯¢è¿˜æ˜¯ç­‰å€¼æŸ¥è¯¢</p><p>é”å®šå†…å®¹ï¼šå‘½ä¸­çš„é‚£ä¸€ä¸ªé—´éš™ã€‚é”å®šåï¼Œå¯¹è¯¥é—´éš™çš„æ’å…¥å’ŒæŸ¥è¯¢éƒ½ä¸æˆåŠŸ</p><p><strong>å¯ä»¥é˜²æ­¢å¹»è¯»</strong></p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/image-20200928232138971.png" alt="image-20200928232138971"></p><h3 id="ä¸´é”®é”" tabindex="-1"><a class="header-anchor" href="#ä¸´é”®é”" aria-hidden="true">#</a> ä¸´é”®é”</h3><p>ä½¿ç”¨æ¡ä»¶ï¼šèŒƒå›´æŸ¥è¯¢æ—¶ï¼ŒèŒƒå›´åŒæ—¶åŒ…å«äº†è®°å½•å’ŒåŒºé—´ï¼›å¦‚æœæ²¡æœ‰ä»»ä½•è®°å½•ï¼Œé‚£ä¹ˆé€€åŒ–æˆé—´éš™é”ï¼›å¦‚æœç²¾å‡†åŒ¹é…åˆ°ä¸€æ¡è®°å½•ï¼Œé‚£ä¹ˆé€€åŒ–æˆè®°å½•é”</p><p>é”å®šå†…å®¹ï¼šè®°å½•+åŒºé—´</p><p><strong>æ˜¯InnoDBé»˜è®¤çš„è¡Œé”ç®—æ³•</strong></p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/image-20200928234952461.png" alt="image-20200928234952461"></p><h2 id="ä¹è§‚é”å’Œæ‚²è§‚é”çš„åŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#ä¹è§‚é”å’Œæ‚²è§‚é”çš„åŒºåˆ«" aria-hidden="true">#</a> ä¹è§‚é”å’Œæ‚²è§‚é”çš„åŒºåˆ«</h2><blockquote><p>ä¸¤è€…éƒ½ä¸æ˜¯é”çš„å®ç°ï¼Œè€Œåªæ˜¯é”çš„ç­–ç•¥</p><p>æ‚²è§‚é”ä¼šåœ¨äº‹åŠ¡å¼€å§‹æ—¶å¯¹æ•°æ®è¿›è¡Œä¸Šé”æ“ä½œï¼Œä»è€Œä¿è¯å…¶ä»–çº¿ç¨‹æ— æ³•å¯¹è¯¥è¡Œæ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œç­‰åˆ°äº‹åŠ¡ç»“æŸæ—¶æ‰ä¼šé‡Šæ”¾é”</p><p>ä¹è§‚é”æœ€å¤§çš„ç‰¹ç‚¹å°±æ˜¯ä¸åŠ é”ï¼Œåªä¼šåœ¨æäº¤äº‹åŠ¡æ—¶æ£€æŸ¥å¯¹åº”çš„æ•°æ®(çŠ¶æ€ã€ç‰ˆæœ¬å·ã€æ—¶é—´æˆ³ç­‰)æ¥ä¿è¯è¦æ“ä½œçš„æ•°æ®æ˜¯å¦è¢«ä¿®æ”¹è¿‡ï¼Œå¦‚æœä¿®æ”¹è¿‡åˆ™æœ¬æ¬¡ä¿®æ”¹å¤±æ•ˆå¹¶å›æ»š</p></blockquote><h2 id="é”å…¼å®¹æƒ…å†µ" tabindex="-1"><a class="header-anchor" href="#é”å…¼å®¹æƒ…å†µ" aria-hidden="true">#</a> é”å…¼å®¹æƒ…å†µ</h2><h3 id="å…±äº«é”ã€æ’ä»–é”ã€æ„å‘é”" tabindex="-1"><a class="header-anchor" href="#å…±äº«é”ã€æ’ä»–é”ã€æ„å‘é”" aria-hidden="true">#</a> å…±äº«é”ã€æ’ä»–é”ã€æ„å‘é”</h3><table><thead><tr><th style="text-align:center;">å·²æŒæœ‰\è¯·æ±‚çš„</th><th style="text-align:center;">å…±äº«é”</th><th style="text-align:center;">æ’ä»–é”</th><th style="text-align:center;">æ„å‘å…±äº«é”</th><th style="text-align:center;">æ„å‘æ’ä»–é”</th></tr></thead><tbody><tr><td style="text-align:center;">å…±äº«é”</td><td style="text-align:center;">å…¼å®¹</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å…¼å®¹</td><td style="text-align:center;">å†²çª</td></tr><tr><td style="text-align:center;">æ’ä»–é”</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å†²çª</td></tr><tr><td style="text-align:center;">æ„å‘å…±äº«é”</td><td style="text-align:center;">å…¼å®¹</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å…¼å®¹</td><td style="text-align:center;">å…¼å®¹</td></tr><tr><td style="text-align:center;">æ„å‘æ’ä»–é”</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å†²çª</td><td style="text-align:center;">å…¼å®¹</td><td style="text-align:center;">å…¼å®¹</td></tr></tbody></table><ol><li>æ’ä»–é”è·Ÿå…¶ä»–é”éƒ½æ˜¯å†²çªçš„</li><li>æ„å‘é”äº’ç›¸å…¼å®¹</li></ol><h3 id="é—´éš™é”ã€è®°å½•é”ã€ä¸´é”®é”" tabindex="-1"><a class="header-anchor" href="#é—´éš™é”ã€è®°å½•é”ã€ä¸´é”®é”" aria-hidden="true">#</a> é—´éš™é”ã€è®°å½•é”ã€ä¸´é”®é”</h3><h2 id="æŸ¥çœ‹åŠ é”æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#æŸ¥çœ‹åŠ é”æ–¹å¼" aria-hidden="true">#</a> æŸ¥çœ‹åŠ é”æ–¹å¼</h2><p><code>select * from schema.INNODB_TRX</code></p><h3 id="å‚æ•°å«ä¹‰" tabindex="-1"><a class="header-anchor" href="#å‚æ•°å«ä¹‰" aria-hidden="true">#</a> å‚æ•°å«ä¹‰</h3><table><thead><tr><th style="text-align:center;">å‚æ•°</th><th style="text-align:center;">å‚æ•°æ„ä¹‰</th></tr></thead><tbody><tr><td style="text-align:center;">trx_state</td><td style="text-align:center;">äº‹åŠ¡æ‰§è¡ŒçŠ¶æ€ï¼šRUNNINGã€LOCK WAITã€ROLLING BACKã€COMMITING</td></tr><tr><td style="text-align:center;">trx_started</td><td style="text-align:center;">äº‹åŠ¡å¼€å§‹çš„æ—¶é—´</td></tr><tr><td style="text-align:center;">trx_requested_lock_id</td><td style="text-align:center;">ç­‰å¾…äº‹åŠ¡çš„é”Id</td></tr><tr><td style="text-align:center;">trx_mysql_thread_id</td><td style="text-align:center;">æŸ¥è¯¢æ—¶ï¼Œå¯èƒ½ä½¿ç”¨çš„ç´¢å¼•</td></tr></tbody></table><p>å½“å‰äº‹åŠ¡å¦‚æœç­‰å¾…æ—¶é—´è¿‡é•¿æˆ–å‡ºç°æ­»é”çš„æƒ…å†µï¼Œå¯ä»¥é€šè¿‡ ã€Œ<strong>kill çº¿ç¨‹ID(trx_requested_lock_id)</strong>ã€ çš„æ–¹å¼é‡Šæ”¾å½“å‰çš„é”ã€‚</p><h1 id="æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#æ—¥å¿—" aria-hidden="true">#</a> æ—¥å¿—</h1><p>MySQLæ—¥å¿—ä¸»è¦åŒ…æ‹¬é”™è¯¯æ—¥å¿—ã€ä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—ã€æ…¢æŸ¥è¯¢æ—¥å¿—ã€<strong>äº‹åŠ¡æ—¥å¿—</strong>ã€<strong>äºŒè¿›åˆ¶</strong>æ—¥å¿—å‡ å¤§ç±»</p><p>æ—¥å¿—åˆ·æ–°æ“ä½œ</p><p>mysql</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>FLUSH LOGS;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>shell</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>mysqladmin flush-logs
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="é”™è¯¯æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#é”™è¯¯æ—¥å¿—" aria-hidden="true">#</a> é”™è¯¯æ—¥å¿—</h2><p>è®°å½•MySQLæœåŠ¡å¯åŠ¨å’Œåœæ­¢æ­£ç¡®å’Œé”™è¯¯çš„ä¿¡æ¯ï¼Œè¿˜è®°å½•äº†<code>mysqld</code>å®ä¾‹è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿçš„é”™è¯¯äº‹ä»¶ä¿¡æ¯</p><p>æŸ¥çœ‹é”™è¯¯æ—¥å¿—çš„ä½ç½®</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>show variables like &#39;log_error&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="ä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#ä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—" aria-hidden="true">#</a> ä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—</h2><p>æŸ¥è¯¢æ—¥å¿—å¯ä»¥åˆ†ä¸ºä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—å’Œæ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œé€šè¿‡æŸ¥è¯¢æ—¶é—´<code>long_query_time</code>çš„å€¼æ¥åˆ¤å®š</p><p>å»ºè®®å…³é—­è¿™ç§æ—¥å¿—ï¼Œ<strong>é»˜è®¤æ˜¯å…³é—­çš„</strong>ï¼Œå› ä¸ºä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—è®°å½•çš„æ„ä¹‰ä¸å¤§ï¼Œä¸”æ•°æ®é‡å·¨å¤§ï¼Œä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—è®°å½•çš„ä¸ä»…ä»…æ˜¯<code>select</code>è¯­å¥ï¼Œå‡ ä¹æ‰€æœ‰çš„è¯­å¥éƒ½ä¼šè®°å½•</p><p>ä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—ç›¸å…³å˜é‡</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>general_log=off # æ˜¯å¦å¯ç”¨ä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—ï¼Œä¸ºå…¨å±€å˜é‡ï¼Œå¿…é¡»åœ¨globalä¸Šä¿®æ”¹ã€‚
general_log_file=/mydata/data/hostname.log  # é»˜è®¤æ˜¯åº“æ–‡ä»¶è·¯å¾„ä¸‹ä¸»æœºååŠ ä¸Š.log
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æ…¢æŸ¥è¯¢æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#æ…¢æŸ¥è¯¢æ—¥å¿—" aria-hidden="true">#</a> æ…¢æŸ¥è¯¢æ—¥å¿—</h2><p>æŸ¥è¯¢æ—¶é—´è¶…å‡ºå˜é‡<code>long_query_time</code>æ‰€è®¾å®šå€¼çš„æŸ¥è¯¢è¢«è®¤ä¸ºæ˜¯æ…¢æŸ¥è¯¢ï¼Œä½†æ˜¯æŸ¥è¯¢è·å–é”(åŒ…æ‹¬é”ç­‰å¾…)çš„æ—¶é—´ä¸è®¡å…¥æŸ¥è¯¢æ—¶é—´å†…</p><p>æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—çš„å¼€å¯æƒ…å†µ</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>show variables like &#39;slow_query%&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- ä¼šè¯
set slow_query_log=&#39;ON&#39;;
-- å…¨å±€
set global slow_query_log=&#39;ON&#39;;
-- æ°¸ä¹…
-- ä¿®æ”¹my.cnfæ–‡ä»¶
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ…¢æŸ¥è¯¢æ—¥å¿—ç›¸å…³å˜é‡:</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>long_query_time=10 # æŒ‡å®šæ…¢æŸ¥è¯¢è¶…æ—¶æ—¶é•¿(é»˜è®¤10ç§’)ï¼Œè¶…å‡ºæ­¤æ—¶é•¿çš„å±äºæ…¢æŸ¥è¯¢
slow_query_log={on|off}  # æ˜¯å¦å¯ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œé»˜è®¤ä¸ºoff
slow_query_log_file=/mydata/data/hostname-slow.log  # æ…¢æŸ¥è¯¢æ—¥å¿—ä½ç½®ï¼Œé»˜è®¤æ–‡ä»¶ååé¢ä¼šåŠ ä¸Š-slow.log
log_queries_not_using_indexes={on|off} # æŸ¥è¯¢æ²¡æœ‰ä½¿ç”¨ç´¢å¼•çš„æ—¶å€™æ˜¯å¦ä¹Ÿè®°å…¥æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œé»˜è®¤ä¸ºoff
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æ…¢æŸ¥è¯¢æ—¥å¿—ä¸“ç”¨åˆ†æå·¥å…·ï¼š<code>mysqldumpslow</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token operator">&gt;</span> mysqldumpslow <span class="token punctuation">[</span>option<span class="token punctuation">]</span> slow_query_log_file
  -d           <span class="token variable"><span class="token variable">`</span>debug<span class="token variable">`</span></span>ï¼šå½’ç±»åçš„ç»“æœåªæ˜¯ç²¾ç¡®åˆ°0.01ç§’çš„ï¼Œdebugé€‰é¡¹å¯ä»¥æ˜¾ç¤ºå…¶ç²¾ç¡®çš„ç§’æ•°
  -v           <span class="token variable"><span class="token variable">`</span>verbose<span class="token variable">`</span></span>ï¼šæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
  -t NUM       <span class="token variable"><span class="token variable">`</span>just show the <span class="token function">top</span> n queries<span class="token variable">`</span></span>ï¼šä»…æ˜¾ç¤ºå‰næ¡æŸ¥è¯¢
  -a           <span class="token variable"><span class="token variable">`</span>don<span class="token string">&#39;t abstract all numbers to N and strings to &#39;</span>S&#39;<span class="token variable">`</span></span>ï¼šå½’ç±»æ—¶ä¸è¦ä½¿ç”¨Næ›¿æ¢æ•°å­—ï¼ŒSæ›¿æ¢å­—ç¬¦ä¸²å˜é‡
  -g PATTERN   <span class="token variable"><span class="token variable">`</span>grep: only consider stmts that include this string<span class="token variable">`</span></span>ï¼šé€šè¿‡grepæ¥ç­›é€‰selectè¯­å¥ã€‚
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="äºŒè¿›åˆ¶æ—¥å¿—-binlog" tabindex="-1"><a class="header-anchor" href="#äºŒè¿›åˆ¶æ—¥å¿—-binlog" aria-hidden="true">#</a> äºŒè¿›åˆ¶æ—¥å¿—(binlog)</h2><ul><li><code>binlog</code>ï¼ˆå½’æ¡£æ—¥å¿—ï¼‰åŒ…å«äº†<strong>å¼•èµ·æˆ–å¯èƒ½å¼•èµ·æ•°æ®åº“æ”¹å˜</strong>(å¦‚<code>update</code>ã€<code>delete</code>è¯­å¥ä½†æ²¡æœ‰åŒ¹é…è¡Œ)çš„äº‹ä»¶ä¿¡æ¯ï¼Œä½†ç»ä¸ä¼šåŒ…æ‹¬<code>select</code>å’Œ<code>show</code>è¿™æ ·çš„æŸ¥è¯¢è¯­å¥ã€‚è¯­å¥ä»¥**&quot;äº‹ä»¶&quot;çš„å½¢å¼ä¿å­˜**ï¼Œæ‰€ä»¥åŒ…å«äº†<strong>æ—¶é—´ã€äº‹ä»¶å¼€å§‹å’Œç»“æŸä½ç½®ç­‰ä¿¡æ¯</strong>ã€‚</li><li>å¯¹äºäº‹åŠ¡è¡¨çš„æ“ä½œï¼ŒäºŒè¿›åˆ¶æ—¥å¿—<strong>åªåœ¨äº‹åŠ¡æäº¤çš„æ—¶å€™ä¸€æ¬¡æ€§å†™å…¥</strong>ï¼Œæäº¤å‰çš„æ¯ä¸ªäºŒè¿›åˆ¶æ—¥å¿—è®°å½•éƒ½å…ˆcacheï¼Œæäº¤æ—¶å†™å…¥ã€‚</li><li>å¯¹äºäº‹åŠ¡è¡¨æ¥è¯´ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸­å¯èƒ½åŒ…å«å¤šæ¡äºŒè¿›åˆ¶æ—¥å¿—äº‹ä»¶ï¼Œå®ƒä»¬ä¼šåœ¨æäº¤æ—¶ä¸€æ¬¡æ€§å†™å…¥ï¼›è€Œå¯¹äºéäº‹åŠ¡è¡¨çš„æ“ä½œï¼Œæ¯æ¬¡æ‰§è¡Œå®Œè¯­å¥å°±ç›´æ¥å†™å…¥ã€‚</li><li>MySQLæ•°æ®åº“çš„<strong>æ•°æ®å¤‡ä»½</strong>ã€<strong>ä¸»å¤‡</strong>ã€<strong>ä¸»ä¸»</strong>ã€<strong>ä¸»ä»</strong>éƒ½éœ€è¦<code>binlog</code>æ¥åŒæ­¥æ•°æ®ï¼Œä¿è¯æ•°æ®ä¸€è‡´æ€§</li></ul><h3 id="æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—" aria-hidden="true">#</a> æŸ¥çœ‹äºŒè¿›åˆ¶æ—¥å¿—</h3><h4 id="åœ¨å‘½ä»¤è¡Œä½¿ç”¨mysqlbinlogå·¥å…·" tabindex="-1"><a class="header-anchor" href="#åœ¨å‘½ä»¤è¡Œä½¿ç”¨mysqlbinlogå·¥å…·" aria-hidden="true">#</a> åœ¨å‘½ä»¤è¡Œä½¿ç”¨mysqlbinlogå·¥å…·</h4><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token operator">&gt;</span> mysqlbinlog <span class="token punctuation">[</span>option<span class="token punctuation">]</span> log-file<span class="token punctuation">..</span>.
  -d name, --database<span class="token operator">=</span>name	åªæŸ¥çœ‹æŒ‡å®šæ•°æ®åº“çš„æ—¥å¿—æ“ä½œ
  -o n, --offset<span class="token operator">=</span>n				å¿½ç•¥æ‰æ—¥å¿—ä¸­çš„å‰nä¸ªæ“ä½œå‘½ä»¤<span class="token punctuation">(</span>äº‹ä»¶<span class="token punctuation">)</span>
  -r name, --result-file<span class="token operator">=</span>name		å°†è¾“å‡ºçš„æ—¥å¿—ä¿¡æ¯è¾“å‡ºåˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­ï¼Œä½¿ç”¨é‡å®šå‘ä¹Ÿä¸€æ ·å¯ä»¥ã€‚
  -s, --short-form					æ˜¾ç¤ºç®€å•æ ¼å¼çš„æ—¥å¿—ï¼Œä¼šçœç•¥æ‰ä¸€äº›é¢å¤–çš„ä¿¡æ¯å¦‚ä½ç½®ä¿¡æ¯å’Œæ—¶é—´ä¿¡æ¯ä»¥åŠåŸºäºè¡Œçš„æ—¥å¿—ã€‚
  --start-datetime<span class="token operator">=</span>m, --stop-datetime<span class="token operator">=</span>n			æŒ‡å®šè¾“å‡ºå¼€å§‹æ—¶é—´å’Œç»“æŸæ—¶é—´å†…çš„æ‰€æœ‰æ—¥å¿—ä¿¡æ¯
  --start-position<span class="token operator">=</span>m, --stop-position<span class="token operator">=</span>n			æŒ‡å®šè¾“å‡ºå¼€å§‹ä½ç½®å’Œç»“æŸä½ç½®å†…çš„æ‰€æœ‰æ—¥å¿—ä¿¡æ¯
  --set-charset<span class="token operator">=</span>char_name	åœ¨è¾“å‡ºæ—¥å¿—ä¿¡æ¯åˆ°æ–‡ä»¶ä¸­æ—¶ï¼Œåœ¨æ–‡ä»¶ç¬¬ä¸€è¡ŒåŠ ä¸Šset names char_name
  -v, -vv		æ˜¾ç¤ºæ›´è¯¦ç»†ä¿¡æ¯ï¼ŒåŸºäºrowçš„æ—¥å¿—é»˜è®¤ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œæ­¤æ—¶ä½¿ç”¨-væˆ–-vvå¯ä»¥æŸ¥çœ‹
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>æˆåŠŸæ‰§è¡ŒDMLå‘½ä»¤åœ¨binlogä¸­ä¼šåŒ…å«ä¸€å¯¹<code>begin</code>å’Œ<code>commit</code></li></ul><h4 id="åœ¨mysqlå®¢æˆ·ç«¯ä¸­ä½¿ç”¨showå‘½ä»¤" tabindex="-1"><a class="header-anchor" href="#åœ¨mysqlå®¢æˆ·ç«¯ä¸­ä½¿ç”¨showå‘½ä»¤" aria-hidden="true">#</a> åœ¨mysqlå®¢æˆ·ç«¯ä¸­ä½¿ç”¨showå‘½ä»¤</h4><ul><li><code>show binary logs</code> ï¼ŒæŸ¥çœ‹å½“å‰ä½¿ç”¨äº†å“ªäº›äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶</li><li><code>show binlog events in file</code>ï¼ŒæŸ¥çœ‹æ—¥å¿—ä¸­è¿›è¡Œäº†å“ªäº›æ“ä½œ</li><li><code>show master status</code>ï¼Œæ˜¾ç¤ºä¸»æœåŠ¡å™¨ä¸­çš„äºŒè¿›åˆ¶æ—¥å¿—ä¿¡æ¯ã€‚å¦‚æœæ˜¯ä¸»ä»ç»“æ„ï¼Œå®ƒåªä¼šæ˜¾ç¤ºä¸»ä»ç»“æ„ä¸­ä¸»æœåŠ¡å™¨çš„äºŒè¿›åˆ¶æ—¥å¿—ä¿¡æ¯ã€‚å¯ä»¥æŸ¥çœ‹åˆ°å½“å‰æ­£åœ¨ä½¿ç”¨çš„æ—¥å¿—åŠä¸‹ä¸€äº‹ä»¶è®°å½•çš„å¼€å§‹ä½ç½®ï¼Œè¿˜èƒ½æŸ¥çœ‹åˆ°å“ªäº›æ•°æ®åº“éœ€è¦è®°å½•äºŒè¿›åˆ¶æ—¥å¿—ï¼Œå“ªäº›æ•°æ®åº“ä¸è®°å½•äºŒè¿›åˆ¶æ—¥å¿—</li></ul><h3 id="åˆ é™¤äºŒè¿›åˆ¶æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#åˆ é™¤äºŒè¿›åˆ¶æ—¥å¿—" aria-hidden="true">#</a> åˆ é™¤äºŒè¿›åˆ¶æ—¥å¿—</h3><ul><li><code>reset master</code>ï¼Œåˆ é™¤æ‰€æœ‰æ—¥å¿—ï¼Œå¹¶è®©æ—¥å¿—æ–‡ä»¶é‡æ–°ä»000001å¼€å§‹</li><li><code>purge binary logs to &#39;filename.000006&#39;</code>ï¼Œæ¸…ç©º000006ä¹‹å‰çš„æ‰€æœ‰æ—¥å¿—æ–‡ä»¶</li><li><code>purge binary logs before &#39;2020-01-01 10:00:00&#39;</code>ï¼Œåˆ é™¤æŒ‡å®šæ—¥æœŸä¹‹å‰çš„æ‰€æœ‰æ—¥å¿—ã€‚ä½†æ˜¯è‹¥æŒ‡å®šçš„æ—¶é—´å¤„åœ¨æ­£åœ¨ä½¿ç”¨ä¸­çš„æ—¥å¿—æ–‡ä»¶ä¸­ï¼Œå°†æ— æ³•è¿›è¡Œpurge</li></ul><h3 id="binlogæ—¥å¿—æ ¼å¼" tabindex="-1"><a class="header-anchor" href="#binlogæ—¥å¿—æ ¼å¼" aria-hidden="true">#</a> binlogæ—¥å¿—æ ¼å¼</h3><ul><li><p><code>statement</code>ï¼Œè®°å½•ä¸ºSQLè¯­å¥å½¢å¼ï¼Œå¦‚ï¼š<code>update T set update_time=now() where id=1</code>ï¼Œè®°å½•çš„å†…å®¹å¦‚ä¸‹ï¼š</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210907111312.png" alt=""></p><p>åŒæ­¥æ•°æ®æ—¶ï¼Œå°±æ‰§è¡Œè®°å½•é‡Œé¢çš„SQLè¯­å¥</p><p>ç¼ºé™·ï¼šç”±äº<code>uuid()</code>ã€<code>now()</code>è¿™äº›æ–¹æ³•æ¯æ¬¡æ‰§è¡Œçš„å€¼éƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œæ‰€ä»¥<strong>æ— æ³•è®°å½•åŠ¨æ€å€¼</strong></p></li><li><p><code>row</code>ï¼Œè®°å½•ä¸ºSQLè¯­å¥åŠå…¶æ“ä½œçš„å…·ä½“æ•°æ®ï¼Œä¿è¯äº†åŠ¨æ€å€¼ç¡®å®šæ€§ï¼Œè®°å½•çš„å†…å®¹å¦‚ä¸‹ï¼š</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210907111928.png" alt=""></p><p><code>row</code>æ ¼å¼è®°å½•çš„å†…å®¹çœ‹ä¸åˆ°è¯¦ç»†ä¿¡æ¯ï¼Œè¦é€šè¿‡<code>mysqlbinlog</code>å·¥å…·è§£æå‡ºæ¥ã€‚</p><p>ç¼ºé™·ï¼šå¯¼è‡´<strong>æ—¥å¿—æ–‡ä»¶å˜å¾—éå¸¸å¤§</strong>ï¼Œæ¢å¤ä¸åŒæ­¥æ—¶ä¼šæ›´æ¶ˆè€—<code>IO</code>èµ„æºï¼Œå½±å“æ‰§è¡Œé€Ÿåº¦</p></li><li><p><code>mixed</code>ï¼ŒMySQLè‡ªå·±ç¡®å®šä½¿ç”¨<code>statement</code>è¿˜æ˜¯<code>row</code>å½¢å¼ï¼Œé»˜è®¤ä½¿ç”¨<code>statement</code>ï¼Œä»¥ä¸‹å‡ ç§æƒ…å†µä¼šä½¿ç”¨<code>row</code>å½¢å¼</p><ul><li>è¡¨çš„å­˜å‚¨å¼•æ“ä¸ºNDBï¼Œè¿™æ—¶å¯¹è¡¨çš„<code>DML</code>æ“ä½œéƒ½ä¼šä»¥<code>row</code>çš„æ ¼å¼è®°å½•</li><li>ä½¿ç”¨<code>now()</code>ã€<code>uuid()</code>ã€<code>user()</code>ç­‰å¯èƒ½å¼•èµ·æ•°æ®ä¸ä¸€è‡´çš„å‡½æ•°</li><li>ä½¿ç”¨<code>insert delay</code>è¯­å¥</li><li>ä½¿ç”¨ä¸´æ—¶è¡¨</li></ul></li></ul><h3 id="binlog-åˆ·ç›˜æ—¶æœº" tabindex="-1"><a class="header-anchor" href="#binlog-åˆ·ç›˜æ—¶æœº" aria-hidden="true">#</a> binlog åˆ·ç›˜æ—¶æœº</h3><p>åœ¨äº‹åŠ¡æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå…ˆæŠŠå†…å®¹å†™å…¥åˆ°<code>binlog cache</code>ä¸­ï¼Œåœ¨æ—¥å¿—æäº¤æ—¶ï¼Œä¼šæŠŠ<code>binlog cache</code>ä¸­çš„å†…å®¹å†™å…¥<code>page cache</code>ä¸­ï¼Œç„¶åç­‰å¾…åˆ·ç›˜å†™å…¥åˆ°<code>binlog</code>æ–‡ä»¶ä¸­</p><p>å› ä¸ºä¸€ä¸ªäº‹åŠ¡çš„<code>binlog</code>ä¸èƒ½è¢«æ‹†å¼€ï¼Œæ— è®ºè¿™ä¸ªäº‹åŠ¡å¤šå¤§ï¼Œä¹Ÿè¦<strong>ç¡®ä¿ä¸€æ¬¡æ€§å†™å…¥</strong>ï¼Œæ‰€ä»¥ç³»ç»Ÿä¼šç»™æ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€ä¸ªå—å†…å­˜ä½œä¸º<code>binlog cache</code>ï¼Œå¯ä»¥é€šè¿‡<code>binlog_cache_size</code>å‚æ•°æ§åˆ¶å•ä¸ªçº¿ç¨‹ <code>binlog cache</code> å¤§å°ï¼Œå¦‚æœå­˜å‚¨å†…å®¹è¶…è¿‡äº†è¿™ä¸ªå‚æ•°ï¼Œå°±è¦æš‚å­˜åˆ°ç£ç›˜<code>Swap</code></p><p><code>binlog</code>åˆ·ç›˜ç­–ç•¥æä¾›äº†<code>sync_binlog</code>å‚æ•°</p><ul><li><p>0ï¼šæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶éƒ½åªæŠŠ <code>binlog buffer</code> å†…å®¹å†™å…¥ <code>page cache</code>ï¼Œç­‰å¾…åå°çº¿ç¨‹æ¯ç§’çš„åˆ·ç›˜ï¼ŒæŠŠ<code>page cache</code>çš„å†…å®¹å†™å…¥<code>binlog</code>æ–‡ä»¶**ï¼ˆé»˜è®¤ï¼‰**</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210908143542.png" alt=""></p><p>ç”±äº<code>binlog cache</code>å†™å…¥åˆ°<code>page cache</code>éƒ½æ˜¯å†…å­˜ä¸­çš„æ“ä½œï¼Œä¸æ¶‰åŠåˆ°ç£ç›˜çš„æ“ä½œï¼Œæ‰€ä»¥æ€§èƒ½å¾ˆé«˜</p><p>ç¼ºç‚¹ï¼šå½“æœºå™¨å®•æœºï¼Œè€Œä¸”<code>page cache</code>è¿˜æ²¡è¿›è¡Œåˆ·ç›˜æ“ä½œæ—¶ï¼Œ<code>page cache</code>ä¸­æœ¬è¯¥è®°å½•åˆ°<code>binlog</code>æ—¥å¿—ä¸­çš„å†…å®¹ä¼šä¸¢å¤±</p></li><li><p>1ï¼šæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶éƒ½ä¼šæŠŠ<code>page cache</code>çš„å†…å®¹è¿›è¡Œåˆ·ç›˜</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210908141410.png" alt=""></p><p>æ¯æ¬¡äº‹åŠ¡æäº¤éƒ½æ‰§è¡Œä¸€æ¬¡å®Œæ•´çš„è®°å½•æµç¨‹ï¼Œä»<code>binlog cache</code>åˆ°<code>page cache</code>å†åˆ°ç£ç›˜ï¼Œæ•°æ®å®‰å…¨ä¸æ˜“ä¸¢å¤±</p><p>ç¼ºç‚¹ï¼šæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½è¿›è¡Œå†™ç£ç›˜çš„æ“ä½œï¼Œæ€§èƒ½ä¸é«˜</p></li><li><p>N(N&gt;1)ï¼ŒæŠ˜ä¸­æ–¹æ¡ˆï¼Œæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½æŠŠ<code>binlog cache</code>çš„å†…å®¹å†™å…¥åˆ°<code>page cache</code>ï¼Œä½†æ˜¯ç´¯ç§¯Nä¸ªäº‹åŠ¡åï¼Œæ‰æŠŠ<code>page cache</code>ä¸­çš„å†…å®¹è¿›è¡Œåˆ·ç›˜</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210908144438.png" alt=""></p><p>åœ¨å‡ºç°<code>IO</code>ç“¶é¢ˆçš„åœºæ™¯é‡Œï¼Œå°†<code>sync_binlog</code>è®¾ç½®æˆä¸€ä¸ªæ¯”è¾ƒå¤§çš„å€¼ï¼Œå¯ä»¥æå‡æ€§èƒ½</p><p>ç¼ºç‚¹ï¼šå¦‚æœæœºå™¨å®•æœºï¼Œé‚£ä¹ˆä¼šä¸¢å¤±æœ€è¿‘çš„Nä¸ªäº‹åŠ¡çš„<code>binlog</code>æ—¥å¿—</p></li></ul><h3 id="äºŒè¿›åˆ¶æ—¥å¿—ç›¸å…³å˜é‡" tabindex="-1"><a class="header-anchor" href="#äºŒè¿›åˆ¶æ—¥å¿—ç›¸å…³å˜é‡" aria-hidden="true">#</a> äºŒè¿›åˆ¶æ—¥å¿—ç›¸å…³å˜é‡</h3><ul><li>log_bin = {on | off | base_name} æŒ‡å®šæ˜¯å¦å¯ç”¨è®°å½•äºŒè¿›åˆ¶æ—¥å¿—æˆ–è€…æŒ‡å®šä¸€ä¸ªæ—¥å¿—è·¯å¾„(è·¯å¾„ä¸èƒ½åŠ .å¦åˆ™.åçš„è¢«å¿½ç•¥)</li><li>log_bin_index = name æŒ‡å®šmysql-bin.indexæ–‡ä»¶çš„è·¯å¾„</li><li>expire_logs_days = # æŒ‡å®šè‡ªåŠ¨åˆ é™¤äºŒè¿›åˆ¶æ—¥å¿—çš„æ—¶é—´ï¼Œå³æ—¥å¿—è¿‡æœŸæ—¶é—´</li><li>binlog_do_db = name æ˜ç¡®æŒ‡å®šè¦è®°å½•æ—¥å¿—çš„æ•°æ®åº“</li><li>binlog_ignore_db = name æŒ‡å®šä¸è®°å½•äºŒè¿›åˆ¶æ—¥å¿—çš„æ•°æ®åº“</li><li>binlog_format = { mixed | row | statement } æŒ‡å®šäºŒè¿›åˆ¶æ—¥å¿—åŸºäºä»€ä¹ˆæ¨¡å¼è®°å½•</li><li>binlog_cache_size = 32768 <strong>åŸºäºäº‹åŠ¡ç±»å‹çš„æ—¥å¿—ä¼šå…ˆè®°å½•åœ¨ç¼“å†²åŒº</strong>ï¼Œå½“è¾¾åˆ°è¯¥ç¼“å†²å¤§å°æ—¶è¿™äº›æ—¥å¿—ä¼šå†™å…¥ç£ç›˜</li><li>max_binlog_cache_size = #æŒ‡å®šäºŒè¿›åˆ¶æ—¥å¿—ç¼“å­˜æœ€å¤§å¤§å°ï¼Œç¡¬é™åˆ¶ã€‚é»˜è®¤4Gï¼Œå¤Ÿå¤§äº†ï¼Œå»ºè®®ä¸è¦æ”¹</li><li>binlog_cache_useï¼šä½¿ç”¨ç¼“å­˜å†™äºŒè¿›åˆ¶æ—¥å¿—çš„æ¬¡æ•°(è¿™æ˜¯ä¸€ä¸ªå®æ—¶å˜åŒ–çš„ç»Ÿè®¡å€¼)</li><li>binlog_cache_disk_use:ä½¿ç”¨ä¸´æ—¶æ–‡ä»¶å†™äºŒè¿›åˆ¶æ—¥å¿—çš„æ¬¡æ•°ï¼Œå½“æ—¥å¿—è¶…è¿‡äº†binlog_cache_sizeçš„æ—¶å€™ä¼šä½¿ç”¨ä¸´æ—¶æ–‡ä»¶å†™æ—¥å¿—ï¼Œå¦‚æœè¯¥å˜é‡å€¼ä¸ä¸º0ï¼Œåˆ™è€ƒè™‘å¢å¤§binlog_cache_sizeçš„å€¼</li><li>sync_binlog = { 0 | n } <strong>è¿™ä¸ªå‚æ•°ç›´æ¥å½±å“mysqlçš„æ€§èƒ½å’Œå®Œæ•´æ€§</strong><ul><li>sync_binlog=0:ä¸åŒæ­¥ï¼Œæ—¥å¿—ä½•æ—¶åˆ·åˆ°ç£ç›˜ç”±FileSystemå†³å®šï¼Œè¿™ä¸ªæ€§èƒ½æœ€å¥½</li><li>sync_binlog=n:æ¯å†™næ¬¡äº‹åŠ¡ï¼ŒMySQLå°†æ‰§è¡Œä¸€æ¬¡ç£ç›˜åŒæ­¥æŒ‡ä»¤fdatasync()å°†ç¼“å­˜æ—¥å¿—åˆ·æ–°åˆ°ç£ç›˜æ—¥å¿—æ–‡ä»¶ä¸­ã€‚MySQLä¸­é»˜è®¤çš„è®¾ç½®æ˜¯sync_binlog=0ï¼Œå³ä¸åŒæ­¥ï¼Œè¿™æ—¶æ€§èƒ½æœ€å¥½ï¼Œä½†é£é™©æœ€å¤§ã€‚ä¸€æ—¦ç³»ç»Ÿå¥”æºƒï¼Œç¼“å­˜ä¸­çš„æ—¥å¿—éƒ½ä¼šä¸¢å¤±ã€‚</li><li>åœ¨innodbçš„ä¸»ä»å¤åˆ¶ç»“æ„ä¸­ï¼Œè¦ä¿è¯äº‹åŠ¡çš„ä¸€è‡´æ€§å’ŒæŒä¹…æ€§çš„æ—¶å€™ï¼Œ<strong>å¿…é¡»å°†sync_binlogçš„å€¼è®¾ç½®ä¸º1</strong>ï¼Œå› ä¸ºè®¾ç½®ä¸º1å°±ä¿è¯äº†æ¯æ¬¡äº‹åŠ¡æäº¤æ—¶äºŒè¿›åˆ¶æ—¥å¿—éƒ½ä¼šå†™å…¥åˆ°ç£ç›˜ä¸­ï¼Œä»è€Œç«‹å³è¢«ä»æœåŠ¡å™¨å¤åˆ¶è¿‡å»ã€‚</li></ul></li></ul><h3 id="äºŒè¿›åˆ¶æ—¥å¿—å®šç‚¹è¿˜åŸæ•°æ®åº“" tabindex="-1"><a class="header-anchor" href="#äºŒè¿›åˆ¶æ—¥å¿—å®šç‚¹è¿˜åŸæ•°æ®åº“" aria-hidden="true">#</a> äºŒè¿›åˆ¶æ—¥å¿—å®šç‚¹è¿˜åŸæ•°æ®åº“</h3><ul><li><p>ä¸€èˆ¬ä½¿ç”¨åŸºäºæ—¶é—´ç‚¹æ¥æ¢å¤ï¼Œå’ŒåŸºäºä½ç½®ç›¸æ¯”ï¼Œè·¨æ—¥å¿—æ–‡ä»¶æ¢å¤æ—¶æ›´æ–¹ä¾¿</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>mysqlbinlog --stop-datetime<span class="token operator">=</span><span class="token string">&quot;2014-7-2 15:27:48&quot;</span> /tmp/mysql-bin.000008 <span class="token operator">|</span> mysql -uuser -ppassword
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>å¯ä»¥é€‰æ‹©æ¢å¤å¤šä¸ªäºŒè¿›åˆ¶æ–‡ä»¶</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>mysqlbinlog mysql-bin.<span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token operator">|</span> mysql -uuser -ppassword
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æˆ–è€…å¯¼å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­æ¥æ¢å¤</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>mysqlbinlog mysql-bin.000001 <span class="token operator">&gt;</span> /tmp/a.sql
mysqlbinlog mysql-bin.000002 <span class="token operator">&gt;&gt;</span> /tmp/a.sql
mysql -uuser -ppassword -e <span class="token string">&quot;source /tmp/a.sql&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="äº‹åŠ¡æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡æ—¥å¿—" aria-hidden="true">#</a> äº‹åŠ¡æ—¥å¿—</h2><h3 id="redo-log" tabindex="-1"><a class="header-anchor" href="#redo-log" aria-hidden="true">#</a> redo log</h3><p><strong>redo log</strong>ï¼ˆé‡åšæ—¥å¿—ï¼‰æ˜¯<strong>InnoDBå­˜å‚¨å¼•æ“ç‹¬æœ‰</strong>çš„ï¼Œå®ƒè®©MySQLæ‹¥æœ‰äº†<strong>å´©æºƒæ¢å¤</strong>çš„èƒ½åŠ›ï¼Œæ¢å¤æ•°æ®æ—¶<code>InnoDB</code>ä¼šä½¿ç”¨<code>redo log</code>æ¥ä¿è¯æ•°æ®çš„å®Œæ•´æ€§å’ŒæŒä¹…æ€§</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210902170055.png" alt=""></p><h4 id="redo-logå¼•å…¥" tabindex="-1"><a class="header-anchor" href="#redo-logå¼•å…¥" aria-hidden="true">#</a> redo logå¼•å…¥</h4><p>å› ä¸ºMySQLçš„IOä»£ä»·çš„ç¼˜æ•…ï¼ŒMySQLå®¢æˆ·ç«¯ä¸ä¼šæ¯æ¬¡éƒ½ç›´æ¥æ“ä½œç£ç›˜</p><p>åœ¨æ‰§è¡ŒæŸ¥è¯¢è¯­å¥æ—¶ï¼ŒMySQLä¼šä»ç£ç›˜ä¸­æŠŠä¸€é¡µçš„æ•°æ®ï¼ˆç§°ä¸ºæ•°æ®é¡µï¼‰åŠ è½½å‡ºæ¥æ”¾å…¥<strong>Buffer Pool</strong>ä¸­ï¼Œåç»­çš„æŸ¥è¯¢éƒ½ä¸è¿™ä¸ª<code>Buffer Pool</code>è¿›è¡Œäº¤äº’ï¼Œå‡å°‘ç£ç›˜IOå¼€é”€ï¼Œæå‡æ€§èƒ½</p><p>åœ¨æ‰§è¡Œæ›´æ–°è¯­å¥æ—¶ï¼ŒMySQLçš„åšæ³•ä¹ŸåŒæ ·å¦‚æ­¤ï¼Œå½“<code>Buffer Pool</code>é‡Œé¢çš„æ•°æ®éœ€è¦æ›´æ–°æ—¶ï¼Œå…ˆåœ¨<code>Buffer Pool</code>é‡Œé¢è¿›è¡Œæ›´æ–°ï¼Œå½“å†…å­˜ä¸­(<code>Buffer Pool</code>)æ•°æ®å’Œç¡¬ç›˜ä¸­çš„æ•°æ®ä¸ä¸€è‡´æ—¶ï¼Œé‚£ä¹ˆå†…å­˜ä¸­çš„æ•°æ®ç§°ä¸º<strong>è„é¡µ</strong>ï¼Œç­‰å¾…åç»­<code>Buffer Pool</code>è¿›è¡Œ<strong>åˆ·è„</strong>ï¼Œç„¶åä¼šæŠŠåœ¨å“ªä¸ªæ•°æ®é¡µä¸Šåšäº†å“ªäº›ä¿®æ”¹è®°å½•åˆ°<strong>redo log buffer</strong>ï¼ˆç§°ä¸ºé‡åšæ—¥å¿—ç¼“å­˜ï¼‰é‡Œé¢ï¼Œç­‰å¾…<strong>åç»­åˆ·ç›˜åˆ°redo logæ–‡ä»¶é‡Œé¢</strong></p><p><strong>ä»æ›´æ–°æ“ä½œä¹Ÿå¯ä»¥çœ‹å‡ºï¼ŒMySQLåœ¨å†™æ–‡ä»¶çš„å¤„ç†ä¸­ä¸€èˆ¬ä¼šä¼´éšç¼“å­˜+æ–‡ä»¶çš„ç»„åˆ</strong></p><p>redo logä¸­çš„è®°å½•æ˜¯ç”±<strong>è¡¨ç©ºé—´å·+æ•°æ®é¡µå·+åç§»é‡+ä¿®æ”¹æ•°æ®é•¿åº¦+å…·ä½“ä¿®æ”¹çš„æ•°æ®</strong>ç»„æˆ</p><p><strong>æ€»ç»“</strong></p><p>ä¸æŠŠæ•°æ®é¡µç›´æ¥åˆ·ç›˜ï¼Œè€Œç”¨<code>redo log</code>è¿›è¡Œä¿®æ”¹å†…å®¹çš„è®°å½•çš„åŸå› </p><ol><li>æ•°æ®é¡µå¤§å°æ˜¯<code>16KB=16384Byte</code>ï¼Œå¯èƒ½ä¹Ÿå°±ä¿®æ”¹äº†æ•°æ®é¡µä¸­å‡ <code>Byte</code>çš„æ•°æ®ï¼Œæ²¡æœ‰å¿…è¦æŠŠå®Œæ•´çš„æ•°æ®é¡µè¿›è¡Œåˆ·ç›˜ï¼Œ<strong>IOä»£ä»·å¤ªå¤§</strong></li><li>æ•°æ®é¡µåˆ·ç›˜æ˜¯<strong>éšæœºå†™</strong>ï¼Œå› ä¸ºä¸€ä¸ªæ•°æ®é¡µå¯¹åº”çš„ä½ç½®å¯èƒ½åœ¨ç¡¬ç›˜æ–‡ä»¶çš„éšæœºä½ç½®ï¼Œæ‰€ä»¥æ€§èƒ½æ˜¯å¾ˆå·®çš„ï¼›è€Œ<code>redo log</code>æ˜¯<strong>é¡ºåºå†™</strong>ï¼Œåˆ·ç›˜é€Ÿåº¦å¾ˆå¿«</li></ol><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210902172253.png" alt=""></p><h4 id="redo-logåˆ·ç›˜æ—¶æœº" tabindex="-1"><a class="header-anchor" href="#redo-logåˆ·ç›˜æ—¶æœº" aria-hidden="true">#</a> redo logåˆ·ç›˜æ—¶æœº</h4><p><code>InnoDB</code>å­˜å‚¨å¼•æ“ä¸º<code>redo log</code>çš„åˆ·ç›˜ç­–ç•¥æä¾›äº† <code>innodb_flush_log_at_trx_commit</code> å‚æ•°ï¼Œå®ƒæ”¯æŒä¸‰ç§ç­–ç•¥ã€‚å¦å¤–<code>InnoDB</code>å­˜å‚¨å¼•æ“æœ‰ä¸€ä¸ªåå°çº¿ç¨‹ï¼Œæ¯éš”1ç§’ï¼Œå°±ä¼šæŠŠ<code>redo log buffer</code>ä¸­çš„å†…å®¹å†™å…¥åˆ°<strong>page cacheï¼ˆæ–‡ä»¶ç³»ç»Ÿç¼“å­˜ï¼‰</strong>ï¼Œç„¶åè°ƒç”¨<strong>fsyncåˆ·ç›˜</strong></p><ul><li><p>0ï¼šæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶ä¸è¿›è¡Œåˆ·ç›˜æ“ä½œï¼Œåªæ˜¯ç­‰å¾…åå°çº¿ç¨‹è¿›è¡Œæ¯ç§’çš„åˆ·ç›˜</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210906165553.png" alt=""></p></li><li><p>1ï¼šæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶éƒ½è¿›è¡Œåˆ·ç›˜æ“ä½œ**ï¼ˆé»˜è®¤ï¼‰**ï¼Œé™¤äº†åå°çº¿ç¨‹è¿›è¡Œçš„æ¯ç§’çš„åˆ·ç›˜å¤–ï¼Œä¸€æ—¦äº‹åŠ¡æäº¤å°±è¿›è¡Œä¸»åŠ¨åˆ·ç›˜</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210906170211.png" alt=""></p></li><li><p>2ï¼šæ¯æ¬¡äº‹åŠ¡æäº¤æ—¶éƒ½åªæŠŠ <code>redo log buffer</code> å†…å®¹å†™å…¥ <code>page cache</code>ï¼Œç­‰å¾…åå°çº¿ç¨‹æ¯ç§’çš„åˆ·ç›˜ï¼ŒæŠŠ<code>page cache</code>çš„å†…å®¹å†™å…¥<code>redo log</code>æ–‡ä»¶</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210906170444.png" alt=""></p></li></ul><h4 id="redo-logæ–‡ä»¶ç»„" tabindex="-1"><a class="header-anchor" href="#redo-logæ–‡ä»¶ç»„" aria-hidden="true">#</a> redo logæ–‡ä»¶ç»„</h4><p>ç¡¬ç›˜ä¸Šå­˜å‚¨çš„ <code>redo log</code> æ—¥å¿—æ–‡ä»¶æ˜¯ä»¥ä¸€ä¸ª<strong>æ—¥å¿—æ–‡ä»¶ç»„</strong>çš„å½¢å¼å‡ºç°çš„ï¼Œæ¯ä¸ªçš„<code>redo</code>æ—¥å¿—æ–‡ä»¶å¤§å°éƒ½æ˜¯ä¸€æ ·çš„</p><p>æ¯”å¦‚å¯ä»¥é…ç½®ä¸ºä¸€ç»„<code>4</code>ä¸ªæ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶çš„å¤§å°æ˜¯ <code>1GB</code>ï¼Œé‚£ä¹ˆæ•´ä¸ª <code>redo log</code> æ—¥å¿—æ–‡ä»¶ç»„å¯ä»¥è®°å½•<code>4G</code>çš„å†…å®¹</p><p>å®ƒé‡‡ç”¨çš„æ˜¯<strong>ç¯å½¢æ•°ç»„</strong>å½¢å¼ï¼Œä»å¤´å¼€å§‹å†™ï¼Œå†™åˆ°æœ«å°¾åˆå›åˆ°å¤´å¾ªç¯å†™</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210906171107.png" alt=""></p><p>åœ¨æ—¥å¿—æ–‡ä»¶ç»„ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„å±æ€§</p><ul><li><code>write pos</code>ï¼šå½“å‰è®°å½•çš„ä½ç½®ï¼Œæ’å…¥è®°å½•çš„ä½ç½®</li><li><code>checkpoint</code>ï¼šå½“å‰æ“¦é™¤çš„ä½ç½®ï¼Œä»<code>redo log</code>æ¢å¤æ•°æ®çš„å¼€å§‹ä½ç½®</li></ul><p>å¦‚æœ<code>write pos</code>è¿½ä¸Šäº†<code>checkpoint</code>ï¼Œ<strong>é‚£å°±è¯´æ˜å½“å‰è®°å½•çš„<code>redo log</code>å·²ç»æ»¡äº†ï¼Œå¦‚æœå†è®°å½•çš„è¯ä¼šæŠŠä¸Šä¸€æ¬¡å¼€å§‹è®°å½•çš„å†…å®¹è¦†ç›–æ‰</strong>ï¼Œæ‰€ä»¥éœ€è¦åœä¸‹æ¥å…ˆæ¸…ç©ºä¸€äº›è®°å½•ï¼ŒæŠŠ<code>checkpoint</code>å¾€å‰æ¨è¿›</p><h4 id="redo-logå’Œbin-logåŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#redo-logå’Œbin-logåŒºåˆ«" aria-hidden="true">#</a> redo logå’Œbin logåŒºåˆ«</h4><ul><li>æ—¥å¿—çš„ä½ç½® <ul><li><code>redo log</code>æ˜¯<code>InnoDB</code>å­˜å‚¨å¼•æ“ç‰¹æœ‰çš„ï¼Œä½äº<strong>å­˜å‚¨å¼•æ“å±‚</strong></li><li><code>binlog</code>ä½äº<strong>MySQL Serverå±‚</strong></li></ul></li><li>æ—¥å¿—çš„å†…å®¹ <ul><li><code>redo log</code>è®°å½•çš„æ ¼å¼æ˜¯<strong>è¡¨ç©ºé—´å·+æ•°æ®é¡µå·+åç§»é‡+ä¿®æ”¹æ•°æ®é•¿åº¦+å…·ä½“ä¿®æ”¹çš„æ•°æ®</strong></li><li><code>binlog</code>è®°å½•çš„å†…å®¹æ˜¯<strong>è¯­å¥çš„åŸå§‹é€»è¾‘ï¼ˆSQLè¯­å¥ï¼‰</strong>ï¼Œä¸ç®¡ç”¨ä»€ä¹ˆå­˜å‚¨å¼•æ“ï¼Œåªè¦å‘ç”Ÿäº†è¡¨æ•°æ®æ›´æ–°ï¼Œéƒ½ä¼šäº§ç”Ÿ<code>binlog</code>æ—¥å¿—</li></ul></li><li>ä¸¤è€…éƒ½å±äºæŒä¹…åŒ–çš„ä¿è¯ï¼Œä½†æ˜¯ä¾§é‡ç‚¹ä¸åŒ <ul><li><code>redo log</code>è®©<code>InnoDB</code>å­˜å‚¨å¼•æ“æ‹¥æœ‰äº†å´©æºƒæ¢å¤èƒ½åŠ›</li><li><code>binlog</code>ä¿è¯äº†<code>MySQL</code>é›†ç¾¤æ¶æ„çš„æ•°æ®ä¸€è‡´æ€§</li></ul></li></ul><h3 id="undo-log" tabindex="-1"><a class="header-anchor" href="#undo-log" aria-hidden="true">#</a> undo log</h3><p><code>undo log</code>ï¼ˆå›æ»šæ—¥å¿—ï¼‰ä¿è¯äº†äº‹åŠ¡çš„<strong>åŸå­æ€§</strong></p><p>å½“å¼‚å¸¸å‘ç”Ÿæ—¶ï¼Œå¯¹å·²æ‰§è¡Œçš„æ“ä½œéœ€è¦è¿›è¡Œ<strong>å›æ»š</strong>ï¼Œåœ¨MySQLä¸­ï¼Œæ¢å¤æœºåˆ¶æ˜¯é€šè¿‡<code>undo log</code>å›æ»šæ—¥å¿—å®ç°çš„</p><p><strong>å›æ»šæ—¥å¿—ä¼šå…ˆäºæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ä¸Š</strong>ï¼Œè¿™æ ·å°±ä¿è¯äº†å³ä½¿é‡åˆ°æ•°æ®åº“çªç„¶å®•æœºç­‰æƒ…å†µï¼Œå½“ç”¨æˆ·å†æ¬¡å¯åŠ¨æ•°æ®åº“çš„æ—¶å€™ï¼Œæ•°æ®åº“è¿˜èƒ½å¤Ÿé€šè¿‡æŸ¥è¯¢å›æ»šæ—¥å¿—æ¥å›æ»šå°†ä¹‹å‰æœªå®Œæˆçš„äº‹åŠ¡</p><h4 id="redo-logå’Œundo-logåŒºåˆ«" tabindex="-1"><a class="header-anchor" href="#redo-logå’Œundo-logåŒºåˆ«" aria-hidden="true">#</a> redo logå’Œundo logåŒºåˆ«</h4><p>MySQL <code>InnoDB</code> å¼•æ“ä½¿ç”¨ <strong>redo log(é‡åšæ—¥å¿—)</strong> ä¿è¯äº‹åŠ¡çš„<strong>æŒä¹…æ€§</strong>ï¼Œä½¿ç”¨ <strong>undo log(å›æ»šæ—¥å¿—)</strong> æ¥ä¿è¯äº‹åŠ¡çš„<strong>åŸå­æ€§</strong>ã€‚</p><h2 id="ä¸¤é˜¶æ®µæäº¤" tabindex="-1"><a class="header-anchor" href="#ä¸¤é˜¶æ®µæäº¤" aria-hidden="true">#</a> ä¸¤é˜¶æ®µæäº¤</h2><p>åœ¨æ‰§è¡Œæ›´æ–°è¯­å¥æ—¶ï¼Œä¼šè®°å½•<code>redo log</code>å’Œ<code>binlog</code>ä¸¤ä»½æ—¥å¿—ï¼Œ<code>redo log</code>åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­å¯ä»¥ä¸æ–­å†™å…¥ï¼ˆå› ä¸º<code>InnoDB</code>å­˜å‚¨å¼•æ“æœ‰ä¸€ä¸ªåå°çº¿ç¨‹ï¼Œæ¯éš”1ç§’ï¼Œå°±ä¼šæŠŠ<code>redo log buffer</code>ä¸­çš„å†…å®¹å†™å…¥åˆ°<code>page cache</code>ï¼Œç„¶åè°ƒç”¨<code>fsync</code>åˆ·ç›˜ï¼‰ï¼›è€Œ<code>binlog</code>åªæœ‰åœ¨äº‹åŠ¡æäº¤æ—¶æ‰å†™å…¥ï¼Œæ‰€ä»¥<code>redo log</code>å’Œ<code>binlog</code>çš„å†™å…¥æ—¶æœºæ˜¯ä¸ä¸€è‡´çš„</p><h3 id="redo-logå’Œbinlogä¸¤ä»½æ—¥å¿—ä¸ä¸€è‡´å¯¼è‡´çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#redo-logå’Œbinlogä¸¤ä»½æ—¥å¿—ä¸ä¸€è‡´å¯¼è‡´çš„é—®é¢˜" aria-hidden="true">#</a> redo logå’Œbinlogä¸¤ä»½æ—¥å¿—ä¸ä¸€è‡´å¯¼è‡´çš„é—®é¢˜</h3><p>ä»¥<code>update T set c = 1 where id = 2</code>ä¸ºä¾‹ï¼Œå¦‚æœå†™å®Œ<code>redo log </code>åï¼Œ<code>binlog</code>å†™å…¥çš„è¿‡ç¨‹ä¸­å‘ç”Ÿäº†å¼‚å¸¸</p><p>ç”±äº<code>binlog</code>æ²¡å†™å®Œå°±å¼‚å¸¸ï¼Œè¿™æ—¶å€™<code>binlog</code>é‡Œé¢æ²¡æœ‰å¯¹åº”çš„ä¿®æ”¹è®°å½•ã€‚å› æ­¤ï¼Œä¹‹åç”¨<code>binlog</code>æ—¥å¿—æ¢å¤ä»åº“çš„æ•°æ®æ—¶ï¼Œå°±ä¼šå°‘è¿™ä¸€æ¬¡æ›´æ–°ï¼Œæ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œ<code>c</code>å€¼æ˜¯<code>0</code>ï¼Œè€ŒåŸåº“å› ä¸º<code>redo log</code>æ—¥å¿—æ¢å¤ï¼Œè¿™ä¸€è¡Œ<code>c</code>å€¼æ˜¯<code>1</code>ï¼Œæœ€ç»ˆæ•°æ®ä¸ä¸€è‡´</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210909112032.png" alt=""></p><h3 id="ä¸¤é˜¶æ®µæäº¤åŸç†" tabindex="-1"><a class="header-anchor" href="#ä¸¤é˜¶æ®µæäº¤åŸç†" aria-hidden="true">#</a> ä¸¤é˜¶æ®µæäº¤åŸç†</h3><p>ä¸ºäº†é˜²æ­¢å‡ºç°æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼ŒMySQLå°†<code>redo log</code>çš„å†™å…¥æ‹†æˆäº†ä¸¤ä¸ªæ­¥éª¤<code>prepare</code>å’Œ<code>commit</code>ï¼Œè¿™å°±æ˜¯<strong>ä¸¤é˜¶æ®µæäº¤</strong></p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210909112205.png" alt=""></p><ul><li><p>å½“å†™å…¥<code>binlog</code>æ—¶å‘ç”Ÿå¼‚å¸¸ï¼ŒMySQLä¼šæ£€æŸ¥<code>redo log</code>å¤„äºä»€ä¹ˆé˜¶æ®µï¼Œå¦‚æœæ˜¯<code>prepare</code>é˜¶æ®µï¼Œå¹¶ä¸”ä¹Ÿæ²¡æœ‰å¯¹åº”çš„<code>binlog</code>æ—¥å¿—æ—¶ï¼Œå°±ä¼šå›æ»šäº‹åŠ¡</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210909113524.png" alt=""></p></li><li><p>å½“<code>redo log</code>è®¾ç½®<code>commit</code>é˜¶æ®µå‘ç”Ÿå¼‚å¸¸ï¼Œæ­¤æ—¶è™½ç„¶<code>redo log</code>è¿˜æ˜¯å¤„äº<code>prepare</code>é˜¶æ®µï¼Œä½†æ˜¯èƒ½é€šè¿‡äº‹åŠ¡Idåœ¨<code>binlog</code>ä¸­æ‰¾åˆ°å¯¹åº”çš„<code>binlog</code>æ—¥å¿—ï¼Œæ‰€ä»¥å¯ä»¥è®¤ä¸ºè¿™æ˜¯å®Œæ•´çš„è®°å½•ï¼Œå°±ä¼šæŠŠäº‹åŠ¡æäº¤</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20210909113538.png" alt=""></p></li></ul><h1 id="æ•°æ®åº“è®¾è®¡" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åº“è®¾è®¡" aria-hidden="true">#</a> æ•°æ®åº“è®¾è®¡</h1><h2 id="å¤šè¡¨ä¹‹é—´çš„å…³ç³»" tabindex="-1"><a class="header-anchor" href="#å¤šè¡¨ä¹‹é—´çš„å…³ç³»" aria-hidden="true">#</a> å¤šè¡¨ä¹‹é—´çš„å…³ç³»</h2><ul><li><p>ä¸€å¯¹ä¸€(äº†è§£)</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- å¦‚ï¼šäººå’Œèº«ä»½è¯çš„å…³ç³»
-- åˆ†æï¼šä¸€ä¸ªäººåªæœ‰ä¸€ä¸ªèº«ä»½è¯ï¼Œä¸€ä¸ªèº«ä»½è¯åªèƒ½å¯¹åº”ä¸€ä¸ªäºº

-- å®ç°ï¼šä¸€å¯¹ä¸€å…³ç³»çš„å®ç°ï¼Œå¯ä»¥åœ¨ä»»æ„ä¸€æ–¹æ·»åŠ å”¯ä¸€å¤–é”®uniqueæŒ‡å‘å¦ä¸€æ–¹çš„ä¸»é”®ï¼›æˆ–è€…è®©ä¸¤ä¸ªè¡¨çš„ä¸»é”®ç›¸åŒï¼›æˆ–è€…ç›´æ¥åˆæˆä¸€å¼ è¡¨
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ä¸€å¯¹å¤š(å¤šå¯¹ä¸€)(é‡è¦)</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- å¦‚ï¼šéƒ¨é—¨å’Œå‘˜å·¥çš„å…³ç³»
-- åˆ†æï¼šä¸€ä¸ªéƒ¨é—¨æœ‰å¤šä¸ªå‘˜å·¥ï¼Œä¸€ä¸ªå‘˜å·¥åªèƒ½å¯¹åº”ä¸€ä¸ªéƒ¨é—¨

-- å®ç°ï¼šåœ¨å¤šçš„ä¸€æ–¹å»ºç«‹å¤–é”®ï¼ŒæŒ‡å‘ä¸€çš„ä¸€æ–¹çš„ä¸»é”®
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å¤šå¯¹å¤š</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>-- å¦‚ï¼šå­¦ç”Ÿå’Œè¯¾ç¨‹
-- åˆ†æï¼šä¸€ä¸ªå­¦ç”Ÿå¯ä»¥é€‰æ‹©å¤šé—¨è¯¾ç¨‹ï¼Œä¸€ä¸ªè¯¾ç¨‹ä¹Ÿå¯ä»¥è¢«å¾ˆå¤šå­¦ç”Ÿé€‰æ‹©

-- å®ç°ï¼šå¤šå¯¹å¤šå…³ç³»å®ç°éœ€è¦å€ŸåŠ©ç¬¬ä¸‰å¼ ä¸­é—´è¡¨ï¼Œè¿™å¼ ä¸­é—´è¡¨è‡³å°‘åŒ…å«ä¸¤ä¸ªå­—æ®µï¼Œè¿™ä¸¤ä¸ªå­—æ®µä½œä¸ºä¸­é—´è¡¨çš„ä¸»é”®ï¼Œåˆ†åˆ«æŒ‡å‘ä¸¤ä¸ªè¡¨çš„ä¸»é”®
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><h2 id="èŒƒå¼" tabindex="-1"><a class="header-anchor" href="#èŒƒå¼" aria-hidden="true">#</a> èŒƒå¼</h2><p>è®¾è®¡æ•°æ®åº“æ—¶éœ€è¦éµå¾ªçš„è§„èŒƒã€‚è¦éµå¾ªåè¾¹çš„èŒƒå¼è¦æ±‚ï¼Œå¿…é¡»å…ˆéµå¾ªå‰è¾¹çš„æ‰€æœ‰èŒƒå¼è¦æ±‚</p><p>åˆ†ç±»</p><ul><li><p>ç¬¬ä¸€èŒƒå¼ï¼š<strong>æ¯ä¸€é¡¹éƒ½æ˜¯ä¸å¯åˆ†å‰²çš„åŸå­æ•°æ®é¡¹</strong></p><ul><li><p>ä¸å…è®¸å‡ºç°<strong>å¤åˆåˆ—</strong></p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/007S8ZIlgy1gfsrnje6vzj311y0r6arv.jpg" alt=""></p></li><li><p>å­˜åœ¨æ•°æ®å†—ä½™</p></li><li><p>æ•°æ®æ·»åŠ å­˜åœ¨é—®é¢˜</p></li><li><p>æ•°æ®åˆ é™¤å­˜åœ¨é—®é¢˜</p></li></ul></li><li><p>ç¬¬äºŒèŒƒå¼ï¼šåœ¨ç¬¬ä¸€èŒƒå¼åŸºç¡€ä¸Šï¼Œéç å±æ€§å¿…é¡»<strong>å®Œå…¨ä¾èµ–äºç </strong>ã€‚åœ¨ç¬¬ä¸€èŒƒå¼çš„åŸºç¡€ä¸Š<strong>æ¶ˆé™¤éä¸»å±æ€§å¯¹ä¸»ç çš„éƒ¨åˆ†å‡½æ•°ä¾èµ–</strong></p><ul><li><p>å‡ ä¸ªæ¦‚å¿µ</p><ul><li>å‡½æ•°ä¾èµ–ï¼šå¦‚æœé€šè¿‡Açš„å±æ€§(å±æ€§ç»„)çš„å€¼å¯ä»¥ç¡®å®šå”¯ä¸€Bçš„å±æ€§çš„å€¼ï¼Œé‚£ä¹ˆå°±ç§°Bä¾èµ–äºAã€‚å¦‚å­¦å·-&gt;å§“åï¼Œ(å­¦å·ï¼Œè¯¾ç¨‹åç§°)-&gt;åˆ†æ•°</li><li>å®Œå…¨å‡½æ•°ä¾èµ–ï¼šå¦‚æœAæ˜¯ä¸€ä¸ªå±æ€§ç»„ï¼ŒBå±æ€§å€¼çš„ç¡®å®šéœ€è¦ä¾èµ–äºAå±æ€§ç»„ä¸­æ‰€æœ‰çš„å±æ€§å€¼ã€‚å¦‚ï¼š(å­¦å·ï¼Œè¯¾ç¨‹åç§°)-&gt;åˆ†æ•°</li><li>éƒ¨åˆ†å‡½æ•°ä¾èµ–ï¼šå¦‚æœAæ˜¯ä¸€ä¸ªå±æ€§ç»„ï¼ŒBå±æ€§å€¼çš„ç¡®å®šéœ€è¦ä¾èµ–äºAå±æ€§ç»„ä¸­æŸäº›çš„å±æ€§å€¼ã€‚å¦‚ï¼š(å­¦å·ï¼Œè¯¾ç¨‹åç§°)-&gt;å§“åï¼Œå…¶å®åªéœ€å­¦å·æ¥ç¡®å®šå§“å</li><li>ä¼ é€’å‡½æ•°ä¾èµ–ï¼šå¦‚æœé€šè¿‡Açš„å±æ€§(å±æ€§ç»„)çš„å€¼ï¼Œå¯ä»¥ç¡®å®šå”¯ä¸€Bå±æ€§çš„å€¼ï¼Œå†é€šè¿‡Bçš„å±æ€§(å±æ€§ç»„)çš„å€¼ï¼Œå¯ä»¥ç¡®å®šå”¯ä¸€Cå±æ€§çš„å€¼ï¼Œé‚£ä¹ˆå°±ç§°Cä¼ é€’ä¾èµ–äºAã€‚å¦‚ï¼šå­¦å·-&gt;ç³»å-&gt;ç³»ä¸»ä»»</li><li><strong>ç </strong>ï¼šå¦‚æœåœ¨ä¸€å¼ è¡¨ä¸­ï¼Œä¸€ä¸ªå±æ€§æˆ–è€…ä¸€ä¸ªå±æ€§ç»„ï¼Œè¢«å…¶ä»–æ‰€æœ‰å±æ€§æ‰€å®Œå…¨ä¾èµ–ï¼Œåˆ™ç§°è¿™ä¸ªå±æ€§(å±æ€§ç»„)ä¸ºè¯¥è¡¨çš„ç ã€‚å¦‚ï¼šç ï¼š(å­¦å·ï¼Œè¯¾ç¨‹åç§°)</li><li>ä¸»å±æ€§ï¼šç å±æ€§ç»„ä¸­æ‰€æœ‰å±æ€§</li><li>éä¸»å±æ€§ï¼šé™¤ç å±æ€§ç»„å¤–çš„å±æ€§</li></ul></li><li><p>åšæ³•ï¼šæ‹†åˆ†è¡¨</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/007S8ZIlgy1gfsrmck4zvj31ja0u07wh.jpg" alt=""></p></li><li><p>è§£å†³äº†<strong>æ•°æ®å†—ä½™</strong>çš„é—®é¢˜ï¼Œä½†å­˜åœ¨åŒæ ·çš„æ•°æ®æ’å…¥ã€åˆ é™¤çš„é—®é¢˜</p></li></ul></li><li><p>ç¬¬ä¸‰èŒƒå¼ï¼šåœ¨ç¬¬äºŒèŒƒå¼åŸºç¡€ä¸Šï¼Œä»»ä½•éä¸»å±æ€§ä¸ä¾èµ–äºå…¶ä»–éä¸»å±æ€§ã€‚åœ¨ç¬¬äºŒèŒƒå¼åŸºç¡€ä¸Šæ¶ˆé™¤ä¼ é€’ä¾èµ–</p><ul><li><p>åšæ³•ï¼šå†æ‹†åˆ†è¡¨</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/007S8ZIlgy1gfsrmdbjrij31320pun9x.jpg" alt=""></p></li><li><p>è§£å†³äº†æ•°æ®<strong>æ’å…¥</strong>ä¸åˆæ³•å’Œ<strong>åˆ é™¤</strong>é£é™©çš„é—®é¢˜</p></li></ul></li></ul><h2 id="åŠ¨æ€å­—æ®µ" tabindex="-1"><a class="header-anchor" href="#åŠ¨æ€å­—æ®µ" aria-hidden="true">#</a> åŠ¨æ€å­—æ®µ</h2><p>ä»¥äº§å“ä¸ºä¾‹ï¼Œä¸åŒç±»å‹äº§å“ä¼šæœ‰ä¸åŒçš„å±æ€§ï¼ˆç”µè„‘ã€æ‰‹æœºï¼‰ï¼Œå±æ€§åç§°å’Œä¸ªæ•°éƒ½ä¸ç¡®å®š</p><p>é‡‡ç”¨åšæ³•ï¼š<strong>å±æ€§å…¬ç”¨+å±æ€§å­—æ®µè¡Œå­˜å‚¨</strong>ï¼Œå…¬ç”¨çš„å­—æ®µæ”¾åœ¨äº§å“è¡¨ä¸­ï¼Œç‰¹æœ‰çš„å­—æ®µæ”¾åœ¨äº§å“å±æ€§è¡¨ä¸­å­˜å‚¨</p><p>äº§å“åˆ†ç±»è¡¨ã€äº§å“è¡¨ã€å±æ€§è¡¨ã€äº§å“å±æ€§è¡¨</p><h2 id="è¡Œè½¬åˆ—ã€åˆ—è½¬è¡Œ" tabindex="-1"><a class="header-anchor" href="#è¡Œè½¬åˆ—ã€åˆ—è½¬è¡Œ" aria-hidden="true">#</a> è¡Œè½¬åˆ—ã€åˆ—è½¬è¡Œ</h2><h1 id="åˆ†åº“åˆ†è¡¨" tabindex="-1"><a class="header-anchor" href="#åˆ†åº“åˆ†è¡¨" aria-hidden="true">#</a> åˆ†åº“åˆ†è¡¨</h1><h2 id="å‚ç›´åˆ‡åˆ†" tabindex="-1"><a class="header-anchor" href="#å‚ç›´åˆ‡åˆ†" aria-hidden="true">#</a> å‚ç›´åˆ‡åˆ†</h2><h3 id="å‚ç›´åˆ†åº“" tabindex="-1"><a class="header-anchor" href="#å‚ç›´åˆ†åº“" aria-hidden="true">#</a> å‚ç›´åˆ†åº“</h3><p>æ ¹æ®ä¸šåŠ¡è€¦åˆæ€§ï¼Œå°†<strong>å…³è”åº¦ä½</strong>çš„ä¸åŒè¡¨å­˜å‚¨åœ¨<strong>ä¸åŒçš„æ•°æ®åº“</strong>ã€‚åšæ³•ä¸å¤§ç³»ç»Ÿæ‹†åˆ†ä¸ºå¤šä¸ªå°ç³»ç»Ÿç±»ä¼¼ï¼ŒæŒ‰ä¸šåŠ¡åˆ†ç±»è¿›è¡Œç‹¬ç«‹åˆ’åˆ†ã€‚æ¯ä¸ªå¾®æœåŠ¡ä½¿ç”¨å•ç‹¬çš„ä¸€ä¸ªæ•°æ®åº“</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/007S8ZIlgy1gfsrme94x1j30zs0msthi.jpg" alt=""></p><h3 id="å‚ç›´åˆ†è¡¨" tabindex="-1"><a class="header-anchor" href="#å‚ç›´åˆ†è¡¨" aria-hidden="true">#</a> å‚ç›´åˆ†è¡¨</h3><p>å‚ç›´åˆ†è¡¨æ˜¯åŸºäºæ•°æ®åº“ä¸­çš„**&quot;åˆ—&quot;<strong>è¿›è¡Œï¼ŒæŸä¸ªè¡¨å­—æ®µè¾ƒå¤šï¼Œå¯ä»¥æ–°å»ºä¸€å¼ </strong>æ‰©å±•è¡¨**ï¼Œå°†<strong>ä¸ç»å¸¸ç”¨</strong>æˆ–<strong>å­—æ®µé•¿åº¦è¾ƒå¤§</strong>çš„å­—æ®µæ‹†åˆ†å‡ºå»åˆ°æ‰©å±•è¡¨ä¸­</p><p>å­—æ®µè¿‡å¤šçš„æƒ…å†µä¸‹ï¼Œé€šè¿‡&quot;å¤§è¡¨æ‹†å°è¡¨&quot;ï¼Œæ›´ä¾¿äºå¼€å‘ä¸ç»´æŠ¤ï¼Œä¹Ÿèƒ½<strong>é¿å…è·¨é¡µ</strong>é—®é¢˜ã€‚å› ä¸ºMySQL åº•å±‚æ˜¯é€šè¿‡æ•°æ®é¡µå­˜å‚¨çš„ï¼Œä¸€æ¡è®°å½•å ç”¨ç©ºé—´è¿‡å¤§ä¼šå¯¼è‡´è·¨é¡µï¼Œé€ æˆé¢å¤–çš„æ€§èƒ½å¼€é”€ã€‚</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/007S8ZIlgy1gfsrmf724uj310k0gwn14.jpg" alt=""></p><h3 id="ä¼˜ç¼ºç‚¹" tabindex="-1"><a class="header-anchor" href="#ä¼˜ç¼ºç‚¹" aria-hidden="true">#</a> ä¼˜ç¼ºç‚¹</h3><ul><li>ä¼˜ç‚¹ <ul><li>è§£å†³ä¸šåŠ¡ç³»ç»Ÿå±‚é¢çš„è€¦åˆï¼Œä¸šåŠ¡æ¸…æ™°</li><li>ä¸å¾®æœåŠ¡çš„æ²»ç†ç±»ä¼¼ï¼Œä¹Ÿèƒ½å¯¹ä¸åŒä¸šåŠ¡çš„æ•°æ®è¿›è¡Œåˆ†çº§ç®¡ç†ã€ç»´æŠ¤ã€ç›‘æ§ã€æ‰©å±•ç­‰</li><li>é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå‚ç›´åˆ‡åˆ†ä¸€å®šç¨‹åº¦çš„æå‡ IOã€æ•°æ®åº“è¿æ¥æ•°ã€å•æœºç¡¬ä»¶èµ„æºçš„ç“¶é¢ˆ</li></ul></li><li>ç¼ºç‚¹ <ul><li>éƒ¨åˆ†è¡¨æ— æ³• joinï¼Œåªèƒ½é€šè¿‡æ¥å£èšåˆæ–¹å¼è§£å†³ï¼Œæå‡äº†å¼€å‘çš„å¤æ‚åº¦</li><li>åˆ†å¸ƒå¼äº‹åŠ¡å¤„ç†å¤æ‚*</li><li>ä¾ç„¶å­˜åœ¨å•è¡¨æ•°æ®é‡è¿‡å¤§çš„é—®é¢˜(éœ€è¦æ°´å¹³åˆ‡åˆ†)</li></ul></li></ul><h2 id="æ°´å¹³åˆ‡åˆ†" tabindex="-1"><a class="header-anchor" href="#æ°´å¹³åˆ‡åˆ†" aria-hidden="true">#</a> æ°´å¹³åˆ‡åˆ†</h2><p>å½“ä¸€ä¸ªåº”ç”¨éš¾ä»¥å†ç»†ç²’åº¦çš„å‚ç›´åˆ‡åˆ†ï¼Œæˆ–åˆ‡åˆ†åæ•°æ®é‡è¡Œæ•°å·¨å¤§ï¼Œå­˜åœ¨å•åº“è¯»å†™ã€å­˜å‚¨æ€§èƒ½ç“¶é¢ˆï¼Œè¿™æ—¶å€™å°±éœ€è¦è¿›è¡Œæ°´å¹³åˆ‡åˆ†äº†ã€‚</p><p>è¡¨å†…æ•°æ®å†…åœ¨çš„<strong>é€»è¾‘å…³ç³»</strong>ï¼Œå°†åŒä¸€ä¸ªè¡¨<strong>æŒ‰ä¸åŒçš„æ¡ä»¶åˆ†æ•£</strong>åˆ°å¤šä¸ªæ•°æ®åº“æˆ–å¤šä¸ªè¡¨ä¸­ï¼Œæ¯ä¸ªè¡¨ä¸­åªåŒ…å«ä¸€éƒ¨åˆ†æ•°æ®ï¼Œä»è€Œä½¿å¾—<strong>å•ä¸ªè¡¨çš„æ•°æ®é‡å˜å°ï¼Œè¾¾åˆ°åˆ†å¸ƒå¼çš„æ•ˆæœ</strong>ã€‚</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/007S8ZIlgy1gfsrmfqf5pj30u00xuwxs.jpg" alt=""></p><p>åº“å†…åˆ†è¡¨åªè§£å†³äº†å•ä¸€è¡¨æ•°æ®é‡è¿‡å¤§çš„é—®é¢˜ï¼Œä½†æ²¡æœ‰å°†è¡¨åˆ†å¸ƒåˆ°ä¸åŒæœºå™¨çš„åº“ä¸Š</p><h3 id="æ•°æ®åˆ†ç‰‡è§„åˆ™" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åˆ†ç‰‡è§„åˆ™" aria-hidden="true">#</a> æ•°æ®åˆ†ç‰‡è§„åˆ™</h3><ol><li>æ ¹æ®æ•°å€¼<strong>èŒƒå›´</strong>ï¼šæŒ‰ç…§æ—¶é—´åŒºé—´æˆ– ID åŒºé—´æ¥åˆ‡åˆ† <ul><li>æŒ‰æ—¥æœŸå°†ä¸åŒæœˆç”šè‡³æ˜¯æ—¥çš„æ•°æ®åˆ†æ•£åˆ°ä¸åŒçš„åº“ä¸­</li><li>å°† userId ä¸º 1~9999 çš„è®°å½•åˆ†åˆ°ç¬¬ä¸€ä¸ªåº“ï¼Œ10000~20000 çš„åˆ†åˆ°ç¬¬äºŒä¸ªåº“ï¼Œä»¥æ­¤ç±»æ¨</li><li>å•è¡¨å¤§å°å¯æ§ï¼Œæ¯ä¸ªè¡¨å­˜å‚¨çš„æ•°æ®é‡æœ‰å¤§è‡´åˆ’åˆ†</li><li>å¤©ç„¶ä¾¿äºæ°´å¹³æ‰©å±•ï¼ŒåæœŸå¦‚æœæƒ³å¯¹æ•´ä¸ªåˆ†ç‰‡é›†ç¾¤æ‰©å®¹æ—¶ï¼Œåªéœ€è¦æ·»åŠ èŠ‚ç‚¹å³å¯ï¼Œæ— éœ€å¯¹å…¶ä»–åˆ†ç‰‡çš„æ•°æ®è¿›è¡Œè¿ç§»*</li><li>ä½¿ç”¨åˆ†ç‰‡å­—æ®µè¿›è¡ŒèŒƒå›´æŸ¥æ‰¾æ—¶ï¼Œè¿ç»­åˆ†ç‰‡å¯<strong>å¿«é€Ÿå®šä½åˆ†ç‰‡</strong>è¿›è¡Œå¿«é€ŸæŸ¥è¯¢ï¼Œæœ‰æ•ˆé¿å…è·¨åˆ†ç‰‡æŸ¥è¯¢çš„é—®é¢˜</li></ul></li><li>æ ¹æ®æ•°å€¼<strong>å–æ¨¡</strong>ï¼šä¸€èˆ¬é‡‡ç”¨ hash å–æ¨¡ mod çš„åˆ‡åˆ†æ–¹å¼ <ul><li>å°† Customer è¡¨æ ¹æ® cusno å­—æ®µåˆ‡åˆ†åˆ° 4 ä¸ªåº“ä¸­ï¼Œä½™æ•°ä¸º 0 çš„æ”¾åˆ°ç¬¬ä¸€ä¸ªåº“ï¼Œä½™æ•°ä¸º 1 çš„æ”¾åˆ°ç¬¬äºŒä¸ªåº“ï¼Œä»¥æ­¤ç±»æ¨ã€‚</li><li>æ•°æ®åˆ†ç‰‡ç›¸å¯¹æ¯”è¾ƒå‡åŒ€ï¼Œä¸å®¹æ˜“å‡ºç°çƒ­ç‚¹å’Œå¹¶å‘è®¿é—®çš„ç“¶é¢ˆ</li><li>åæœŸåˆ†ç‰‡é›†ç¾¤æ‰©å®¹æ—¶ï¼Œéœ€è¦è¿ç§»æ—§çš„æ•°æ®(ä½¿ç”¨ä¸€è‡´æ€§ hash ç®—æ³•èƒ½è¾ƒå¥½çš„é¿å…è¿™ä¸ªé—®é¢˜)*</li><li>å®¹æ˜“é¢ä¸´è·¨åˆ†ç‰‡æŸ¥è¯¢çš„å¤æ‚é—®é¢˜ã€‚æ¯”å¦‚ä¸Šä¾‹ä¸­ï¼Œå¦‚æœé¢‘ç¹ç”¨åˆ°çš„æŸ¥<strong>è¯¢æ¡ä»¶ä¸­ä¸å¸¦</strong> cusno æ—¶ï¼Œå°†ä¼šå¯¼è‡´<strong>æ— æ³•å®šä½æ•°æ®åº“</strong>ï¼Œä»è€Œéœ€è¦åŒæ—¶å‘ 4 ä¸ªåº“å‘èµ·æŸ¥è¯¢ï¼Œå†åœ¨å†…å­˜ä¸­åˆå¹¶æ•°æ®ï¼Œå–æœ€å°é›†è¿”å›ç»™åº”ç”¨ï¼Œåˆ†åº“åè€Œæˆä¸ºæ‹–ç´¯ã€‚</li></ul></li></ol><h3 id="ä¼˜ç¼ºç‚¹-1" tabindex="-1"><a class="header-anchor" href="#ä¼˜ç¼ºç‚¹-1" aria-hidden="true">#</a> ä¼˜ç¼ºç‚¹</h3><ul><li>ä¼˜ç‚¹ï¼š <ul><li>ä¸å­˜åœ¨å•åº“æ•°æ®é‡è¿‡å¤§ã€é«˜å¹¶å‘çš„æ€§èƒ½ç“¶é¢ˆï¼Œæå‡ç³»ç»Ÿç¨³å®šæ€§å’Œè´Ÿè½½èƒ½åŠ›</li><li>åº”ç”¨ç«¯æ”¹é€ è¾ƒå°ï¼Œä¸éœ€è¦æ‹†åˆ†ä¸šåŠ¡æ¨¡å—</li></ul></li><li>ç¼ºç‚¹ <ul><li>è·¨åˆ†ç‰‡çš„äº‹åŠ¡ä¸€è‡´æ€§éš¾ä»¥ä¿è¯</li><li>è·¨åº“çš„ join å…³è”æŸ¥è¯¢æ€§èƒ½è¾ƒå·®</li><li>æ•°æ®å¤šæ¬¡æ‰©å±•éš¾åº¦å’Œç»´æŠ¤é‡æå¤§</li></ul></li></ul><h2 id="å¸¦æ¥çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#å¸¦æ¥çš„é—®é¢˜" aria-hidden="true">#</a> å¸¦æ¥çš„é—®é¢˜</h2><ul><li><p>è·¨èŠ‚ç‚¹å…³è”æŸ¥è¯¢joiné—®é¢˜</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>1.å…¨å±€è¡¨ã€‚ç³»ç»Ÿä¸­æ‰€æœ‰æ¨¡å—éƒ½å¯èƒ½ä¾èµ–çš„ä¸€äº›è¡¨ï¼Œå°†è¿™ç±»è¡¨åœ¨æ¯ä¸ªæ•°æ®åº“ä¸­éƒ½ä¿å­˜ä¸€ä»½ã€‚è¿™äº›æ•°æ®é€šå¸¸å¾ˆå°‘ä¼šè¿›è¡Œä¿®æ”¹ï¼Œæ‰€ä»¥ä¹Ÿä¸æ‹…å¿ƒä¸€è‡´æ€§çš„é—®é¢˜ã€‚
2.å­—æ®µå†—ä½™ã€‚ç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œå¦‚ä¿å­˜idçš„æ—¶å€™é¡ºä¾¿ä¿å­˜nameï¼Œè¿™æ ·ä¸éœ€è¦æ¯æ¬¡æŸ¥è¯¢éƒ½è¦é¢å¤–æŸ¥è¯¢ä¸€æ¬¡idæ‰€å¯¹åº”çš„nameï¼›å±€é™ï¼šæ”¹å
3.è€ƒè™‘ERåˆ†ç‰‡ã€‚å¦‚æœåˆ†ç‰‡ä¹‹å‰å¯ä»¥å…ˆç¡®å®šè¡¨ä¸è¡¨ä¹‹é—´çš„å…³ç³»ï¼Œå¹¶å°†é‚£äº›å…·æœ‰å…³è”å…³ç³»çš„è¡¨è®°å½•å­˜æ”¾åˆ°åŒä¸€ä¸ªåˆ†ç‰‡ä¸Š
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>è·¨èŠ‚ç‚¹åˆ†é¡µã€æ’åºã€å‡½æ•°é—®é¢˜</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>å¦‚æœéœ€è¦è¿›è¡Œæ’åºæˆ–ç»Ÿè®¡æ•°é‡ç­‰é—®é¢˜ï¼Œå½“æ’åºå­—æ®µå°±æ˜¯åˆ†ç‰‡å­—æ®µæ—¶ï¼Œé€šè¿‡åˆ†ç‰‡è§„åˆ™å°±æ¯”è¾ƒå®¹æ˜“å®šä½åˆ°æŒ‡å®šçš„åˆ†ç‰‡ï¼›å½“æ’åºå­—æ®µéåˆ†ç‰‡å­—æ®µæ—¶ï¼Œå°±å˜å¾—æ¯”è¾ƒå¤æ‚äº†ï¼Œéœ€è¦åœ¨ä¸åŒçš„åˆ†ç‰‡èŠ‚ç‚¹ä¸­å°†æ•°æ®è¿›è¡Œæ’åºå¹¶è¿”å›ï¼Œç„¶åå°†ä¸åŒåˆ†ç‰‡è¿”å›çš„ç»“æœé›†è¿›è¡Œæ±‡æ€»å’Œå†æ¬¡æ’åºï¼Œæœ€ç»ˆè¿”å›ç»™ç”¨æˆ·
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>å…¨å±€ä¸»é”®å”¯ä¸€æ€§é—®é¢˜</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>åˆ†åº“åä¸å…è®¸ä½¿ç”¨ä¸»é”®è‡ªå¢ã€‚å¯ä»¥é‡‡ç”¨UUID
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>æ•°æ®è¿ç§»ã€æ‰©å®¹é—®é¢˜</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>åœ¨ä¸åŒçš„åˆ†ç‰‡èŠ‚ç‚¹ä¸­å°†æ•°æ®è¿›è¡Œæ’åºå¹¶è¿”å›ï¼Œç„¶åå°†ä¸åŒåˆ†ç‰‡è¿”å›çš„ç»“æœé›†è¿›è¡Œæ±‡æ€»å’Œå†æ¬¡æ’åºï¼Œæœ€ç»ˆè¿”å›ç»™ç”¨æˆ·
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul><h2 id="åˆ‡åˆ†åœºæ™¯" tabindex="-1"><a class="header-anchor" href="#åˆ‡åˆ†åœºæ™¯" aria-hidden="true">#</a> åˆ‡åˆ†åœºæ™¯</h2><ul><li><p>èƒ½ä¸åˆ‡åˆ†å°±ä¸åˆ‡åˆ†</p><ul><li>ä¾‹å¦‚ï¼šå‡çº§ç¡¬ä»¶ã€å‡çº§ç½‘ç»œã€è¯»å†™åˆ†ç¦»ã€ç´¢å¼•ä¼˜åŒ–ç­‰ç­‰ã€‚å½“æ•°æ®é‡è¾¾åˆ°å•è¡¨çš„ç“¶é¢ˆæ—¶å€™ï¼Œå†è€ƒè™‘åˆ†åº“åˆ†è¡¨ã€‚</li></ul></li><li><p>æ•°æ®é‡è¿‡å¤§ï¼Œæ­£å¸¸è¿ç»´å½±å“ä¸šåŠ¡è®¿é—®</p><ul><li>æ•°æ®åº“å¤‡ä»½ï¼Œå•è¡¨å¤ªå¤§ï¼Œå¤‡ä»½éœ€è¦å¤§é‡ç£ç›˜IOå’Œç½‘ç»œIO</li><li>å¯¹å¤§è¡¨è¿›è¡ŒDDLï¼ŒMySQLé”ä½å…¨è¡¨ï¼Œæ—¶é—´é•¿ï¼ŒæœŸé—´ä¸šåŠ¡æ— æ³•è¿›è¡Œ</li></ul></li><li><p>éšç€ä¸šåŠ¡å‘å±•ï¼Œéœ€è¦å¯¹æŸäº›å­—æ®µå‚ç›´æ‹†åˆ†</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ä¸€å¼ è¡¨100ä¸ªå­—æ®µï¼Œå…¶ä¸­99ä¸ªå­—æ®µä¸éœ€è¦ç»å¸¸æ”¹åŠ¨ï¼Œå‰©ä¸‹çš„1ä¸ªæ˜¯ç»å¸¸ä¿®æ”¹çš„ã€‚å¦‚ï¼šç”¨æˆ·è¡¨çš„æœ€åç™»é™†æ—¶é—´ï¼Œè¿™æ—¶å€™å¯ä»¥è€ƒè™‘æŠŠä¸»é”®å’Œéœ€è¦ç»å¸¸ä¿®æ”¹çš„å­—æ®µåˆ†ç¦»å‡ºå»æˆä¸ºä¸€å¼ ç‹¬ç«‹è¡¨
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>æ•°æ®é‡å¿«é€Ÿå¢é•¿</p><ul><li>å•è¡¨æ€§èƒ½æ¥è¿‘ç“¶é¢ˆï¼Œéœ€è¦è€ƒè™‘æ°´å¹³åˆ‡åˆ†</li></ul></li><li><p>å®‰å…¨æ€§å’Œå¯ç”¨æ€§</p><ul><li>ä¸èƒ½ç‰µæ¶‰åˆ°å…¶ä»–ä¸šåŠ¡</li></ul></li></ul><h2 id="æ¡ˆä¾‹" tabindex="-1"><a class="header-anchor" href="#æ¡ˆä¾‹" aria-hidden="true">#</a> æ¡ˆä¾‹</h2><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>ç”¨æˆ·ä¸­å¿ƒ
è¡¨ï¼šUser(uid, login_name, passwd, sex, age, nickname)

ç”¨æˆ·ä¾§ï¼š
	
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h1 id="æ€§èƒ½å‰–æ" tabindex="-1"><a class="header-anchor" href="#æ€§èƒ½å‰–æ" aria-hidden="true">#</a> æ€§èƒ½å‰–æ</h1><h2 id="å‰–æmysqlæŸ¥è¯¢" tabindex="-1"><a class="header-anchor" href="#å‰–æmysqlæŸ¥è¯¢" aria-hidden="true">#</a> å‰–æMySQLæŸ¥è¯¢</h2><p>å®šä¹‰æ€§èƒ½æœ€æœ‰æ•ˆçš„æ–¹æ³•å°±æ˜¯å“åº”æ—¶é—´</p><p>æ‰¾æ¸…æ¥šé—®é¢˜åœ¨å“ªé‡Œ</p><h3 id="å‰–ææœåŠ¡å™¨è´Ÿè½½" tabindex="-1"><a class="header-anchor" href="#å‰–ææœåŠ¡å™¨è´Ÿè½½" aria-hidden="true">#</a> å‰–ææœåŠ¡å™¨è´Ÿè½½</h3><p>å®šä½å’ŒæŸ¥è¯¢â€œåâ€æŸ¥è¯¢èƒ½å¤Ÿæ˜¾è‘—æå‡åº”ç”¨çš„æ€§èƒ½ï¼›å¯ä»¥åŠæ—¶å‘ç°å’Œå®šä½ç³Ÿç³•çš„ç”¨æˆ·ä½“éªŒï¼›é™ä½æœåŠ¡å™¨çš„å‹åŠ›ï¼Œæ¨è¿Ÿæˆ–é¿å…äº†æœåŠ¡å™¨æ˜‚è´µçš„å‡çº§éœ€æ±‚ï¼›</p><h4 id="æ•è·mysqlçš„æŸ¥è¯¢åˆ°æ—¥å¿—æ–‡ä»¶ä¸­" tabindex="-1"><a class="header-anchor" href="#æ•è·mysqlçš„æŸ¥è¯¢åˆ°æ—¥å¿—æ–‡ä»¶ä¸­" aria-hidden="true">#</a> æ•è·MySQLçš„æŸ¥è¯¢åˆ°æ—¥å¿—æ–‡ä»¶ä¸­</h4><ul><li>å¯ä»¥é€šè¿‡è®¾ç½®<code>long_query_time</code>ä¸º0æ¥æ•è·æ‰€æœ‰çš„æŸ¥è¯¢</li><li>æ…¢æŸ¥è¯¢å¸¦æ¥çš„IOå¼€é”€å¯ä»¥å¿½ç•¥ä¸è®¡</li></ul><h3 id="å‰–æå•æ¡è®°å½•" tabindex="-1"><a class="header-anchor" href="#å‰–æå•æ¡è®°å½•" aria-hidden="true">#</a> å‰–æå•æ¡è®°å½•</h3><h4 id="ä½¿ç”¨show-profile" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨show-profile" aria-hidden="true">#</a> ä½¿ç”¨show profile</h4><ul><li>ä½¿ç”¨<code>set profiling = 1</code>ååœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„æ‰€æœ‰è¯­å¥ï¼Œéƒ½ä¼šæµ‹é‡å…¶è€—è´¹çš„æ—¶é—´</li><li>ä½¿ç”¨<code>show profiles</code>ï¼Œå®ƒä¼šåˆ—å‡ºä¹‹å‰æ‰€æœ‰çš„è¯­å¥çš„IDã€æ€»æ—¶é•¿ã€å¯¹åº”çš„è¯­å¥</li><li>ä½¿ç”¨<code>show profile for query Id</code> å¯ä»¥æŸ¥è¯¢åˆ°ç‰¹åœ°çš„è¯­å¥æŸ¥è¯¢æ‰§è¡Œçš„<strong>æ¯ä¸ªæ­¥éª¤åŠå…¶èŠ±è´¹çš„æ—¶é—´</strong></li><li>ä¸€èˆ¬ä¸å»ºè®®åœ¨<strong>ä¼˜åŒ–æ’åºç¼“å†²åŒº</strong>çš„æ–¹é¢ä¼˜åŒ–</li><li><strong>å‰–ææŠ¥å‘Šèƒ½å¸®åŠ©æˆ‘ä»¬å®šä½åˆ°æ¯ä¸ªæ´»åŠ¨èŠ±è´¹çš„æ—¶é—´ï¼Œä½†æ˜¯å¹¶ä¸ä¼šå‘Šè¯‰åŸå› </strong></li></ul><h4 id="ä½¿ç”¨show-status" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨show-status" aria-hidden="true">#</a> ä½¿ç”¨show status</h4><ul><li>ä½¿ç”¨<code>show global status</code>å¯ä»¥æŸ¥çœ‹<strong>æœåŠ¡å™¨çº§åˆ«çš„</strong>ä»æœåŠ¡å™¨å¯åŠ¨æ—¶å¼€å§‹è®¡ç®—çš„æŸ¥è¯¢æ¬¡æ•°ç»Ÿè®¡</li><li>æ³¨æ„åŒºåˆ†åˆ—å‡ºçš„å˜é‡æ˜¯å…¨å±€çº§åˆ«è¿˜æ˜¯ä¼šè¯çº§åˆ«</li><li><code>Handler_read_rnd_next</code>æ²¡æœ‰ç”¨åˆ°ç´¢å¼•çš„è¯»æ“ä½œ</li><li>ä½¿ç”¨<code>explain</code>ä¹Ÿå¯ä»¥å¾—åˆ°å¤§è‡´ç›¸åŒçš„ç»“æœï¼Œä½†æ˜¯explainæ˜¯é€šè¿‡ä¼°è®¡çš„ï¼Œshow statusæ˜¯é€šè¿‡æµ‹é‡çš„ï¼Œç»“æœæ›´åŠ ç²¾å‡†ï¼Œå®ƒæ— æ³•å‘ŠçŸ¥ä¸´æ—¶è¡¨æ˜¯ç£ç›˜è¡¨è¿˜æ˜¯å†…å­˜ä¸´æ—¶è¡¨ç­‰ã€‚</li></ul><h4 id="ä½¿ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—" aria-hidden="true">#</a> ä½¿ç”¨æ…¢æŸ¥è¯¢æ—¥å¿—</h4><h1 id="schemaä¸æ•°æ®ç±»å‹ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#schemaä¸æ•°æ®ç±»å‹ä¼˜åŒ–" aria-hidden="true">#</a> Schemaä¸æ•°æ®ç±»å‹ä¼˜åŒ–</h1><h2 id="é€‰æ‹©ä¼˜åŒ–çš„æ•°æ®ç±»å‹" tabindex="-1"><a class="header-anchor" href="#é€‰æ‹©ä¼˜åŒ–çš„æ•°æ®ç±»å‹" aria-hidden="true">#</a> é€‰æ‹©ä¼˜åŒ–çš„æ•°æ®ç±»å‹</h2><ul><li><strong>æ›´å°</strong>çš„é€šå¸¸æ›´å¥½ï¼šé€‰æ‹©å¯ä»¥æ­£ç¡®å­˜å‚¨çš„æœ€å°æ•°æ®ç±»å‹ï¼Œæ›´å°çš„é€šå¸¸æ›´å¿«ï¼Œå ç”¨æ›´å°‘CPUå’Œç£ç›˜å’Œå†…å­˜</li><li><strong>ç®€å•</strong>å°±å¥½ï¼šç®€å•çš„æ•°æ®ç±»å‹çš„æ“ä½œé€šå¸¸<strong>éœ€è¦æ›´å°‘çš„CPUå‘¨æœŸ</strong>ã€‚å› ä¸ºå­—ç¬¦é›†å’Œæ’åºè§„åˆ™ä½¿å¾—å­—ç¬¦æ¯”æ•´å‹æ›´åŠ å¤æ‚</li><li>å°½é‡<strong>é¿å…NULL</strong>ï¼šå°½é‡æŒ‡å®šä¸ºNOT NULLï¼Œé™¤éçœŸçš„éœ€è¦NULLã€‚å› ä¸ºNULLä½¿å¾—ç´¢å¼•ã€ç´¢å¼•ç»Ÿè®¡å’Œå€¼æ¯”è¾ƒéƒ½æ¯”è¾ƒå¤æ‚ã€‚å¯ä¸ºNULLçš„åˆ—ä¼šä½¿ç”¨æ›´å¤šçš„å­˜å‚¨ç©ºé—´ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†ï¼›å¯ä¸ºNULLçš„åˆ—è¢«ç´¢å¼•æ—¶ï¼Œæ¯ä¸ªç´¢å¼•è®°å½•éœ€è¦ä¸€ä¸ªé¢å¤–çš„å­—èŠ‚ã€‚æ‰€ä»¥å»ºç´¢å¼•åº”é¿å…å¯ä¸ºNULLçš„åˆ—</li></ul><h1 id="æ€§èƒ½ä¼˜åŒ–" tabindex="-1"><a class="header-anchor" href="#æ€§èƒ½ä¼˜åŒ–" aria-hidden="true">#</a> æ€§èƒ½ä¼˜åŒ–</h1><h2 id="å…·ä½“åšæ³•" tabindex="-1"><a class="header-anchor" href="#å…·ä½“åšæ³•" aria-hidden="true">#</a> å…·ä½“åšæ³•</h2><ol><li>æŸ¥è¯¢æ—¶å¦‚æœå·²çŸ¥ä¼šå¾—åˆ°ä¸€æ¡æ•°æ®ï¼Œè¿™ç§æƒ…å†µä¸‹åŠ ä¸Š<code> limit 1</code> ä¼šå¢åŠ æ€§èƒ½ã€‚<strong>å› ä¸º mysql æ•°æ®åº“å¼•æ“ä¼šåœ¨æ‰¾åˆ°ä¸€æ¡ç»“æœåœæ­¢æœç´¢</strong>ï¼Œè€Œä¸æ˜¯ç»§ç»­æŸ¥è¯¢ä¸‹ä¸€æ¡æ˜¯å¦ç¬¦åˆæ ‡å‡†ç›´åˆ°æ‰€æœ‰è®°å½•æŸ¥è¯¢å®Œæ¯•</li><li>ç”¨ <code>not exists</code> ä»£æ›¿ <code>not in</code>ã€‚<code>not exists</code> ç”¨åˆ°äº†è¿æ¥èƒ½å¤Ÿå‘æŒ¥å·²ç»å»ºç«‹å¥½çš„ç´¢å¼•çš„ä½œç”¨ï¼Œ<code>not in</code> ä¸èƒ½ä½¿ç”¨ç´¢å¼•ã€‚<strong><code>not in </code>æ˜¯æœ€æ…¢çš„æ–¹å¼ï¼Œè¦åŒæ¯æ¡è®°å½•æ¯”è¾ƒ</strong>ï¼Œåœ¨æ•°æ®é‡æ¯”è¾ƒå¤§çš„æ“ä½œä¸­ä¸å»ºè®®ä½¿ç”¨è¿™ç§æ–¹å¼ã€‚</li><li>å¯¹äºå¤šå¼ å¤§æ•°æ®é‡(è¿™é‡Œå‡ ç™¾æ¡å°±ç®—å¤§äº†)çš„è¡¨ JOINï¼Œ<strong>è¦å…ˆåˆ†é¡µå† JOIN</strong>ï¼Œå¦åˆ™é€»è¾‘è¯»ä¼šå¾ˆé«˜ï¼Œæ€§èƒ½å¾ˆå·®</li><li>æŸ¥è¯¢æ—¶existsé€‚ç”¨äºbè¡¨(åœ¨existsæˆ–è€…inä¸­å‡ºç°çš„)æ¯”Aè¡¨å¤§çš„æƒ…å†µï¼Œåä¹‹é€‚ç”¨in</li><li>æ‰‹æœºå·ç å­˜å‚¨ç”¨<code>BIGINT</code>ã€‚å› ä¸ºCHARæˆ–è€…VARCHARï¼Œå ç”¨ç©ºé—´å¤§ï¼Œå½±å“æŸ¥è¯¢æ€§èƒ½ã€‚11ä½æ‰‹æœºå·CHARå­˜å‚¨ï¼Œ<strong>utf8ç¼–ç ï¼Œåˆ™å ç”¨33ä¸ªå­—èŠ‚</strong>ï¼›ä½¿ç”¨å¦‚æœä½¿ç”¨INTçš„è¯ï¼Œ<strong>INTæœ€å¤§åªèƒ½ä¿å­˜10ä¸ºæ•°æ®</strong>ï¼Œè€Œæ‰‹æœºå·ä¸º11ä½ï¼Œä¼šå‡ºç°æº¢å‡ºï¼Œæ‰€ä»¥ä½¿ç”¨<strong>BIGINTå ç”¨8ä¸ªå­—èŠ‚ï¼Œæ”¯æŒ11ä½æ•°æ®å­˜å‚¨</strong>ã€‚</li><li>IPåœ°å€å­˜å‚¨ç”¨æ— ç¬¦å·<code>INT</code>ã€‚<code>INET_ATON()</code>è´Ÿè´£æŠŠIPè½¬æˆæ•°å­—ï¼›<code>INET_NTOA()</code>è´Ÿè´£æŠŠæ•°å­—è½¬ä¸ºIPï¼Œç”¨æ— ç¬¦å·INTæ˜¯ä¸ºäº†é˜²æ­¢æ•°æ®æº¢å‡º</li></ol><h2 id="ç´¢å¼•é¿é›·" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•é¿é›·" aria-hidden="true">#</a> ç´¢å¼•é¿é›·</h2><ol><li><p>ä¸æ»¡è¶³æœ€å·¦ç´¢å¼•åŒ¹é…åŸåˆ™</p></li><li><p>å¦‚æœä½¿ç”¨ <code>select *</code> ä½†æ˜¯æ²¡æœ‰æœ‰æ•ˆå‘½ä¸­ç»„åˆç´¢å¼•ï¼Œå°½é‡ä½¿å¾—æŸ¥è¯¢çš„åˆ—å‘½ä¸­ç»„åˆç´¢å¼•è®©æŸ¥è¯¢èµ° <code>å…¨ç´¢å¼•æ‰«æ</code> ï¼Œæ¯” <code>å…¨è¡¨æ‰«æ</code> è¦å¿«ï¼ŒåŸç†æ˜¯ <code>ç´¢å¼•è¦†ç›–</code></p></li><li><p>æŸ¥è¯¢è¯­å¥ä¸­ç´¢å¼•åˆ—ä½¿ç”¨äº†å‡½æ•°ã€è¿›è¡Œäº†è¿ç®—ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆ</p></li><li><p>æ•°æ®ç±»å‹å‡ºç°éšå¼è½¬åŒ–(å¦‚varcharä¸åŠ å•å¼•å·çš„è¯å¯èƒ½ä¼šè‡ªåŠ¨è½¬æ¢ä¸ºintå‹)ï¼Œç±»å‹ä¸ä¸€è‡´å¯¼è‡´ç´¢å¼•å¤±æ•ˆ</p></li><li><p>likeçš„æ¡ä»¶å·¦è¾¹åŒ…å« <code>%</code> å¯¼è‡´ç´¢å¼•å¤±æ•ˆ</p></li><li><p>where è¯­å¥ä¸­ä¸¤ä¸ªç´¢å¼•åˆ—è¿›è¡Œæ¯”è¾ƒå¯¼è‡´ç´¢å¼•å¤±æ•ˆ</p></li><li><p>OR è¯­å¥å‰åæ¡ä»¶æ²¡æœ‰åŒæ—¶ä½¿ç”¨ç´¢å¼•å¯¼è‡´ç´¢å¼•å¤±æ•ˆ</p></li><li><p><code>not in</code> ã€<code>not exist</code> æ¡ä»¶å¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼Œ<code>not in</code> <strong>ä¸ä¼šè®©ä¸»é”®ç´¢å¼•å¤±æ•ˆ</strong></p></li><li><p><code>order by</code> çš„æƒ…å†µï¼Œwhere å’Œ limit å¿…é¡»è‡³å°‘è¦æœ‰ä¸€ä¸ª</p><ol><li><p>ä¸ä½¿ç”¨ where ï¼Œä½†æ˜¯ä½¿ç”¨ limit ï¼Œorder by åé¢çš„æ¡ä»¶éµå¾ªè”åˆç´¢å¼•çš„æœ€å·¦åŒ¹é…åŸåˆ™èƒ½å‘½ä¸­ç´¢å¼•</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>explain select * from user
order by code,age,name
limit 100;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ä½¿ç”¨ where ï¼Œä¸ä½¿ç”¨ limitï¼Œorder by å¯ä»¥å’Œ where ä¸€èµ·éµå¾ªæœ€å·¦åŒ¹é…åŸåˆ™ï¼›å¦‚æœåŒ¹é…æ–­å±‚çš„è¯ï¼ˆæ¯”å¦‚å‘½ä¸­ç¬¬ä¸€ç¬¬ä¸‰ä¸ªç´¢å¼•ï¼‰ï¼Œè¿˜æ˜¯èƒ½å‘½ä¸­ç´¢å¼•ï¼Œä½†æ˜¯éœ€è¦å†åšä¸€æ¬¡ <code>filesort</code> æ’åº</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>explain select * from user
where code=&#39;101&#39;
order by name;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>order by å¤šä¸ªæ¡ä»¶éœ€è¦ä¿æŒç›¸åŒçš„æ’åºæ‰å¯ä»¥å‘½ä¸­ç´¢å¼•</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>explain select * from user
order by code desc,age desc
limit 100;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ä¸å¯ä»¥å¯¹ä¸åŒçš„ç´¢å¼•è¿›è¡Œæ’åºï¼Œä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆï¼Œè¿›è¡Œå…¨è¡¨æ‰«æ</p><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>explain select * from user
order by code, height
limit 100;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol></li></ol><h1 id="mysqlæ‰§è¡Œæµç¨‹ä¸æ¶æ„" tabindex="-1"><a class="header-anchor" href="#mysqlæ‰§è¡Œæµç¨‹ä¸æ¶æ„" aria-hidden="true">#</a> MySQLæ‰§è¡Œæµç¨‹ä¸æ¶æ„</h1><h2 id="ä¸€æ¡æŸ¥è¯¢è¯­å¥æ‰§è¡Œçš„æµç¨‹" tabindex="-1"><a class="header-anchor" href="#ä¸€æ¡æŸ¥è¯¢è¯­å¥æ‰§è¡Œçš„æµç¨‹" aria-hidden="true">#</a> ä¸€æ¡æŸ¥è¯¢è¯­å¥æ‰§è¡Œçš„æµç¨‹</h2><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20200913145650.png" alt=""></p><h3 id="å®¢æˆ·ç«¯-client" tabindex="-1"><a class="header-anchor" href="#å®¢æˆ·ç«¯-client" aria-hidden="true">#</a> å®¢æˆ·ç«¯(Client)</h3><p>è¿æ¥æ•°æ®åº“æ–¹å¼ï¼š</p><h4 id="åŒæ­¥æˆ–å¼‚æ­¥" tabindex="-1"><a class="header-anchor" href="#åŒæ­¥æˆ–å¼‚æ­¥" aria-hidden="true">#</a> åŒæ­¥æˆ–å¼‚æ­¥</h4><ul><li>åŒæ­¥ï¼š<strong>å¤§éƒ¨åˆ†æ—¶é—´ä½¿ç”¨</strong>ã€‚</li><li>å¼‚æ­¥ï¼š <ul><li>å®¢æˆ·ç«¯å¼‚æ­¥è¿æ¥æœåŠ¡ç«¯ï¼Œ å¹¶ä¸èƒ½å‡å°‘sqlæ‰§è¡Œæ—¶é—´ï¼Œåªæ˜¯èŠ‚çœäº†ç­‰å¾…æ—¶é—´ã€‚</li><li>å¦‚æœå¼‚æ­¥è¿æ¥æ•°æ®åº“å­˜åœ¨å¹¶å‘ï¼Œä¸èƒ½å…±ç”¨ä¸€ä¸ªè¿æ¥ï¼Œå¦åˆ™ä¼šé€ æˆæ•°æ®æ··ä¹±ã€‚ä¹Ÿå°±æ˜¯æ¯ä¸ªsqlæ‰§è¡Œçš„æ—¶å€™éƒ½è¦å»ºç«‹ä¸€ä¸ªå•ç‹¬çš„è¿æ¥ï¼Œä½†æ˜¯è¿™ç§åšæ³•ä¼šç»™æœåŠ¡ç«¯å¸¦æ¥å·¨å¤§çš„å‹åŠ›ï¼Œå› ä¸ºåœ¨æœåŠ¡ç«¯æ¥è¯´ï¼Œæ¯ä¸€ä¸ªè¿æ¥å°±æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹é—´çš„åˆ‡æ¢ä¼šå ç”¨CPUçš„èµ„æºã€‚</li><li>å¦å¤–å¼‚æ­¥é€šä¿¡å¯¹å¼€å‘äººå‘˜æ¥è¯´ï¼Œå¢åŠ å¼€å‘çš„å¤æ‚åº¦ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸å»ºè®®ä½¿ç”¨å¼‚æ­¥è¿æ¥</li></ul></li></ul><h4 id="è¿æ¥æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#è¿æ¥æ–¹å¼" aria-hidden="true">#</a> è¿æ¥æ–¹å¼</h4><ul><li>é•¿è¿æ¥ï¼šæŒç»­ä¿æŒè¿æ¥æ‰“å¼€ï¼Œå‡å°‘æœåŠ¡ç«¯é¢‘ç¹åœ°åˆ›å»ºå’Œé‡Šæ”¾è¿æ¥æ‰€é€ æˆçš„æ¶ˆè€—ï¼Œåç»­ç¨‹åºè¿˜å¯ä»¥ç»§ç»­ä½¿ç”¨è¿™ä¸ªè¿æ¥ã€‚ä½†æ˜¯é•¿æ—¶é—´è¿æ¥ä¸æ“ä½œä¹Ÿä¼šæ–­å¼€è¿æ¥ã€‚ <ul><li><strong>jdbcé»˜è®¤8å°æ—¶æ²¡æœ‰æ´»åŠ¨å°±æ–­å¼€</strong></li><li>éäº¤äº’å¼å®¢æˆ·ç«¯è¿æ¥(shell)ï¼š<code>show global variables like &quot;wait_timeout&quot;;</code></li><li>äº¤äº’å¼å®¢æˆ·ç«¯è¿æ¥(navicat)ï¼š<code>show global variables like &quot;interactive_timeout&quot;;</code></li><li>æŸ¥çœ‹è¿æ¥æ•°ï¼š<code>netstat -an|grep 3306|wc -l</code> æˆ– <code>show full processlist</code></li><li>é»˜è®¤æœ€å¤§è¿æ¥æ•°151ä¸ªï¼š<code>show global variables like &quot;max_connections&quot;;</code></li><li>ä¿®æ”¹æ–¹å¼ï¼šåŠ¨æ€ä¿®æ”¹ <code>set variables &quot;max_connnections = 1000&quot;</code>ï¼Œä¸€æ—¦å…³é—­å°±ä¼šåˆ·æ–°åˆ°ä»¥å‰çš„å€¼ï¼›ä¿®æ”¹é…ç½®æ–‡ä»¶ <code>/etc/my.cnf</code> æ°¸ä¹…ä¿®æ”¹</li></ul></li><li>çŸ­è¿æ¥ï¼šæ“ä½œå®Œæ¯•åï¼Œè¿æ¥é©¬ä¸Šå…³é—­ï¼Œé‡Šæ”¾èµ„æºã€‚</li></ul><h4 id="é€šä¿¡åè®®" tabindex="-1"><a class="header-anchor" href="#é€šä¿¡åè®®" aria-hidden="true">#</a> é€šä¿¡åè®®</h4><ul><li>TCP/IPï¼š <ul><li>é©±åŠ¨çš„jaråŒ…è¿æ¥æ•°æ®åº“</li></ul></li><li>Unix Socketï¼š <ul><li>æœ¬åœ°å‘½ä»¤è¡Œçš„è¿æ¥ï¼Œä¸èµ°ç½‘ç»œåè®®ã€‚ä½¿ç”¨ç‰©ç†æ–‡ä»¶</li></ul></li></ul><h4 id="é€šä¿¡æ–¹å¼" tabindex="-1"><a class="header-anchor" href="#é€šä¿¡æ–¹å¼" aria-hidden="true">#</a> é€šä¿¡æ–¹å¼</h4><ul><li>å•å·¥ ï¼šæ•°æ®å•å‘ä¼ è¾“ï¼šå¹¿æ’­ã€‚</li><li>åŠåŒå·¥ï¼šæ•°æ®åŒå‘ä¼ è¾“ï¼Œä½†æ˜¯ä¸èƒ½åŒæ—¶ä¼ è¾“ï¼šä¼ å‘¼æœºã€‚</li><li>å…¨åŒå·¥ï¼šæ•°æ®åŒå‘ä¼ è¾“ï¼Œå¯ä»¥åŒæ—¶ä¼ è¾“ï¼šæ‰‹æœºã€‚</li><li><strong>mysqlé‡‡ç”¨çš„æ˜¯åŠåŒå·¥é€šä¿¡æ–¹å¼</strong></li></ul><h3 id="æŸ¥è¯¢ç¼“å­˜-query-cache" tabindex="-1"><a class="header-anchor" href="#æŸ¥è¯¢ç¼“å­˜-query-cache" aria-hidden="true">#</a> æŸ¥è¯¢ç¼“å­˜(Query Cache)</h3><p>åº”ç”¨åœºæ™¯ï¼š</p><ol><li>æŸ¥è¯¢çš„sqlè¯­å¥å¿…é¡»æ˜¯<strong>ä¸€æ ·</strong>çš„</li><li>å¦‚æœupdateäº†è¡¨ä¸­æ•°æ®ï¼Œæ•´ä¸ªè¡¨æ‰€æœ‰æ•°æ®çš„ç¼“å­˜éƒ½è¢«æ¸…ç©º</li></ol><p>åº”ç”¨åœºæ™¯ç‹­éš˜ï¼Œ5.7ç‰ˆæœ¬é»˜è®¤å…³é—­ï¼Œ8.0ç‰ˆæœ¬åå¼ƒç”¨ã€‚ä½¿ç”¨ç‹¬ç«‹çš„ç¼“å­˜ï¼Œå¦‚ORMç­‰</p><h3 id="è§£æå™¨-parse" tabindex="-1"><a class="header-anchor" href="#è§£æå™¨-parse" aria-hidden="true">#</a> è§£æå™¨ (Parse)</h3><ul><li>è¯æ³•è§£æï¼šæŠŠè¯­å¥ä¸­å…³é”®è¯ã€è¡¨åã€å­—æ®µåç­‰å†…å®¹æ‹†åˆ†æˆä¸€ä¸ªä¸€ä¸ªå•è¯</li><li>è¯­æ³•è§£æï¼šæ£€æŸ¥sqlçš„è¯­æ³•ã€‚æ‹¬å·ã€å¼•å·æœ‰æ²¡æœ‰é—­åˆã€åˆ†å·ç­‰ã€‚</li><li>æœ€ç»ˆå¾—åˆ°çš„æ˜¯ä¸€é¢—<strong>è§£ææ ‘</strong><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20200913133105.png" alt=""></li><li>ç§°ä¸º<strong>ç¡¬è§£æ</strong></li></ul><h3 id="é¢„å¤„ç†å™¨-preprocessor" tabindex="-1"><a class="header-anchor" href="#é¢„å¤„ç†å™¨-preprocessor" aria-hidden="true">#</a> é¢„å¤„ç†å™¨(Preprocessor)</h3><ul><li>è¯­ä¹‰è§£æï¼šæ£€æŸ¥æ•°æ®åº“ã€è¡¨åã€å­—æ®µåæ˜¯å¦å­˜åœ¨ï¼Œæ˜¯å¦ç”¨åˆ°aliasï¼Œ<strong>ä¿è¯æ²¡æœ‰æ­§ä¹‰</strong>ã€‚å¾—åˆ°æ–°çš„è§£ææ ‘</li></ul><h3 id="æŸ¥è¯¢ä¼˜åŒ–å™¨-query-optimizer" tabindex="-1"><a class="header-anchor" href="#æŸ¥è¯¢ä¼˜åŒ–å™¨-query-optimizer" aria-hidden="true">#</a> æŸ¥è¯¢ä¼˜åŒ–å™¨(Query Optimizer)</h3><ul><li>ä¸€æ¡sqlè¯­å¥ä¸åªæœ‰ä¸€ç§æ‰§è¡Œæ–¹å¼ï¼Œæœ€ç»ˆæœ‰ç›¸åŒç»“æœï¼Œå­˜åœ¨<strong>å¼€é”€ä¸Šçš„å·®å¼‚</strong></li><li><code>åŸºäºcost(å¼€é”€)</code> çš„ä¼˜åŒ–å™¨ ï¼Œ<strong>ä¼šé€‰æ‹©ä¸€ç§å¼€é”€æœ€å°çš„æŸ¥è¯¢æ–¹å¼</strong></li><li>ä¼˜åŒ–åçš„ç»“æœæ˜¯<strong>æŸ¥è¯¢æ‰§è¡Œè®¡åˆ’</strong>ã€‚å¹¶ä¸ä¸€å®šæ˜¯æœ€ä¼˜çš„æ‰§è¡Œè®¡åˆ’</li><li>æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’ <code>explain</code> æŸ¥è¯¢è¯­å¥ <ul><li><code>possible_key</code>ä»£è¡¨å¯èƒ½ç”¨åˆ°çš„ç´¢å¼•</li><li><code>key</code>ä»£è¡¨å­˜å‚¨å¼•æ“è®¤ä¸ºå¾—åˆ°ç»“æœéœ€è¦æ‰«æçš„è¡Œæ•°(é¢„ä¼°)</li><li><code>rows</code>ä»£è¡¨æŸ¥è¯¢åˆ°ç»“æœéœ€è¦æ£€ç´¢å¤šå°‘è¡Œ</li><li><code>Extra</code><ul><li><code>Using index</code>ä»£è¡¨è¦†ç›–ç´¢å¼•ï¼Œä¸éœ€è¦å›è¡¨</li><li><code>Using where</code>ä»£è¡¨åœ¨Serverå±‚è¿›è¡Œäº†æ•°æ®è¿‡æ»¤ã€‚ç´¢å¼•çš„æ¯”è¾ƒå‘ç”Ÿåœ¨å­˜å‚¨å¼•æ“å±‚ï¼Œå¦‚æœç»“æœå¹¶ä¸æ»¡è¶³æŸ¥æ‰¾éœ€æ±‚ï¼Œé‚£ä¹ˆéœ€è¦ç«™åœ¨Serverå±‚è¿›è¡Œå†ä¸€æ­¥çš„è¿‡æ»¤</li><li><code>Using index condition</code>ä»£è¡¨ä½¿ç”¨äº†ç´¢å¼•ä¸‹æ¨</li></ul></li></ul></li></ul><h3 id="å­˜å‚¨å¼•æ“-store-engine" tabindex="-1"><a class="header-anchor" href="#å­˜å‚¨å¼•æ“-store-engine" aria-hidden="true">#</a> å­˜å‚¨å¼•æ“(Store Engine)</h3><p><strong>å­˜å‚¨å¼•æ“å¯ä»¥ç†è§£æˆè¡¨çš„ç±»å‹</strong>ï¼Œå¦‚ï¼šInnoDBã€MyISAMç­‰</p><p>mysql5.5ç‰ˆæœ¬åé»˜è®¤çš„å­˜å‚¨å¼•æ“æ˜¯InnoDB</p><ul><li>InnoDB <ul><li>æ”¯æŒäº‹åŠ¡</li><li>æ”¯æŒå¤–é”®</li><li>æ”¯æŒè¡Œçº§åˆ«çš„é”å’Œè¡¨çº§åˆ«çš„é”</li><li>æ”¯æŒè¯»ã€å†™çš„å¹¶å‘æ“ä½œ</li><li>æœ‰ç‰¹æ®Šçš„ç´¢å¼•å­˜æ”¾æ–¹å¼ï¼Œå‡å°‘æœåŠ¡ç«¯å’Œç£ç›˜çš„IOæ¬¡æ•°ï¼Œæå‡æ•ˆç‡</li></ul></li><li>MyISAM <ul><li>ä¸æ”¯æŒäº‹åŠ¡</li><li>æ‹¥æœ‰æ¯”è¾ƒé«˜çš„æ’å…¥å’ŒæŸ¥è¯¢çš„é€Ÿåº¦</li><li>æ”¯æŒè¡¨çº§åˆ«çš„é”ï¼Œæ›´æ–°æ•°æ®æ—¶ä¼šé”è¡¨</li><li>ä¼šå­˜å‚¨è¡¨ä¸­æ•°æ®çš„è¡Œæ•°ï¼Œæ‰€ä»¥æ‰§è¡Œ<code>count</code>çš„é€Ÿåº¦å¾ˆå¿«ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(1)</li></ul></li><li>Memory <ul><li>æŠŠæ‰€æœ‰æ•°æ®åªå­˜å‚¨åˆ°å†…å­˜é‡Œé¢ï¼Œæ“ä½œæ•°æ®æ•ˆç‡éå¸¸é«˜</li><li>æ•°æ®åº“ä¸€æ—¦é‡å¯/å´©æºƒï¼Œæ•°æ®ä¼šä¸¢å¤±</li><li>é€šå¸¸ä½œä¸ºä¸´æ—¶çš„å­˜å‚¨(ä¸´æ—¶è¡¨)</li></ul></li><li>CSV <ul><li>é€—å·åˆ†éš”ï¼Œä¸å…è®¸ç©ºè¡Œï¼Œæ˜“äºç¼–è¾‘</li><li>ä¸€èˆ¬ç”¨äºå¯¼å…¥å¯¼å‡ºæ•°æ®</li></ul></li><li>Archive <ul><li>ç´§å‡‘ã€æ²¡æœ‰ç´¢å¼•</li><li>ä¸€èˆ¬ç”¨äºæ£€ç´¢å¤§é‡çš„å†å²æ•°æ®/ä¸ä¼šå‘ç”Ÿå˜åŠ¨çš„æ•°æ®</li></ul></li></ul><p>æŸ¥çœ‹æ•°æ®åº“ä¸­è¡¨çš„å­˜å‚¨å¼•æ“ <code>show table status from æ•°æ®åº“å;</code></p><h3 id="æ‰§è¡Œå¼•æ“" tabindex="-1"><a class="header-anchor" href="#æ‰§è¡Œå¼•æ“" aria-hidden="true">#</a> æ‰§è¡Œå¼•æ“</h3><ul><li>åˆ©ç”¨å­˜å‚¨å¼•æ“æä¾›çš„APIæ¥æŠŠæŸ¥è¯¢ä¼˜åŒ–å™¨å¾—åˆ°çš„æ‰§è¡Œè®¡åˆ’æ¥æ“ä½œå­˜å‚¨å¼•æ“</li><li>ä»å­˜å‚¨å¼•æ“ä¸­æ‹¿åˆ°ç»“æœåä¼šè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œå¦‚æœæœ‰å¼€å¯æŸ¥è¯¢ç¼“å­˜ï¼Œé‚£ä¹ˆä¹Ÿæ›´æ–°åˆ°ç¼“å­˜ä¸­</li></ul><h3 id="æè¿°ä¸€æ¡æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œæµç¨‹" tabindex="-1"><a class="header-anchor" href="#æè¿°ä¸€æ¡æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œæµç¨‹" aria-hidden="true">#</a> æè¿°ä¸€æ¡æŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œæµç¨‹</h3><ol><li>å®¢æˆ·ç«¯è¿æ¥MySQLæœåŠ¡ç«¯ï¼Œæäº¤æŸ¥è¯¢è¯­å¥</li><li>æœåŠ¡ç«¯é¦–å…ˆæ£€æŸ¥æŸ¥è¯¢ç¼“å­˜æ˜¯å¦å­˜åœ¨å¯¹åº”ç»“æœï¼Œå¦‚æœæœ‰åˆ™ç›´æ¥è¿”å›ï¼›å¦‚æœæ²¡æœ‰åˆ™æŠŠæŸ¥è¯¢è¯­å¥äº¤ç»™è§£æå™¨</li><li>è§£æå™¨ä¼šæŒ‰å…³é”®å­—ã€è¡¨åç­‰æ‹†åˆ†æŸ¥è¯¢è¯­å¥ï¼Œå¹¶æ£€æŸ¥è¯­æ³•ï¼Œç”Ÿæˆä¸€é¢—è§£ææ ‘åäº¤ç»™é¢„å¤„ç†å™¨</li><li>é¢„å¤„ç†å™¨è´Ÿè´£æ£€æŸ¥è¯­å¥æ˜¯å¦å­˜åœ¨æ­§ä¹‰ï¼šæ˜¯å¦æœ‰ä¸å­˜åœ¨çš„è¡¨ã€å­—æ®µç­‰ï¼Œä¹‹åäº¤ç»™æŸ¥è¯¢ä¼˜åŒ–å™¨</li><li>æŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šæ ¹æ®è¿™ä¸ªæŸ¥è¯¢è¯­å¥çš„å„ç§æ‰§è¡Œæ–¹å¼çš„å¼€é”€ï¼Œé€‰æ‹©ä¸€ç§æœ€ä½å¼€é”€çš„æ–¹å¼ï¼Œå¾—åˆ°ä¸€ä¸ªæ‰§è¡Œè®¡åˆ’</li><li>æ‰§è¡Œå¼•æ“ç”¨è¿™ä¸ªæ‰§è¡Œè®¡åˆ’å»è°ƒç”¨å­˜å‚¨å¼•æ“æä¾›çš„æ¥å£å¾—åˆ°æ•°æ®</li><li>è¿”å›æ•°æ®ç»™å®¢æˆ·ç«¯ï¼Œå¦‚æœæ•°æ®åº“å¼€å¯äº†æŸ¥è¯¢ç¼“å­˜ï¼Œåˆ™ä¹Ÿæ›´æ–°åˆ°æŸ¥è¯¢ç¼“å­˜ä¸­</li></ol><h2 id="mysqlä½“ç³»æ¶æ„" tabindex="-1"><a class="header-anchor" href="#mysqlä½“ç³»æ¶æ„" aria-hidden="true">#</a> MySQLä½“ç³»æ¶æ„</h2><p>ç†è§£ç‰ˆ</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20200913141853.png" alt=""></p><p>æœåŠ¡å±‚ä¸­æœ‰ä¸€ä¸ªæ—¥å¿—ï¼šbinlogï¼Œ<strong>é»˜è®¤ä¸å¼€å¯</strong></p><ul><li>è®°å½•DDLã€DMLè¯­å¥ï¼Œå±äºé€»è¾‘æ—¥å¿—</li><li>æ²¡æœ‰å¤§å°é™åˆ¶ï¼Œå†…å®¹å¯ä»¥è¿½åŠ </li><li>å¯ä»¥è¢«æ‰€æœ‰å­˜å‚¨å¼•æ“ä½¿ç”¨</li><li>å¯ä»¥ç”¨äºæ•°æ®æ¢å¤å’Œä¸»ä»å¤åˆ¶</li></ul><h3 id="innodbå­˜å‚¨ç»“æ„" tabindex="-1"><a class="header-anchor" href="#innodbå­˜å‚¨ç»“æ„" aria-hidden="true">#</a> InnoDBå­˜å‚¨ç»“æ„</h3><ul><li>InnoDB ä¸­å—çš„æ¦‚å¿µå…¶å®å°±æ˜¯é¡µ</li><li>InnoDB ä¸­ç°‡çš„æ¦‚å¿µå…¶å®å°±æ˜¯åŒº</li><li>1é¡µçš„å¤§å°æ˜¯16KB</li><li>é¡µæ˜¯ InnoDB åšç£ç›˜ç®¡ç†æœ€å°çš„å•ä½</li></ul><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20200913144046.png" alt=""></p><h2 id="ä¸€æ¡æ›´æ–°è¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹" tabindex="-1"><a class="header-anchor" href="#ä¸€æ¡æ›´æ–°è¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹" aria-hidden="true">#</a> ä¸€æ¡æ›´æ–°è¯­å¥çš„æ‰§è¡Œè¿‡ç¨‹</h2><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20200913152005.png" alt=""></p><ul><li>å®¢æˆ·ç«¯çš„æ“ä½œä¸ä¼šç›´æ¥æ“ä½œç£ç›˜ï¼Œè€Œæ˜¯å…ˆå»åˆ°InnoDBä¸­çš„ç¼“å†²æ± Buffer Poolï¼Œå› ä¸ºIOä»£ä»·å¤ªå¤§</li><li>Buffer Poolå¯ä»¥åŠ é€Ÿæ•°æ®çš„æ“ä½œå’Œè®¿é—®(<strong>ä¸ºäº†é¿å…æ¯æ¬¡åœ¨è¯»å†™æ•°æ®æ—¶è®¿é—®ç£ç›˜å¢åŠ  IO å¼€é”€ï¼ŒInnodb å­˜å‚¨å¼•æ“é€šè¿‡æŠŠç›¸åº”çš„æ•°æ®é¡µå’Œç´¢å¼•é¡µåŠ è½½åˆ°Buffer Poolä¸­æ¥æé«˜è¯»å†™é€Ÿåº¦ã€‚ç„¶åæŒ‰ç…§æœ€è¿‘æœ€å°‘ä½¿ç”¨åŸåˆ™æ¥ä¿ç•™ç¼“å†²æ± ä¸­çš„ç¼“å­˜æ•°æ®ã€‚</strong>)</li><li>å½“å†…å­˜çš„æ•°æ®é¡µå’Œç£ç›˜çš„æ•°æ®é¡µä¸ä¸€è‡´æ—¶ï¼Œå†…å­˜ä¸­çš„æ•°æ®é¡µä¹Ÿç§°ä¸º<strong>è„é¡µ</strong></li><li>æ‰€ä»¥åœ¨InnoDBä¸­ä¸€äº›åå°çš„çº¿ç¨‹æ¯éš”ä¸€æ®µæ—¶é—´å°±ä¸€æ¬¡æ€§åœ°æŠŠBuffer Poolçš„æ•°æ®åŒæ­¥åˆ°ç£ç›˜ä¸­çš„æ•°æ®ä¸­ï¼Œè¿™ä¸ªåŠ¨ä½œä¹Ÿç§°ä¸º<strong>åˆ·è„</strong></li><li>é‚£ä¹ˆå½“è¦è¯»å…¥çš„æ•°æ®é¡µä¸åœ¨Buffer Poolä¸­æ—¶ï¼Œå°±éœ€è¦åœ¨Buffer Poolä¸­ç”³è¯·ä¸€ä¸ªæ–°çš„æ•°æ®é¡µï¼Œä½†Buffer Poolä¸­æ•°æ®é¡µæ˜¯ä¸€å®šçš„ï¼Œå½“æ•°æ®é¡µè¾¾åˆ°ä¸Šé™æ—¶æ­¤æ—¶å°±éœ€è¦æŠŠæœ€ä¹…ä¸ä½¿ç”¨çš„æ•°æ®é¡µä»å†…å­˜ä¸­æ·˜æ±°æ‰ã€‚<strong>ä½†å¦‚æœæ·˜æ±°çš„æ˜¯è„é¡µï¼Œé‚£ä¹ˆå°±éœ€è¦æŠŠè„é¡µåˆ·åˆ°ç£ç›˜é‡Œ(åˆ·è„)æ‰èƒ½è¿›è¡Œå¤ç”¨ã€‚</strong></li><li>å¦‚æœè„é¡µæ•°æ®è¿˜æœªå®Œå…¨åŒæ­¥åˆ°ç£ç›˜ä¸­ï¼ŒæœåŠ¡ç«¯å´©æºƒå…³é—­äº†ï¼Œæ•°æ®ä¼šä¸¢å¤±ã€‚è§£å†³æ–¹æ³•ï¼š<strong>æŒä¹…åŒ–æœºåˆ¶</strong></li><li>æŒä¹…åŒ–æœºåˆ¶ï¼šredo logï¼ŒæŠŠå†…å­˜çš„æ•°æ®å†™å…¥åˆ°æ—¥å¿—ä¸­ï¼Œä¸€æ—¦æœåŠ¡ç«¯å´©æºƒå…³é—­ï¼Œå°±ä»æ—¥å¿—æ–‡ä»¶ä¸­æ¢å¤åˆ°ç£ç›˜(WALæŠ€æœ¯ï¼Œå…ˆå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜) <ul><li>è®°å½•æ•°æ®é¡µçš„æ”¹åŠ¨ï¼Œå±äºç‰©ç†æ—¥å¿—</li><li>å¤§å°å›ºå®šï¼Œå‰é¢çš„å†…å®¹ä¼šè¢«è¦†ç›–</li><li>åœ¨InnoDBå­˜å‚¨å¼•æ“å±‚å®ç°</li><li>ç”¨äºå´©æºƒæ¢å¤</li><li><strong>å†™redo log çš„è¿‡ç¨‹æ˜¯é¡ºåºå†™ç£ç›˜çš„ï¼Œç£ç›˜é¡ºåºå†™å‡å°‘äº†å¯»é“ç­‰æ—¶é—´ï¼Œé€Ÿåº¦æ¯”éšæœºå†™è¦å¿«å¾ˆå¤š</strong></li></ul></li></ul><hr><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20200913154617.png" alt=""></p><p><strong>MySQL InnoDBä¸¤é˜¶æ®µ(XA)çš„æäº¤</strong></p><ol><li>å®¢æˆ·ç«¯æäº¤ä¸€æ¡æ›´æ–°è¯­å¥</li><li>æœåŠ¡å±‚æ¥æ”¶åˆ°è¿™ä¸€æ¡æ›´æ–°è¯­å¥ï¼Œäº§ç”Ÿæ‰§è¡Œè®¡åˆ’ï¼Œäº¤ç”±å­˜å‚¨å¼•æ“å±‚æ‰§è¡Œ</li><li>å­˜å‚¨å¼•æ“å±‚æŠŠä¿®æ”¹çš„ç»“æœæ›´æ–°åˆ°å†…å­˜</li><li>åŒæ—¶æŠŠç»“æœè®°å½•åˆ°redologä¸­ï¼ŒæŠŠè¿™ä¸€è¡Œçš„çŠ¶æ€è®¾ç½®æˆprepare</li><li>é€šçŸ¥æœåŠ¡å±‚å·²å®Œæˆä¿®æ”¹ï¼Œå¯ä»¥æäº¤äº‹åŠ¡</li><li>æœåŠ¡å±‚æŠŠä¿®æ”¹è®°å½•åˆ°binlogä¸­</li><li>æœåŠ¡å±‚æäº¤äº‹åŠ¡</li><li>å­˜å‚¨å¼•æ“å±‚æŠŠè¿™ä¸ªäº‹åŠ¡çš„çŠ¶æ€è®¾ç½®æˆcommitçŠ¶æ€</li></ol><h3 id="æ›´æ–°è¯­å¥æ‰§è¡Œçš„è¿‡ç¨‹ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨xaä¸¤é˜¶æ®µçš„æäº¤" tabindex="-1"><a class="header-anchor" href="#æ›´æ–°è¯­å¥æ‰§è¡Œçš„è¿‡ç¨‹ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨xaä¸¤é˜¶æ®µçš„æäº¤" aria-hidden="true">#</a> æ›´æ–°è¯­å¥æ‰§è¡Œçš„è¿‡ç¨‹ä¸ºä»€ä¹ˆéœ€è¦ä½¿ç”¨XAä¸¤é˜¶æ®µçš„æäº¤</h3><ul><li>ä¸ºäº†ä¿è¯æœ¬æ¬¡æ“ä½œä¸­binlogçš„æ•°æ®å’Œredologçš„æ•°æ®å†…å®¹çš„ä¸€è‡´æ€§</li><li>å‡è®¾æ•°æ®å†™å…¥äº†redologåï¼ŒæœåŠ¡ç«¯å¥”æºƒå…³é—­äº†ï¼Œé‡æ–°æ¢å¤åæ ¹æ®redologè¿›è¡Œå´©æºƒæ¢å¤ã€‚ç„¶è€Œbinlogçš„æ•°æ®ä»æœªè®°å½•æœ¬æ¬¡æ“ä½œï¼Œå½“æ‰§è¡Œä¸»ä»å¤åˆ¶çš„æ—¶å€™ï¼Œå°±ä¼šäº§ç”Ÿä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µ</li></ul><h3 id="è„é¡µä¸ºä»€ä¹ˆä¼šä½¿sqlå˜æ…¢" tabindex="-1"><a class="header-anchor" href="#è„é¡µä¸ºä»€ä¹ˆä¼šä½¿sqlå˜æ…¢" aria-hidden="true">#</a> è„é¡µä¸ºä»€ä¹ˆä¼šä½¿SQLå˜æ…¢</h3><ul><li>redo log å¤§å°æ˜¯ä¸€å®šçš„ï¼Œä¸”æ˜¯å¾ªç¯å†™å…¥çš„</li><li>åœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œredo log å¾ˆå¿«è¢«å†™æ»¡äº†ï¼Œä½†æ˜¯æ•°æ®æ¥ä¸åŠåŒæ­¥åˆ°ç£ç›˜é‡Œï¼Œè¿™æ—¶å€™å°±ä¼šäº§ç”Ÿè„é¡µï¼Œå¹¶ä¸”è¿˜ä¼šé˜»å¡åç»­çš„å†™å…¥æ“ä½œ</li></ul><h1 id="mysqlç´¢å¼•åŸç†ä¸ä½¿ç”¨è§„åˆ™" tabindex="-1"><a class="header-anchor" href="#mysqlç´¢å¼•åŸç†ä¸ä½¿ç”¨è§„åˆ™" aria-hidden="true">#</a> MySQLç´¢å¼•åŸç†ä¸ä½¿ç”¨è§„åˆ™</h1><h2 id="ç´¢å¼•æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•æ¦‚å¿µ" aria-hidden="true">#</a> ç´¢å¼•æ¦‚å¿µ</h2><p>æ˜¯æ•°æ®åº“ç®¡ç†ç³»ç»Ÿä¸­ä¸€ä¸ªæ’åºçš„<strong>æ•°æ®ç»“æ„</strong>ï¼Œä»¥<strong>ååŠ©å¿«é€ŸæŸ¥è¯¢ã€æ›´æ–°æ•°æ®åº“è¡¨ä¸­çš„æ•°æ®</strong></p><h3 id="ç´¢å¼•å·¥ä½œåŸç†ç¤ºä¾‹" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•å·¥ä½œåŸç†ç¤ºä¾‹" aria-hidden="true">#</a> ç´¢å¼•å·¥ä½œåŸç†ç¤ºä¾‹</h3><p>ä»¥ä¸»é”®ç´¢å¼•ä¸ºä¾‹ï¼Œä¸€ä¸ªä¸»é”®å¯¹åº”ä¸€è¡Œè®°å½•çš„åœ°å€å€¼ï¼Œé€šè¿‡è¿™ä¸ªä¸»é”®æ‰¾åˆ°åœ°å€ï¼Œå†é€šè¿‡åœ°å€å€¼æ‰¾åˆ°æ•°æ®</p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/20200916225708.png" alt=""></p><h3 id="ç´¢å¼•ç±»å‹" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•ç±»å‹" aria-hidden="true">#</a> ç´¢å¼•ç±»å‹</h3><ul><li>èšé›†ç´¢å¼•(ä¸»é”®ç´¢å¼•)</li><li>æ™®é€šç´¢å¼•</li><li>å”¯ä¸€ç´¢å¼•ï¼šç´¢å¼•çš„é”®å€¼ä¸èƒ½é‡å¤</li><li>å…¨æ–‡ç´¢å¼•ï¼šç”¨äºæå‡å¤§å­—æ®µä¸­ä½¿ç”¨<code>like</code>å…³é”®å­—æŸ¥è¯¢çš„æ•ˆç‡</li></ul><p>ä¸»é”®ç´¢å¼•ã€æ™®é€šç´¢å¼•ã€å”¯ä¸€ç´¢å¼•çš„åŒºåˆ«ï¼š</p><ul><li>ä¸»é”®ç´¢å¼•ä¸€å¼ è¡¨å†…åªå…è®¸æœ‰ä¸€ä¸ªï¼Œå€¼éœ€è¦å”¯ä¸€ï¼Œè€Œä¸”ä¸å…è®¸ç©ºå€¼ï¼Œå¯ä»¥ä½œä¸ºå…¶ä»–è¡¨çš„å¤–é”®ï¼Œä¸»é”®ç´¢å¼•ä½¿ç”¨ <code>not in</code> å…³é”®å­—ä»ç„¶å¯ä»¥èµ°ç´¢å¼•</li><li>å”¯ä¸€ç´¢å¼•ä¸€å¼ è¡¨å†…å¯ä»¥æœ‰å¤šä¸ªï¼Œå€¼éœ€è¦å”¯ä¸€ï¼Œä½†æ˜¯å¯ä»¥å…è®¸ç©ºå€¼ï¼Œä¸å¯ä»¥ä½œä¸ºå¤–é”®</li><li>æ™®é€šç´¢å¼•å¯¹å€¼æ²¡æœ‰çº¦æŸï¼Œä¸€èˆ¬åªç”¨äºæ’åº</li></ul><h3 id="ç´¢å¼•æ–¹æ³•" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•æ–¹æ³•" aria-hidden="true">#</a> ç´¢å¼•æ–¹æ³•</h3><ul><li>BTREE</li><li>HASH <ul><li>å…ˆç”¨ç´¢å¼•å­—æ®µå€¼é€šè¿‡å“ˆå¸Œæ–¹æ³•ï¼Œå¾—åˆ°å“ˆå¸Œå€¼ï¼Œå“ˆå¸Œå€¼å¯¹åº”æ‰¾åˆ°æ•°æ®çš„åœ°å€å€¼ï¼Œå†æ‰¾åˆ°æ•°æ®ï¼Œæ—¶é—´å¤æ‚åº¦å›ºå®šä¸ºO(1)</li><li>å“ˆå¸Œå€¼æ— åºï¼Œæ‰€ä»¥ä¸èƒ½ç”¨å“ˆå¸Œç´¢å¼•å®ç°æ’åºï¼Œä¹Ÿä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢</li><li>å¯èƒ½ä¼šå‘ç”Ÿå“ˆå¸Œç¢°æ’çš„æƒ…å†µ</li><li>åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­ä¸æ”¯æŒ<strong>æ‰‹åŠ¨åˆ›å»ºHASHç´¢å¼•</strong>(ä¼šè‡ªåŠ¨åœ¨çƒ­ç‚¹çš„BTREEç´¢å¼•ä¸Šå»ºè‡ªé€‚åº”çš„HASHç´¢å¼•)ï¼Œä¿å­˜åä¼šè‡ªåŠ¨å˜å›BTREE</li></ul></li></ul><h2 id="ç´¢å¼•ç»“æ„" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•ç»“æ„" aria-hidden="true">#</a> ç´¢å¼•ç»“æ„</h2><p>æœ‰åºæ•°ç»„ï¼šè®¿é—®æ•ˆç‡é«˜ï¼Œæ•°æ®çš„å˜åŠ¨æˆæœ¬é«˜</p><p>å•é“¾è¡¨ï¼šè®¿é—®æ•ˆç‡ä½</p><p>BSTæ ‘(äºŒå‰æŸ¥æ‰¾æ ‘)ï¼šæœ€åæƒ…å†µé€€åŒ–æˆå•é“¾è¡¨</p><p>AVLæ ‘(å¹³è¡¡äºŒå‰æ ‘)ï¼šAVLæ ‘ä¸­ä¸€ä¸ªèŠ‚ç‚¹å°±æ˜¯ä¸€é¡µï¼Œä¸€é¡µ16KBï¼Œä¸€ä¸ªèŠ‚ç‚¹åªå­˜æ”¾é”®å€¼å’Œç£ç›˜å¼•ç”¨çš„æ•°æ®é‡è¿œè¿œè¾¾ä¸åˆ°16KBï¼Œé€ æˆç©ºé—´æµªè´¹ï¼Œè®¿é—®æ•°æ®è¿›è¡Œç£ç›˜IOæ—¶ä¼šæµªè´¹å¤§é‡ç©ºé—´</p><p>â€‹ è§£å†³æ–¹æ¡ˆï¼šä¸€ä¸ªå—å­˜å¤šä¸ªèŠ‚ç‚¹ï¼Œç»“æœæ˜¯ï¼šæŒ‡é’ˆæ•°é‡æ›´å¤šï¼ŒåŸæ¥çš„äºŒå‰æ ‘å˜æˆå¤šå‰æ ‘ï¼Œæ‰€ä»¥æ ‘çš„æ·±åº¦å‡å°‘ã€‚</p><p>Bæ ‘(å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘)ï¼šèŠ‚ç‚¹æ‹¥æœ‰çš„å­æ ‘(åº¦)æ°¸è¿œæ¯”å…³é”®å­—çš„æ•°é‡å¤š1ã€‚IOæ¬¡æ•°è¦æ¯”AVLæ ‘å°‘ã€‚AVLæ ‘ä½¿ç”¨å·¦æ—‹ã€å³æ—‹ä¿æŒå¹³è¡¡ï¼›Bæ ‘ä½¿ç”¨åˆ†è£‚åˆå¹¶çš„æ“ä½œä¿æŒå¹³è¡¡</p><p><strong>B+æ ‘(åŠ å¼ºç‰ˆå¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘)ï¼šInnoDBä¸­å®é™…ä½¿ç”¨çš„ç»“æ„</strong></p><h3 id="ç´¢å¼•æ•°æ®ç»“æ„" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•æ•°æ®ç»“æ„" aria-hidden="true">#</a> ç´¢å¼•æ•°æ®ç»“æ„</h3><ul><li>å…³é”®å­—æ•°é‡å’ŒèŠ‚ç‚¹æ‹¥æœ‰çš„å­æ ‘çš„æ•°ç›®(åº¦)æ˜¯ç›¸ç­‰çš„</li><li>åªæœ‰å¶å­ç»“ç‚¹æ‰å­˜å‚¨æ•°æ®ï¼Œå…¶ä»–èŠ‚ç‚¹åªå­˜å‚¨ç´¢å¼•é”®å€¼ï¼Œæ‰€ä»¥æœç´¢è¿‡ç¨‹ä¸­å¿…é¡»æœç´¢åˆ°å¶å­ç»“ç‚¹ä¸­æ‰èƒ½çœŸæ­£è¿”å›æ•°æ®ï¼Œæ¯ä¸€æ¬¡æœç´¢çš„æ•ˆç‡æ›´åŠ çš„ç¨³å®š(æ¬¡æ•°ç›¸å¯¹ç¨³å®š)</li></ul><p><strong>InnoDBè¿›ä¸€æ­¥æ”¹è‰¯äº†B+æ ‘ï¼ŒåŠ å…¥äº†é¡ºåºè®¿é—®çš„æŒ‡é’ˆ</strong></p><p><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/image-20200917001024745.png" alt="image-20200917001024745"></p><ul><li>MyISAM <ul><li>MyISAMå­˜å‚¨å¼•æ“ä¸­æœ‰ä¸¤ä¸ªæ–‡ä»¶ï¼š.MYI å­˜å‚¨ç´¢å¼•ï¼Œ .MYDå­˜å‚¨æ•°æ®</li><li>æœç´¢æ•°æ®æ—¶ï¼Œå…ˆä»MYIæ–‡ä»¶ä¸­ç´¢å¼•çš„B+æ ‘çš„ç»“æ„ä¸­æ‰¾åˆ°é”®å€¼å¯¹åº”æ•°æ®çš„ç£ç›˜åœ°å€</li><li>å†ä»MYDæ–‡ä»¶ä¸­æ‰¾åˆ°å®Œæ•´æ•°æ®</li><li><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/image-20210221222230495.png" alt="image-20210221222230495"><img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/image-20210221222253588.png" alt="image-20210221222253588"></li><li>MyISAMç´¢å¼•åˆ†ä¸ºä¸¤ç±»ï¼šä¸»é”®ç´¢å¼•ã€è¾…åŠ©(å…¶ä»–)ç´¢å¼•ï¼Œä¸¤è€…æ£€ç´¢æ–¹å¼ä¸€æ ·</li></ul></li><li>InnoDB <ul><li>InnoDBå­˜å‚¨å¼•æ“ä¸­åªæœ‰ä¸€ä¸ªæ–‡ä»¶ï¼š.ibdï¼Œæ‰€ä»¥ç´¢å¼•å’Œæ•°æ®æ”¾åœ¨ä¸€èµ·</li><li>å› ä¸ºæ•°æ®æ˜¯è·Ÿéšä¸»é”®å­˜å‚¨çš„ï¼Œæ•°æ®åœ¨ç£ç›˜ä¸­çš„ç‰©ç†é¡ºåºå’Œä¸»é”®çš„é€»è¾‘é¡ºåºä¸€æ‘¸ä¸€æ ·ï¼Œæ‰€ä»¥ï¼š<strong>ä»¥ä¸»é”®ä¸ºç´¢å¼•æ¥ç»„ç»‡æ•°æ®å­˜å‚¨</strong></li><li>InnoDBä¸­åªæœ‰ä¸»é”®ç´¢å¼•æ˜¯èšé›†ç´¢å¼•ï¼šclustered indexï¼Œæ•°æ®åœ¨ç£ç›˜ä¸­çš„ç‰©ç†é¡ºåºå’Œä¸»é”®çš„é€»è¾‘é¡ºåºä¸€è‡´ã€‚å…¶ä»–ç´¢å¼•éƒ½æ˜¯éèšé›†ç´¢å¼•</li><li>å¦‚æœå»ºè¡¨æ—¶æ²¡æœ‰æŒ‡å®šä¸»é”®ï¼Œä¹Ÿå°±æ²¡æœ‰äº†ä¸»é”®ç´¢å¼•ï¼Œé‚£ä¹ˆInnoDBä¼š<strong>é»˜è®¤å…ˆå¯»æ‰¾ç¬¬ä¸€ä¸ªæ²¡æœ‰NULLå€¼çš„å”¯ä¸€ç´¢å¼•ä½œä¸ºèšé›†ç´¢å¼•</strong>ã€‚å¦‚æœä¹Ÿæ²¡æœ‰è¿™ä¸ªæ¡ä»¶ï¼Œé‚£ä¹ˆInnoDBæœ‰ä¸€ä¸ªRowIdéšè—å­—æ®µ(é€’å¢)ä½œä¸ºèšé›†ç´¢å¼•æ¥ç»„ç»‡æ•°æ®çš„å­˜å‚¨</li><li>InnoDBçš„ä¸»é”®ç´¢å¼•å’Œè¾…åŠ©ç´¢å¼•æ£€ç´¢æ•°æ®çš„æ–¹å¼æ˜¯æœ‰ä¸»æ¬¡ä¹‹åˆ†çš„ï¼Œè¾…åŠ©ç´¢å¼•å¿…é¡»è¦åˆ°ä¸»é”®ç´¢å¼•ä¸­æ£€ç´¢æ•°æ®ï¼Œå› ä¸ºæ•°æ®éƒ½æ˜¯å­˜æ”¾åœ¨ä¸»é”®ç´¢å¼•B+æ ‘ä¸Šçš„å¶å­ç»“ç‚¹ä¸Š<img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/image-20200917232914575.png" alt="image-20200917232914575"></li></ul></li></ul><h2 id="ç´¢å¼•ä½¿ç”¨åŸåˆ™" tabindex="-1"><a class="header-anchor" href="#ç´¢å¼•ä½¿ç”¨åŸåˆ™" aria-hidden="true">#</a> ç´¢å¼•ä½¿ç”¨åŸåˆ™</h2><ol><li>åˆ—çš„ç¦»æ•£åº¦ <ul><li>ç¦»æ•£åº¦å…¬å¼ï¼šcount(distinct(åˆ—)):count(*)ï¼Œè§£é‡Šï¼šè¿™ä¸€åˆ—æ‰€æœ‰ä¸åŒçš„å€¼æ¯”æ•°æ®è¡Œæ•°</li><li>å¦‚æœåˆ—çš„é‡å¤å€¼è¶Šå¤šï¼Œç¦»æ•£åº¦å°±è¶Šä½ï¼›å¦‚æœé‡å¤å€¼è¶Šå°‘ï¼Œç¦»æ•£åº¦å°±è¶Šé«˜</li><li>åœ¨ç¦»æ•£åº¦å¾ˆä½çš„å­—æ®µä¸Šå»ºç«‹ç´¢å¼•ï¼Œä½œç”¨ä¸å¤§ã€‚(explain sqlè¯­å¥ rowså­—æ®µçš„å€¼æ¯”è¾ƒå¤§) B+æ ‘ä¸Šé‡å¤å€¼è¿‡å¤šï¼Œä¸åˆ©äºæ£€ç´¢</li><li>å½“ä¸€ä¸ªå­—æ®µçš„ç¦»æ•£åº¦å¤ªä½æ—¶ï¼Œå­˜å‚¨å¼•æ“ç›´æ¥æ”¾å¼ƒä½¿ç”¨ç´¢å¼•ï¼Œè¿›è¡Œå…¨è¡¨æ‰«æï¼Œä¹Ÿä¸åˆ©äºæ•°æ®æ£€ç´¢</li></ul></li><li>è”åˆç´¢å¼•æœ€å·¦åŒ¹é…åŸåˆ™ <ul><li>å‡è®¾å»ºçš„è”åˆç´¢å¼•æ˜¯(nameã€phone) B+æ ‘ä¸­è”åˆç´¢å¼•çš„å­˜å‚¨æ–¹å¼(ä¾æ®ç´¢å¼•å»ºç«‹é¡ºåºä»å·¦åˆ°å³)<img src="https://wingbun-notes-image.oss-cn-guangzhou.aliyuncs.com/images/image-20200920172226252.png" alt="image-20200920172226252"></li><li>å‡å¦‚å®šä¹‰è”åˆç´¢å¼•<code>index(a,b,c)</code>ï¼Œé‚£ä¹ˆæœ€ç»ˆå¾—åˆ°çš„ç´¢å¼•æ˜¯ <ul><li><code>index(a)</code></li><li><code>index(a,b)</code></li><li><code>index(a,b,c)</code></li><li>æŸ¥è¯¢æ—¶æ²¡æœ‰ç”¨åˆ°ä»¥ä¸Šç»“æ„çš„ç´¢å¼•ï¼Œé‚£ä¹ˆè¿™ä¸ªè”åˆç´¢å¼•æ˜¯ç”¨ä¸ä¸Šçš„ï¼›è¦æƒ³ä½¿ç”¨è”åˆç´¢å¼•ï¼Œå¿…é¡»ä½¿ç”¨æœ€å·¦è¾¹çš„å­—æ®µ</li><li>å¦‚æœæŸ¥è¯¢æ—¶ä½¿ç”¨çš„å­—æ®µæ»¡è¶³ä¸Šé¢æ¡ä»¶ï¼Œä½†æ˜¯é¡ºåºä¸ä¸€è‡´ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨åˆ°è”åˆç´¢å¼•ã€‚å› ä¸ºæŸ¥è¯¢ä¼˜åŒ–å™¨ä¼šå¸®åŠ©ä¼˜åŒ–sqlè¯­å¥ï¼Œè°ƒæ•´whereå­å¥çš„é¡ºåº</li></ul></li></ul></li><li>è¦†ç›–ç´¢å¼• <ul><li>å›è¡¨ï¼šInnoDBä¸­é€šè¿‡ä½¿ç”¨æ™®é€šç´¢å¼•å®šä½ä¸»é”®å€¼ï¼Œå†é€šè¿‡ä¸»é”®å€¼å®šä½å…·ä½“è®°å½•çš„æ“ä½œ</li><li>è¦†ç›–ç´¢å¼•ï¼šç´¢å¼•è¦†ç›–äº†æŸ¥è¯¢çš„åˆ—ã€‚å°†ç´¢å¼•åˆ—ä½œä¸ºè¦æŸ¥è¯¢çš„æ•°æ®è¿™æ ·çš„è¯å°±å¯ä»¥ç›´æ¥è¿”å›ç´¢å¼•ä¸­çš„çš„æ•°æ®ï¼Œä¸éœ€è¦å†é€šè¿‡èšé›†ç´¢å¼•å»å®šä½è¡Œè®°å½•ï¼Œé¿å…äº†å›è¡¨çš„æƒ…å†µå‘ç”Ÿã€‚</li><li>å¯ä»¥ä½¿ç”¨è¦†ç›–ç´¢å¼•æ¥ä¼˜åŒ–sqlçš„åœºæ™¯ <ul><li>å…¨è¡¨countæŸ¥è¯¢ä¼˜åŒ–ã€‚ä½¿ç”¨<code>count</code>æ—¶å°½å¯èƒ½å»å‘½ä¸­è¾…åŠ©ç´¢å¼•æˆ–è€…èšé›†ç´¢å¼•ï¼Œè€Œä¸æ˜¯ä½¿ç”¨<code>count(*)</code></li><li><code>where</code>ã€<code>order</code>æŸ¥è¯¢æ—¶ç´¢å¼•ä½œä¸ºæ•°æ®åˆ—</li></ul></li></ul></li><li>é€šé…ç¬¦ <ul><li>å½“<code>%</code>æ”¾åœ¨å‰é¢ï¼Œé‚£ä¹ˆæ— æ³•ä½¿ç”¨ç´¢å¼•</li><li>å½“<code>%</code>æ”¾åœ¨åé¢ï¼Œå¯ä»¥ä½¿ç”¨ç´¢å¼•</li></ul></li><li>ç´¢å¼•æ¡ä»¶ä¸‹æ¨ <ul><li>æŠŠæ¡ä»¶ä¸‹æ¨åˆ°å­˜å‚¨å¼•æ“ï¼Œä¸éœ€è¦åœ¨Serverå±‚è¿›è¡Œè¿‡æ»¤ã€‚5.7ç‰ˆæœ¬åé»˜è®¤å¼€å¯</li><li>åªé€‚ç”¨äºæ™®é€šç´¢å¼•</li><li>æå‡æ•ˆç‡</li></ul></li></ol><h2 id="ä¼˜åŒ–æ‰‹æ®µ" tabindex="-1"><a class="header-anchor" href="#ä¼˜åŒ–æ‰‹æ®µ" aria-hidden="true">#</a> ä¼˜åŒ–æ‰‹æ®µ</h2><ul><li><p>è¡¨çš„ç´¢å¼•è¶Šå…¨è¶Šå¥½ï¼Œå› ä¸ºä¸ç®¡ä»€ä¹ˆæƒ…å†µéƒ½èƒ½ç”¨ä¸Šç´¢å¼•ï¼Œå¯¹å—ï¼Ÿ</p><blockquote><p>è™½ç„¶è¿™ç§åšæ³•åœ¨ç»™æ¯ä¸€ä¸ªå­—æ®µè¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œèƒ½æé«˜æ•ˆç‡ã€‚ä½†æ˜¯ï¼Œç´¢å¼•æœ¬è´¨æ˜¯ç£ç›˜ä¸Šçš„æ•°æ®ç»“æ„ï¼Œå»ºç«‹ç´¢å¼•æ˜¯éœ€è¦æ¶ˆè€—ç©ºé—´çš„ã€‚</p><p>è€Œä¸”åœ¨æ›´æ–°æ•°æ®æ—¶ï¼Œæ•°æ®ç»“æ„æœ‰å¯èƒ½ä¼šå¤§é‡åœ°æ”¹å˜ã€‚</p><p>å¦‚æœä¸€ä¸ªå­—æ®µéå¸¸é•¿(url)ï¼Œåœ¨è¿™ä¸ªå­—æ®µä¸Šå»ºç´¢å¼•æ¶ˆè€—çš„ç©ºé—´æ¯”è¾ƒå¤§</p></blockquote></li><li><p>ä¸ºä»€ä¹ˆä¸è¦åœ¨æ€§åˆ«å­—æ®µä¸Šå»ºç´¢å¼•ï¼Ÿ</p><blockquote><p>åªæœ‰ä¸¤ä¸ªå€¼ï¼Œåˆ—çš„ç¦»æ•£åº¦å¤ªå°ï¼Œä¸èƒ½æ˜æ˜¾åœ°æå‡æ•ˆç‡</p></blockquote></li><li><p>ä¸ºä»€ä¹ˆä¸è¦ä½¿ç”¨èº«ä»½è¯(UUID)ä½œä¸ºä¸»é”®ï¼Ÿ</p><blockquote><p>ä¸ä½¿ç”¨ä¸€ä¸ªé€’å¢å€¼ä½œä¸ºä¸»é”®çš„è¯ï¼Œæ’å…¥æ•°æ®æ—¶ï¼Œæœ‰å¯èƒ½é€ æˆå¤§é‡çš„é¡µæ•°æ®çš„åˆ†è£‚å’Œåˆå¹¶ã€‚ä½¿ç”¨è‡ªå¢idæ¥æ’å…¥æ•°æ®ï¼Œä¼šè‡ªåŠ¨æŒ‰é¡ºåºæ‰¾åˆ°æœ€åçš„é¡µæ¥è¿›è¡Œæ’å…¥</p></blockquote></li><li><p>æ¨¡ç³ŠåŒ¹é…<code>like abc%</code>ã€<code>like %2673%</code>ã€<code>like %888</code>éƒ½ç”¨ä¸åˆ°ç´¢å¼•ï¼Œå¯¹å—ï¼Ÿ</p><blockquote><p>%æ”¾åˆ°åé¢å¯ä»¥ä½¿ç”¨</p></blockquote></li><li><p>ä¸è¦ä½¿ç”¨<code>select *</code>å†™æ˜å…·ä½“å­—æ®µï¼Œä¸ºä»€ä¹ˆï¼Ÿ</p><blockquote><p>ä¸ºäº†ä½¿ç”¨åˆ°è¦†ç›–ç´¢å¼•</p></blockquote></li><li><p>åœ¨<code>where</code>æ¡ä»¶ä¸­<code>not in</code>å’Œ<code>&lt;&gt;</code>å’Œ<code>not like</code>éƒ½æ— æ³•ä½¿ç”¨ç´¢å¼•(è´Ÿå‘æŸ¥è¯¢)ï¼Œå¯¹å—ï¼Ÿ</p><blockquote><p>not in æœ‰å¯èƒ½å¯ä»¥ä½¿ç”¨ç´¢å¼•ï¼Œè·Ÿæ•°æ®é‡æœ‰å…³ç³»</p><p>&lt;&gt;ä¹Ÿå¯ä»¥ä½¿ç”¨ç´¢å¼•</p></blockquote></li></ul><h2 id="avlæ ‘ã€bæ ‘ã€b-æ ‘åˆ†åˆ«è§£å†³äº†çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#avlæ ‘ã€bæ ‘ã€b-æ ‘åˆ†åˆ«è§£å†³äº†çš„é—®é¢˜" aria-hidden="true">#</a> AVLæ ‘ã€Bæ ‘ã€B+æ ‘åˆ†åˆ«è§£å†³äº†çš„é—®é¢˜</h2><ul><li>AVLæ ‘ï¼šè§£å†³äº†BSTæ ‘åœ¨æœ€åæƒ…å†µä¸‹ä¼šå‡ºç°ä¸å¹³è¡¡çš„æƒ…å†µ(é€€åŒ–æˆçº¿æ€§å•å‘é“¾è¡¨)</li><li>Bæ ‘ï¼šåœ¨ä¸€ä¸ªç»“ç‚¹ä¸Šå­˜å‚¨å¤šä¸ªé”®å€¼å’Œå¤šä¸ªæŒ‡é’ˆï¼Œå¯ä»¥å‡å°‘IOæ¬¡æ•°</li><li>B+æ ‘ï¼šæ•°æ®åªå­˜å‚¨åˆ°å¶å­ç»“ç‚¹ä¸Šï¼Œæ•ˆç‡æ›´åŠ ç¨³å®šï¼›å¶å­ç»“ç‚¹ä¸Šè¿˜å¸¦æœ‰é¡ºåºè®¿é—®çš„æŒ‡é’ˆï¼ŒåšèŒƒå›´æŸ¥è¯¢çš„æ—¶å€™æ›´åŠ ç®€å•</li></ul><h2 id="innodbå»ºè®®ä½¿ç”¨è‡ªå¢ä½œä¸ºä¸»é”®ç”Ÿæˆçš„ç­–ç•¥" tabindex="-1"><a class="header-anchor" href="#innodbå»ºè®®ä½¿ç”¨è‡ªå¢ä½œä¸ºä¸»é”®ç”Ÿæˆçš„ç­–ç•¥" aria-hidden="true">#</a> InnoDBå»ºè®®ä½¿ç”¨è‡ªå¢ä½œä¸ºä¸»é”®ç”Ÿæˆçš„ç­–ç•¥</h2><ul><li>ä¸ºäº†é˜²æ­¢éšæœºæ’å…¥æ—¶é¡µçš„åˆ†è£‚å’Œåˆå¹¶</li><li>å­˜å‚¨å’ŒæŸ¥è¯¢æ—¶éƒ½ä¼šæ›´åŠ é«˜æ•ˆ</li></ul><h1 id="mysqläº‹åŠ¡ä¸é”è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#mysqläº‹åŠ¡ä¸é”è¯¦è§£" aria-hidden="true">#</a> MySQLäº‹åŠ¡ä¸é”è¯¦è§£</h1><p>é»˜è®¤è‡ªåŠ¨å¼€å¯äº‹åŠ¡ï¼Œæ‰§è¡Œdmlè¯­å¥æ—¶è‡ªåŠ¨æäº¤</p><p><code>show variables like &#39;atuocommit&#39;</code> æ˜¾ç¤º<code>on</code></p><p>è®¾ç½®äº‹åŠ¡æ˜¯å¦è‡ªåŠ¨å¼€å¯</p><p><code>set autocommit = on/off</code></p><p>æ‰‹åŠ¨å¼€å¯äº‹åŠ¡</p><p><code>start transaction</code> æˆ– <code>begin</code></p><p>ç»“æŸä¸€ä¸ªäº‹ç‰©</p><p><code>commit</code> æˆ– <code>rollback</code></p><h2 id="æ•°æ®åº“äº‹åŠ¡å®šä¹‰" tabindex="-1"><a class="header-anchor" href="#æ•°æ®åº“äº‹åŠ¡å®šä¹‰" aria-hidden="true">#</a> æ•°æ®åº“äº‹åŠ¡å®šä¹‰</h2><h2 id="äº‹åŠ¡å¹¶å‘ä¼šå¸¦æ¥çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡å¹¶å‘ä¼šå¸¦æ¥çš„é—®é¢˜" aria-hidden="true">#</a> äº‹åŠ¡å¹¶å‘ä¼šå¸¦æ¥çš„é—®é¢˜</h2><h2 id="äº‹åŠ¡éš”ç¦»æ€§å’Œé”çš„å…³ç³»" tabindex="-1"><a class="header-anchor" href="#äº‹åŠ¡éš”ç¦»æ€§å’Œé”çš„å…³ç³»" aria-hidden="true">#</a> äº‹åŠ¡éš”ç¦»æ€§å’Œé”çš„å…³ç³»</h2><h2 id="è¡Œé”çš„åŸç†å’Œç®—æ³•è¯¦è§£" tabindex="-1"><a class="header-anchor" href="#è¡Œé”çš„åŸç†å’Œç®—æ³•è¯¦è§£" aria-hidden="true">#</a> è¡Œé”çš„åŸç†å’Œç®—æ³•è¯¦è§£</h2><h1 id="mysqlæ€§èƒ½ä¼˜åŒ–æ€»ç»“" tabindex="-1"><a class="header-anchor" href="#mysqlæ€§èƒ½ä¼˜åŒ–æ€»ç»“" aria-hidden="true">#</a> MySQLæ€§èƒ½ä¼˜åŒ–æ€»ç»“</h1><p>ä¼˜åŒ–ä»ä½•å…¥æ‰‹ï¼Ÿ</p><p>è¿æ¥ï¼š</p><ul><li>too many connection</li><li>(è¿æ¥æ± )æ— æ³•è·å–è¿æ¥</li></ul><p>è§£å†³ï¼š</p><ul><li>å¢å¤§å¯ç”¨çš„è¿æ¥æ•°(é»˜è®¤151)</li><li>å‡å°‘åº”ç”¨ä»æ•°æ®åº“è·å–çš„è¿æ¥æ•° <ul><li>å‡å°‘è¶…æ—¶æ—¶é—´æ¥ææ—©é‡Šæ”¾é•¿è¿æ¥(é»˜è®¤8å°æ—¶)</li><li>æé«˜è¿æ¥å¤ç”¨ç‡(è¿æ¥æ± )</li></ul></li></ul><p>æŸ¥è¯¢ä¼˜åŒ–å™¨ï¼š</p><p>è®°å½•æ…¢æŸ¥è¯¢æ—¥å¿—(slow query log)ï¼Œé»˜è®¤å…³é—­ã€‚</p><p>mysqldumpslowå·¥å…·æ¥åˆ†ææ…¢æ—¥å¿—</p><p>show profiles æŸ¥çœ‹sqlè¯­å¥åŠå…¶æ‰§è¡Œçš„æ—¶é—´</p><p>ä¼˜åŒ–çš„ä¼˜å…ˆçº§ä»ä¸Šåˆ°ä¸‹ï¼›éš¾åº¦è¶Šå°ï¼Œæ”¶ç›Šè¶Šé«˜</p><ul><li><p>sqlè¯­å¥å’Œç´¢å¼•çš„ä¼˜åŒ–</p><ul><li>å°½é‡ä½¿ç”¨ç´¢å¼•</li><li>ä½¿ç”¨å¥½çš„ç´¢å¼•</li></ul></li><li><p>å­˜å‚¨å¼•æ“å’Œè¡¨ç»“æ„çš„ä¼˜åŒ–</p><ul><li>å­˜å‚¨å¼•æ“ <ul><li>æŸ¥è¯¢å’Œæ“ä½œæ¯”è¾ƒå¤šï¼ŒMyISAM</li><li>ä¸´æ—¶æ•°æ®ï¼ŒMemory</li><li>å¸¸è§„ï¼Œå¹¶å‘å¤§ï¼Œæ›´æ–°å¤šï¼ŒInnoDB</li></ul></li><li>è¡¨ç»“æ„ <ul><li>æ‹†åˆ†å¤§è¡¨</li><li>åˆ†åŒºï¼šæŠŠæ•°æ®æ”¾åˆ°ä¸åŒçš„æ–‡ä»¶å¤¹ä¸­å­˜æ”¾ï¼Œ<strong>æ²»æ ‡ä¸æ²»æœ¬çš„åšæ³•</strong></li><li>å­—æ®µé€‰æ‹©åŸåˆ™ï¼šä½¿ç”¨å¯ä»¥æ­£ç¡®å­˜å‚¨è¿™ä¸ªæ•°æ®çš„æœ€å°çš„æ•°æ®ç±»å‹ã€‚å¦‚ï¼šæ€§åˆ«å­—æ®µä½¿ç”¨<code>tinyint(1)</code></li><li>ä¸å…è®¸ä¸ºç©ºçš„å­—æ®µéƒ½å®šä¹‰æˆnot null</li><li>å°‘ç”¨å­˜å‚¨è¿‡ç¨‹ã€å¤–é”®ã€è§†å›¾ï¼ŒæŠŠè¿™éƒ¨åˆ†å·¥ä½œæ”¾åˆ°ç¨‹åºé‡Œé¢è¿›è¡Œ</li></ul></li></ul></li><li><p>æ¶æ„ä¼˜åŒ–</p><ul><li>ä½¿ç”¨ç¼“å­˜ï¼Œä¸ç”¨æ¯æ¬¡éƒ½ç›´æ¥å’Œæ•°æ®åº“è¿æ¥</li><li>ä¸»ä»å¤åˆ¶(è¯»å†™åˆ†ç¦»)ï¼Œå†™-ä¸»ï¼›è¯»-ä»</li><li>å‚ç›´åˆ†åº“(æŠŠä¸åŒçš„æ¨¡å—ä½¿ç”¨åˆ°çš„åº“åˆ†åˆ«ç‹¬ç«‹å‡ºæ¥)ï¼Œå…³è”æŸ¥è¯¢çš„è¯ä½¿ç”¨å­—æ®µå†—ä½™</li><li>æ°´å¹³åˆ†è¡¨(æŠŠå¤§è¡¨æ°´å¹³åˆ†å¼€æˆå‡ ä¸ªå°è¡¨)</li></ul></li><li><p>é…ç½®ä¼˜åŒ–(æ›´å¥½åœ°å‘æŒ¥ç¡¬ä»¶çš„åŠŸèƒ½)</p><ul><li>mysqlé…ç½®ä¼˜åŒ–</li></ul></li><li><p>æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶ä¼˜åŒ–</p><ul><li>å›ºæ€ç¡¬ç›˜æ›¿æ¢æœºæ¢°ç¡¬ç›˜</li></ul></li></ul><h1 id="sqlè¯­å¥æ‰§è¡Œæ…¢çš„åŸå› " tabindex="-1"><a class="header-anchor" href="#sqlè¯­å¥æ‰§è¡Œæ…¢çš„åŸå› " aria-hidden="true">#</a> SQLè¯­å¥æ‰§è¡Œæ…¢çš„åŸå› </h1><h2 id="å†™" tabindex="-1"><a class="header-anchor" href="#å†™" aria-hidden="true">#</a> å†™</h2><ul><li>å½“ redo log å†™æ»¡æ—¶å°±ä¼šè¿›è¡Œåˆ·è„é¡µï¼Œæ­¤æ—¶å†™æ“ä½œä¹Ÿä¼šç»ˆæ­¢ï¼Œé‚£ä¹ˆ SQL æ‰§è¡Œè‡ªç„¶å°±ä¼šå˜æ…¢ã€‚</li><li>é‡åˆ°æ‰€è¦ä¿®æ”¹çš„æ•°æ®è¡Œæˆ–è¡¨åŠ äº†é”æ—¶ï¼Œéœ€è¦ç­‰å¾…é”é‡Šæ”¾åæ‰èƒ½è¿›è¡Œåç»­æ“ä½œï¼ŒSQL æ‰§è¡Œä¹Ÿä¼šå˜æ…¢ã€‚</li></ul><h2 id="è¯»" tabindex="-1"><a class="header-anchor" href="#è¯»" aria-hidden="true">#</a> è¯»</h2><ul><li>è¯»æ“ä½œæ…¢å¸¸è§çš„åŸå› æ˜¯æœªå‘½ä¸­ç´¢å¼•ä»è€Œå¯¼è‡´å…¨è¡¨æ‰«æï¼Œå¯ä»¥é€šè¿‡ explain æ–¹å¼å¯¹ SQL è¯­å¥è¿›è¡Œåˆ†æã€‚</li><li>åœ¨è¯»æ“ä½œæ—¶ï¼Œè¦è¯»å…¥çš„æ•°æ®é¡µä¸åœ¨å†…å­˜ä¸­ï¼Œéœ€è¦é€šè¿‡æ·˜æ±°è„é¡µæ‰èƒ½ç”³è¯·æ–°çš„æ•°æ®é¡µä»è€Œå¯¼è‡´æ‰§è¡Œå˜æ…¢ã€‚æˆ‘ä»¬éœ€è¦æ§åˆ¶è„é¡µçš„æ¯”ä¾‹ï¼Œä¸è¦è®©å®ƒç»å¸¸æ¥è¿‘ 75%ã€‚åŒæ—¶è¿˜è¦æ§åˆ¶ redo log çš„å†™ç›˜é€Ÿåº¦ï¼Œå¹¶ä¸”é€šè¿‡è®¾ç½® innodb_io_capacity å‚æ•°å‘Šè¯‰ InnoDB ä½ çš„ç£ç›˜èƒ½åŠ›ã€‚</li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/gelald/javrin/edit/main/demo/src/writings/MySQL/MySQL.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ­¤é¡µ" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewbox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->ç¼–è¾‘æ­¤é¡µ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">ä¸Šæ¬¡ç¼–è¾‘äº: </span><span class="info">2022/7/14 05:20:02</span></div><div class="meta-item contributors"><span class="label">è´¡çŒ®è€…: </span><!--[--><!--[--><span class="contributor" title="email: yb.ng@foxmail.com">wuyingbin</span><!--]--><!--]--></div></footer><!----><div class="giscus-wrapper input-top" style="display:block;"><div style="text-align:center">Loading...</div></div><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer"></div><div class="copyright">Copyright Â© 2022 gelald</div></footer><!--]--></div><!--]--><!----><!--]--></div>
    <script type="module" src="/javrin/assets/app.e724fc18.js" defer></script>
  </body>
</html>
