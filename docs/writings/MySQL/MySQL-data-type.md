# MySQL 数据类型

MySQL 中主要包含 5 大类的数据类型，分别是整数型、小数型、字符串型、日期型、其他类型。



## 整数类型

### 数据类型

参考：[MySQL :: MySQL 8.0 Reference Manual :: 11.1.2 Integer Types (Exact Value) - INTEGER, INT, SMALLINT, TINYINT, MEDIUMINT, BIGINT](https://dev.mysql.com/doc/refman/8.0/en/integer-types.html)

| 数据类型  | 字节数  | 范围                                          |
| --------- | ------- | --------------------------------------------- |
| TINYINT   | 1个字节 | 有符号：0~2^8^-1<br />无符号：-2^7^~2^7^-1    |
| SMALLINT  | 2个字节 | 有符号：0~2^16^-1<br />无符号：-2^15^~2^15^-1 |
| MEDIUMINT | 3个字节 | 有符号：0~2^24^<br />无符号：-2^23^~2^23^-1   |
| INT       | 4个字节 | 有符号：0~2^32^<br />无符号：-2^31^~2^31^-1   |
| BIGINT    | 8个字节 | 有符号：0~2^64^<br />无符号：-2^63^~2^63^-1   |



### 显示宽度

我们经常能看见 INT(11) 的写法，其中括号内的数值是这个字段最大可能显示的数字个数，显示宽度只和展示有关，和数值范围无关。当打开 zerofill 选项时，当数值的位数小于指定的宽度时会由 0 填充存入。比如定义了 INT(3) 字段并打开以零填充，存入了一个6，最终显示 006。这个功能在开发过程中，意义不大。



### 和 Java 类型对应

**这里只讨论无符号的情况，有符号需要按数值范围来调整**

- 一般来说TINYINT、SMALLINT、MEDIUMINT、INT 都可以用 `java.lang.Integer` 来对应，因为 `Integer` 用 4 个字节存储数据
- BINGINT 由于超出 4 个字节，所以需要用 `java.lang.Long` 来对应
- **`java.lang.Boolean` 类型变量可以用 TINYINT 类型的字段**，MySQL 里有四个常量：true、false、TRUE、FALSE 分别代表 1、0、1、0。MySQL 保存 boolean 值时用 1 代表 TRUE，0 代表 FALSE



### 如何选择

balabala



## 小数类型

其中小数类型可以细分为浮点类型和定点类型

### 数值范围

- 浮点类型

> 浮点类型和定点类型都可以用`(M, D)`来表示，其中`M`称为精度，表示总共的位数；`D`称为标度，表示小数的位数。
>
> 浮点数类型的取值范围为 M（1～255）和 D（1～30，且不能大于 M-2），分别表示显示宽度和小数位数。M 和 D 在 FLOAT 和DOUBLE 中是可选的，FLOAT 和 DOUBLE 类型将默认会按照实际的精度（由计算机硬件和操作系统决定）。**DECIMAL 的默认 D 值为 0、M 值为 10**。
>
> 不论是定点还是浮点类型，如果用户指定的精度**超出精度范围，则会四舍五入进行处理**。

- 浮点类型

  - float，单精度，4个字节
  - double，双精度，8个字节

- 定点类型

  - decimal，M+2个字节

    > 在 MySQL 中，定点数以字符串形式存储，在对精度要求比较高的时候（如货币、科学数据），使用 DECIMAL 的类型比较好，另外两个浮点数进行减法和比较运算时也容易出问题，所以在使用浮点数时需要注意，并尽量**避免做浮点数比较**



## 日期类型

- year，格式`yyyy`，范围`1901~2155`，1个字节。可以接受整型和字符串，所以程序中记录年份时可以使用字符串
- time，格式`HH:mm:ss`，范围`-838:59:59 ~ 838:59:59`，3个字节
- date，格式`yyyy-MM-dd`，范围`1000-01-01 ~ 9999-12-3`，3个字节
- datetime，格式`yyyy-MM-dd HH:mm:ss`，范围`1000-01-01 00:00:00 ~ 9999-12-31 23:59:59`，8个字节
- timestamp，格式`yyyy-MM-dd HH:mm:ss`，范围`1980-01-01 00:00:01 UTC ~ 2040-01-19 03:14:07 UTC`，4个字节。如果不给这个字段赋值，或者赋值为null，那么默认使用系统当前时间来自动赋值
- datetime和timestamp的区别
  - **存储方式不一样**，timestamp存储时从客户端时区转换成UTC进行存储，查询时从UTC转换到客户端时区返回；datetime不转换，原样存储和读取
  - **时间范围不一样**，timestamp存储的范围为1970-01-01～ 2038-01-19；datetime存储的范围为1000-01-01 ～ 9999-12-31

### 数据类型

| 数据类型  | 格式                | 范围                                             | 字节数 |
| --------- | ------------------- | ------------------------------------------------ | ------ |
| YEAR      | yyyy                | 1901 ~ 2155                                      | 1      |
| DATE      | yyyy-MM-dd          | 1000-01-01 ~ 9999-12-31                          | 3      |
| TIME      | HH:mm:ss            | -838:59:59 ~ 838:59:59                           | 3      |
| DATETIME  | yyyy-MM-dd HH:mm:ss | 1000-01-01 00:00:00 ~ 9999-12-31 23:59:59        | 8      |
| TIMESTAMP | yyyyMMddHHmmss      | 1970-01-01 00:00:00 UTC ~ 2038-01-19 3:14:07 UTC | 4      |



DATETIME 和 TIMESTAMP 的区别



### java.sql.time

YEAR -> java.sql.Date/java.sql.Short

DATE -> java.sql.Date

Time -> java.sql.Time

DATETIME -> java.sql.Timestamp

TIMESTAMP -> java.sql.Timestamp



### 如何选择



## 字符串类型

### 数据类型

这里主要讨论常见的 CHAR、VARCHAR，其他的还有 BINARY、VARBINARY、BLOB、TEXT、ENUM、SET 这几种类型。

其中定义 CHAR、VARCHAR 时必须跟上一个数值 N，用于描述这个字段可容纳的**最大字符数**。

- CHAR(N) ：固定长度字符串
- VARCHAR(N) ：可变长度的字符串



用例子说明两者区别：

参考：[MySQL :: MySQL 8.0 Reference Manual :: 11.3.2 The CHAR and VARCHAR Types](https://dev.mysql.com/doc/refman/8.0/en/char.html)

| 存入的值   | CHAR(4) | VARCHAR(4) |
| ---------- | ------- | ---------- |
| ''         | '    '  | ''         |
| 'ab'       | 'ab  '  | 'ab'       |
| 'abcd'     | 'abcd'  | 'abcd'     |
| 'abcdefgh' | 'abcd'  | 'abcd'     |

- 当存储的内容没有超出字段可容纳的最大字符数时
  - CHAR(N) ：存储内容后进行填充，直到达到 N 个字符
  - VARCHAR(N) ：存储内容
- 当存储的内容大于或等于字段可容纳的最大字符数时，两者都只存储最大字符数的内容，后面的内容被截断。（超出自动截断的功能需要关闭 `STRICT_TRANS_TABLES` 功能，否则不存储）



### CHAR、VARCHAR字段占用字节数量

CHAR 和 VARCHAR 占用的字节数量和字符占用字节数、字段长度息息相关

- 字符占用字节数：**不同字符占据的字节数不同**，假设使用 utf8mb4 字符集，数字、英文、符号占用 1 个字节，中文占用 3 个字节，其他一些 emoji 符号、繁体字等需要使用 4 个字节。
- 另外由于 VARCHAR 是一个长度可变的字符串，还需要使用额外的空间来**存储字段长度**，当字段长度小于等于 255 字节时，需要使用 1 个字节，当字段长度大于 255 字节时，需要使用 2 个字节。





> 字符串类型可以在定义时使用M来指定长度，这个长度代表着该字段可容纳的最大字符数

- char(M)，固定长度字符串，M个字节

- varchar(M)，可变长度字符串，当实际存储的长度L小于M，则需要L+1个字节；当实际存储的长度等于M，则需要M+1个字节

- enum，一个字符串对象，值为表创建时列规定中枚举的一列值，语法`<字段名> ENUM( '值1', '值1', …, '值n' )`，从 1 开始编号。依照列索引顺序排列，并且空字符串排在非空字符串前，NULL 值排在其他所有枚举值前。ENUM 列总有一个默认值。如果将 ENUM 列声明为 NULL，NULL 值则为该列的一个有效值，并且默认值为 NULL。如果 ENUM 列被声明为 NOT NULL，其默认值为允许的值列表的第 1 个元素

  例子：定义enum类型的列('first', 'second', 'third')，值与索引的对应关系如下：

  | 索引 |    值    |
  | :--: | :------: |
  | null |   null   |
  |  0   |    ""    |
  |  1   | "first"  |
  |  2   | "second" |
  |  3   | "third"  |

- set，一个字符串的对象，可以有零或多个值，值为表创建时规定的一列值，语法`SET( '值1', '值2', …, '值n' )`，MySQL会自动删除重复值

- 大文本，适合保存文章、评论等

  - tinytext，长度为255，L+1个字节
  - text，长度为65535，L+2个字节
  - mediumtext，长度为16777215，L+3个字节
  - longtext，长度为4294967295，L+4个字节



## 其他类型

> 二进制类型可以在定义时使用M来指定长度

- text，文本类型，一般用来存储文本，最大长度65535字节
- bit(M)，以**二进制的形式**保存，M 表示每个值的位数，范围为 1～64。如果 M 被省略，默认值为 1，大约(M+7)/8个字节
- binary(M)，固定长度的二进制字符串，M个字节
- varbinary(M)，可变长度的二进制字符串，M+1个字节
- 二进制对象
  - tinyblob，255个字节
  - blob，65535个字节
  - mediumblob，16777215个字节
  - longblob，4294967295个字节

