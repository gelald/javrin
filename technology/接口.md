接口调用包含两个方面：

- 序列化：json、xml、hession、protobuf、thrift、text、bytes
- 通信协议：http、soap、websockect

# SOA架构设计模式
三种构建规范
1. SOAP: http+xml的形式
2. REST: http+json的形式
3. RPC: 基于socket的形式
三种典型框架
1. CXF: SOAP/REST框架
2. dubbo: RPC框架
3. SpringCloud: REST规范的生态系统

# SOAP

# REST
- 概念：REST即表现层状态转变（Representational State Transfer，简称REST）。**表现层状态**，是指(在某个瞬间状态的)资源数据的快照，包括资源数据的内容、表现格式(XML、JSON)等信息

- 原则：

  - 网络上所有事物都抽象为资源
  - 每个资源都有一个唯一的资源标识符（uri）
  - 同一个资源有多种表现形式（json、xml）
  - 对资源的各种操作不会改变资源标识符，只是请求方法的区别
  - 所有操作都是无状态的。是指服务端不保存任何与特定HTTP请求相关的资源，应用状态必须由请求方在请求过程中提供。要求在网络通信过程中，任意一个Web请求必须与其他请求隔离，当请求端提出请求时，请求本身包含了响应端为响应这一请求所需的全部信息。

- RESTful风格的体现，在你使用了get请求，就是查询；使用post请求,就是新增的请求；使用put请求，就是修改的请求；使用delete请求，就是删除的请求。这样做就完全没有必要对crud做具体的描述。![](https://tva1.sinaimg.cn/large/007S8ZIlgy1gfsrjsyshpj30p20hi7jn.jpg)

- 幂等性：对同一Rest接口多次访问，得到资源的状态是相同的

- 安全性：对该Rest接口访问，不会使服务端资源的状态发生变化

-  

  | http方法 | 资源操作 | 幂等 | 安全 |
  | -------- | -------- | ---- | ---- |
  | GET      | SELECT   | 是   | 是   |
  | POST     | INSERT   | 否   | 否   |
  | PUT      | UPDATE   | 是   | 否   |
  | DELETE   | DELETE   | 是   | 否   |

- 局限

  - 把所有内容定义为**资源**
  - 只能对资源作有限的**四种操作**
  - 例子：删除分为物理删除、标记删除；登陆登出

## 判断接口是否restful
- 看`url`就知道要什么
- 看`http method`就知道干什么
- 看`http status code`就知道结果如何

# RPC
- 概念：**R**emote **P**rocedure **C**all (远程调用过程)
- 解决两个问题：
  1. 解决**分布式**系统中，服务之间的调用问题
  2. 远程调用时，**要能够像本地调用一样方便**，让调用者感知不到远程调用的逻辑
- 数据格式
  - XML-RPC
  - JSON-RPC
- 响应方式
  - 同步调用：**客户端调用服务方方法，等待直到服务方返回结果或者超时，再继续自己的操作**。实现方式：
    - WebService：基于web容器的，底层使用http协议
    - RMI：Java语言的RPC实现，允许方法返回 Java 对象以及基本数据类型
  - 异步调用：**客户端把消息发送给中间件，不再等待服务端返回，直接继续自己的操作。**实现方式：
    - Java Message Service。JMS中间件有Kafka等消息中间件
- 架构中的内容
  - 客户端
  - 客户端存根：存放服务端地址信息，将客户端的请求参数打包成网络消息，再通过网络发送给服务方
  - 服务器存根：接受客户端发送过来的消息并解包，再调用本地服务
  - 服务端
- 架构图![](https://tva1.sinaimg.cn/large/007S8ZIlgy1gfsrjsayt4j30v10u0kjl.jpg)
- 需要考虑的问题
  - 通讯：长连接、短连接
  - 寻址：服务端的地址、端口、方法名。**如果是RMI调用的话，还需要一个RMI Registry来注册服务的地址**
  - 序列化与反序列化



# RPC和REST对比

从使用上来看

- Rest接口（面向资源）只关注服务提供方（服务端），客户端使用Http方式进行调用时，只要将内容进行传输即可，这样客户端在使用时，需要更关注网络方面的传输，比较不适用与业务方面的开发；（restful是服务端把方法写好，客户端通过http方式调用，直接定位到方法上面去。通过url）
- RPC服务（面向方法）**需要客户端接口与服务端保持一致**，服务端提供一个方法，客户端通过接口直接发起调用，业务开发人员仅需要关注业务方法的调用即可，不再关注网络传输的细节，在开发上更为高效。（PRC是服务端提供好方法给客户端调用。定位到类，然后通过类去调用方法。通过服务的类名和方法名）