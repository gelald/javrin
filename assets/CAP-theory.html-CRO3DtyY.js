import{_ as e}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,a as i,o as r}from"./app-BH1OTr4j.js";const n={};function o(s,t){return r(),a("div",null,[...t[0]||(t[0]=[i('<h1 id="cap-理论" tabindex="-1"><a class="header-anchor" href="#cap-理论"><span>CAP 理论</span></a></h1><blockquote><p>CAP 理论是一切分布式系统工作的指导理论，因为 CAP 不能兼得，所以在设计时更应该考虑清楚设计上的取舍</p></blockquote><h2 id="概念" tabindex="-1"><a class="header-anchor" href="#概念"><span>概念</span></a></h2><ul><li>C：一致性 ( Consistency )。对于客户端的每个读操作，要么返回最新的数据，要么读取失败。<strong>强调的是数据正确</strong></li><li>A：可用性 ( Availability )。对于客户端的请求都能得到响应数据，不会出现响应错误，但是不保证数据是最新的。<strong>强调的是不出错</strong></li><li>P：分隔容忍 ( Partition tolerance )。因为分布式系统是通过网络进行通信的，但是网络往往是不可靠的。当任意数量的消息丢失或延迟到达时，系统仍然会继续提供服务。<strong>强调的是不会挂掉</strong></li></ul><h2 id="cap-只能三选二" tabindex="-1"><a class="header-anchor" href="#cap-只能三选二"><span>CAP 只能三选二</span></a></h2><p>CAP 是难以同时三者兼得的</p><h3 id="原因" tabindex="-1"><a class="header-anchor" href="#原因"><span>原因</span></a></h3><ol><li>如果 C 是第一需求的话，那么会影响 A 的性能，<strong>因为要数据同步，不然请求结果会有差异，但是数据同步会消耗时间，期间可用性就会降低。</strong></li><li>如果 A 是第一需求，那么只要有一个服务在，就能正常接受请求，但是对于返回结果不能保证是最新的，原因是，<strong>在分布式部署的时候，数据一致的过程不可能像切换线路那么快。</strong></li><li>再如果，同时满足一致性和可用性，只能是单点部署；而对于分布式系统而言，P 是必须保证的，我们必须接受网络带来的数据延迟和丢失，但是不允许系统挂掉</li></ol><blockquote><p>其实不是所有情况下都只能选择两个特性，在不存在网络失败的情况下（分布式系统正常运行），C 和 A 是能同时保证的。</p></blockquote><h3 id="关于-cp-ap-的选择" tabindex="-1"><a class="header-anchor" href="#关于-cp-ap-的选择"><span>关于 CP/AP 的选择</span></a></h3><h4 id="交易场景" tabindex="-1"><a class="header-anchor" href="#交易场景"><span>交易场景</span></a></h4><p>C 是必须保证的，如果网络发生故障，宁愿不提供服务，也不能发生自损的情况</p><h4 id="注册中心集群" tabindex="-1"><a class="header-anchor" href="#注册中心集群"><span>注册中心集群</span></a></h4><p>A 是必须保证的，对于服务发现来说，针对同一个服务，即使注册中心的不同节点保存的服务提供者信息不尽相同，也不会造成灾难性后果；而对于服务消费者来说，注册中心不可用导致消费不能正常进行，对于系统来说是灾难性的</p><h4 id="其他场景" tabindex="-1"><a class="header-anchor" href="#其他场景"><span>其他场景</span></a></h4><p>一般情况下我们会选择 AP，尽管舍弃了强一致性，但是可用性的保证，提升了用户使用体验，而且可以通过一定的手段追求最终一致性</p>',16)])])}const c=e(n,[["render",o]]),h=JSON.parse('{"path":"/writings/distributed/CAP-theory.html","title":"CAP 理论","lang":"zh-CN","frontmatter":{"title":"CAP 理论","icon":"article","category":["分布式"],"description":"CAP 理论 CAP 理论是一切分布式系统工作的指导理论，因为 CAP 不能兼得，所以在设计时更应该考虑清楚设计上的取舍 概念 C：一致性 ( Consistency )。对于客户端的每个读操作，要么返回最新的数据，要么读取失败。强调的是数据正确 A：可用性 ( Availability )。对于客户端的请求都能得到响应数据，不会出现响应错误，但是不保...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"CAP 理论\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2023-03-01T12:32:48.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"gelald\\",\\"url\\":\\"https://github.com/gelald\\"}]}"],["meta",{"property":"og:url","content":"https://gelald.github.io/javrin/javrin/writings/distributed/CAP-theory.html"}],["meta",{"property":"og:site_name","content":"Javrin"}],["meta",{"property":"og:title","content":"CAP 理论"}],["meta",{"property":"og:description","content":"CAP 理论 CAP 理论是一切分布式系统工作的指导理论，因为 CAP 不能兼得，所以在设计时更应该考虑清楚设计上的取舍 概念 C：一致性 ( Consistency )。对于客户端的每个读操作，要么返回最新的数据，要么读取失败。强调的是数据正确 A：可用性 ( Availability )。对于客户端的请求都能得到响应数据，不会出现响应错误，但是不保..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2023-03-01T12:32:48.000Z"}],["meta",{"property":"article:modified_time","content":"2023-03-01T12:32:48.000Z"}]]},"git":{"createdTime":1660809766000,"updatedTime":1677673968000,"contributors":[{"name":"gelald","username":"gelald","email":"yb.ng@foxmail.com","commits":4,"url":"https://github.com/gelald"}]},"readingTime":{"minutes":2.27,"words":681},"filePathRelative":"writings/distributed/CAP-theory.md","autoDesc":true}');export{c as comp,h as data};
