import{_ as e}from"./plugin-vue_export-helper-c27b6911.js";import{o as a,c as s,e as n}from"./app-f9042815.js";const d={},i=n(`<h1 id="ä¿®æ”¹-docker-é»˜è®¤å­˜å‚¨è·¯å¾„" tabindex="-1"><a class="header-anchor" href="#ä¿®æ”¹-docker-é»˜è®¤å­˜å‚¨è·¯å¾„" aria-hidden="true">#</a> ä¿®æ”¹ Docker é»˜è®¤å­˜å‚¨è·¯å¾„</h1><h2 id="é—®é¢˜å¼•å…¥" tabindex="-1"><a class="header-anchor" href="#é—®é¢˜å¼•å…¥" aria-hidden="true">#</a> é—®é¢˜å¼•å…¥</h2><p>ä»Šå¤©åœ¨æœåŠ¡å™¨(æ“ä½œç³»ç»Ÿ: CentOS)ä¸Šåˆ›å»ºæ–°å®¹å™¨çš„æ—¶å€™çœ‹åˆ°å®¹å™¨åˆ›å»ºå¤±è´¥ï¼Œå¹¶æç¤ºç£ç›˜ç©ºé—´ä¸è¶³ã€‚</p><p>è¾“å…¥æŸ¥è¯¢ç£ç›˜ç©ºé—´å‘½ä»¤åå‘ç°ï¼Œ<code>/</code> ç›®å½•åªåˆ†é…äº†50Gç©ºé—´ï¼Œè€Œ <code>/home</code> ç›®å½•å´åˆ†é…äº†198Gç©ºé—´ã€‚</p><p>è€Œ Docker é»˜è®¤çš„å­˜å‚¨è·¯å¾„æ˜¯ <code>/var/lib/docker</code> ï¼Œæ˜¯åœ¨ <code>/</code> ç›®å½•ä¸‹çš„ï¼Œåœ¨ä¸ä¿®æ”¹æ“ä½œç³»ç»Ÿç£ç›˜æŒ‚è½½çš„å‰æä¸‹ï¼Œæƒ³è¦ Docker èƒ½æ­£å¸¸ä½¿ç”¨ã€åˆ›å»ºå®¹å™¨ï¼Œæˆ‘ä»¬éœ€è¦æŠŠ Docker é»˜è®¤å­˜å‚¨è·¯å¾„ä¿®æ”¹åˆ° <code>/home</code> ç›®å½•ä¸‹ã€‚</p><h2 id="ä¿®æ”¹æ–¹æ³•ä¸€" tabindex="-1"><a class="header-anchor" href="#ä¿®æ”¹æ–¹æ³•ä¸€" aria-hidden="true">#</a> ä¿®æ”¹æ–¹æ³•ä¸€</h2><p>ç›´æ¥ä¿®æ”¹ docker çš„å¯åŠ¨å‚æ•°</p><ul><li><p>æš‚æ—¶åœæ­¢ Docker æœåŠ¡</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl stop <span class="token function">docker</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>ä¿é™©èµ·è§ï¼Œå†æ¬¡ç¡®è®¤ Docker çš„å­˜å‚¨è·¯å¾„</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> info <span class="token operator">|</span> <span class="token function">grep</span> Dir

Docker Root Dir: /var/lib/docker              <span class="token comment"># dockeré»˜è®¤çš„å­˜å‚¨è·¯å¾„</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åœ¨ <code>/home</code> ç›®å½•ä¸‹æ–°å»ºå­˜å‚¨ç›®å½•</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /home/docker
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>è¿ç§»åŸæœ‰æ•°æ®åˆ°æ–°ç›®å½•</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">mv</span> /var/lib/docker/* /home/docker
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>ä¿®æ”¹ docker.service é…ç½®æ–‡ä»¶</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">vi</span> /usr/lib/systemd/system/docker.service
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ‰¾åˆ°è¿™ä¸€è¡Œ</p><p><code>ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock</code></p><p>ä¿®æ”¹å¦‚ä¸‹</p><p><code>ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock --graph /home/docker</code></p></li><li><p>ä½¿è¿™ä»½é…ç½®æ–‡ä»¶ç”Ÿæ•ˆ</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl daemon-reload
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>å¯åŠ¨ Docker æœåŠ¡</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl start <span class="token function">docker</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>æŸ¥çœ‹æ˜¯å¦ä¿®æ”¹æˆåŠŸ</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> info <span class="token operator">|</span> <span class="token function">grep</span> Dir

Docker Root Dir: /home/docker
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>å¦‚æœ <code>Docker</code> çš„ç‰ˆæœ¬æ˜¯ <code>1.12</code> æˆ–ä»¥ä¸Šçš„ï¼Œå¯ä»¥ä¿®æ”¹æˆ–æ–°å»º <code>daemon.json</code> æ–‡ä»¶ã€‚ä¿®æ”¹åä¼šç«‹å³ç”Ÿæ•ˆï¼Œä¸éœ€é‡å¯ <code>Docker</code> æœåŠ¡ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ä¿®æ”¹é…ç½®æ–‡ä»¶</span>
<span class="token function">vi</span> /etc/docker/daemon.json


<span class="token punctuation">{</span>
    <span class="token string">&quot;graph&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/new-path/docker&quot;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="ä¿®æ”¹æ–¹æ³•äºŒ" tabindex="-1"><a class="header-anchor" href="#ä¿®æ”¹æ–¹æ³•äºŒ" aria-hidden="true">#</a> ä¿®æ”¹æ–¹æ³•äºŒ</h2><p>ä¸ä¿®æ”¹å¯åŠ¨å‚æ•°ï¼Œåˆ›å»ºç›®å½•çš„è½¯é“¾æ¥ï¼Œå­˜æ”¾ç›®å½•ä¾æ—§æ˜¯é‚£ä¸ªï¼Œä½†æ˜¯å®é™…å­˜æ”¾ç›®å½•å·²ç»è¢«ä¿®æ”¹äº†</p><ul><li><p>æˆ‘ä»¬çŸ¥é“åœ¨æ“ä½œç³»ç»Ÿå½“ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ <code>Docker</code> å®¹å™¨çš„å­˜æ”¾ä½ç½®åœ¨ <code>/var/lib/docker</code> ç›®å½•ä¸‹é¢ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢å‘½ä»¤æŸ¥çœ‹å…·ä½“ä½ç½®ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">docker</span> info <span class="token operator">|</span> <span class="token function">grep</span> Dir

Docker Root Dir: /var/lib/docker
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>è§£å†³é»˜è®¤å­˜å‚¨å®¹é‡ä¸è¶³çš„æƒ…å†µï¼Œæœ€ç›´æ¥ä¸”æœ€æœ‰æ•ˆçš„æ–¹æ³•å°±æ˜¯æŒ‚è½½æ–°çš„åˆ†åŒºåˆ°è¯¥ç›®å½•ã€‚ä½†æ˜¯åœ¨åŸæœ‰ç³»ç»Ÿç©ºé—´ä¸å˜çš„æƒ…å†µä¸‹ï¼Œæ‰€ä»¥é‡‡ç”¨è½¯é“¾æ¥çš„æ–¹å¼ï¼Œä¿®æ”¹é•œåƒå’Œå®¹å™¨çš„å­˜æ”¾è·¯å¾„è¾¾åˆ°åŒæ ·çš„ç›®çš„ã€‚</p></li><li><p>åœæ‰ Docker æœåŠ¡</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>systemctl stop <span class="token function">docker</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>ç„¶åç§»åŠ¨æ•´ä¸ª <code>/var/lib/docker</code> ç›®å½•åˆ°ç©ºé—´ä¸è¾ƒå¤§çš„ç›®çš„è·¯å¾„ã€‚è¿™æ—¶å€™å¯åŠ¨ <code>Docker</code> æ—¶å‘ç°å­˜å‚¨ç›®å½•ä¾æ—§æ˜¯ <code>/var/lib/docker</code> ç›®å½•ï¼Œä½†æ˜¯å®é™…ä¸Šæ˜¯å­˜å‚¨åœ¨æ•°æ®ç›˜ <code>/data/docker</code> ä¸Šäº†ã€‚</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token comment"># ç§»åŠ¨åŸæœ‰çš„å†…å®¹</span>
<span class="token function">mv</span> /var/lib/docker /home/docker

<span class="token comment"># åˆ›å»ºé“¾æ¥</span>
<span class="token function">ln</span> <span class="token parameter variable">-sf</span> /home/docker /var/lib/docker
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ul><p>æ¥ä¸‹æ¥ Docker æœåŠ¡è¿è¡Œè¿‡ç¨‹ä¸­çš„é•œåƒã€å®¹å™¨å…¨éƒ½å­˜å‚¨åˆ°ç©ºé—´æ›´å¤§çš„ <code>/home</code> ç›®å½•ä¸‹äº†ï¼Œåˆå¯ä»¥æ„‰å¿«åœ°åˆ›å»ºå®¹å™¨äº†ğŸ˜‰</p><p>å‚è€ƒé“¾æ¥ï¼šhttps://huaweicloud.csdn.net/6331127bd3efff3090b513db.html</p>`,15),c=[i];function o(r,l){return a(),s("div",null,c)}const u=e(d,[["render",o],["__file","modify-docker-default-storage.html.vue"]]);export{u as default};
