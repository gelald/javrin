import{_ as p}from"./plugin-vue_export-helper.21dcd24c.js";import{r as e,o as c,c as o,a as n,b as a,d as i,e as t}from"./app.dcab4746.js";const l={},u=i(`<h1 id="mysql-\u6279\u91CF\u63D2\u5165\u6570\u636E" tabindex="-1"><a class="header-anchor" href="#mysql-\u6279\u91CF\u63D2\u5165\u6570\u636E" aria-hidden="true">#</a> MySQL \u6279\u91CF\u63D2\u5165\u6570\u636E</h1><h2 id="\u524D\u8A00" tabindex="-1"><a class="header-anchor" href="#\u524D\u8A00" aria-hidden="true">#</a> \u524D\u8A00</h2><p>\u6211\u4EEC\u5728\u64CD\u4F5C\u5927\u91CF\u6570\u636E\u5199\u5165\u6570\u636E\u5E93\u7684\u65F6\u5019\uFF0C\u56E0\u4E3A\u5199\u5165\u6570\u636E\u5E93\u6D89\u53CA\u5230\u78C1\u76D8 IO \uFF0C\u6240\u4EE5\u6700\u5408\u9002\u7684\u65B9\u6848\u5C31\u662F\u6279\u91CF\u63D2\u5165\uFF0C\u5177\u4F53\u53CD\u6620\u5230\u7A0B\u5E8F\u4E0A\u9762\u662F\u5982\u4F55\u6279\u91CF\u63D2\u5165\u5462\uFF1F\u6709\u54EA\u4E9B\u65B9\u6848\u5462\uFF1F\u6211\u4EEC\u5E26\u7740\u8FD9\u4E9B\u95EE\u9898\u4E00\u8D77\u5411\u4E0B\u770B</p><h2 id="\u73AF\u5883\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#\u73AF\u5883\u51C6\u5907" aria-hidden="true">#</a> \u73AF\u5883\u51C6\u5907</h2><h3 id="\u6570\u636E\u5E93\u7248\u672C" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u5E93\u7248\u672C" aria-hidden="true">#</a> \u6570\u636E\u5E93\u7248\u672C</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>mysql&gt; select version();
+-----------+
| version() |
+-----------+
| 8.0.29    |
+-----------+
1 row in set (0.00 sec)
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u6570\u636E\u5E93\u8868\u7ED3\u6784" tabindex="-1"><a class="header-anchor" href="#\u6570\u636E\u5E93\u8868\u7ED3\u6784" aria-hidden="true">#</a> \u6570\u636E\u5E93\u8868\u7ED3\u6784</h3><div class="language-mysql ext-mysql line-numbers-mode"><pre class="language-mysql"><code>CREATE TABLE \`batch_maintain\` (
  \`maintain_id\` int(11) NOT NULL AUTO_INCREMENT,
  \`maintain_num\` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT &#39;\u4FDD\u517B\u5DE5\u5355\u7F16\u53F7&#39;,
  \`maintain_name\` varchar(1024) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NOT NULL COMMENT &#39;\u4FDD\u517B\u8BA1\u5212&#39;,
  \`equipment_num\` bigint(20) NOT NULL COMMENT &#39;\u8BBE\u5907\u7F16\u53F7&#39;,
  \`maintain_type\` int(11) NOT NULL COMMENT &#39;\u517B\u62A4\u7C7B\u578B&#39;,
  \`functionary\` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL COMMENT &#39;\u8D23\u4EFB\u4EBA&#39;,
  \`maintain_duration\` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci DEFAULT NULL COMMENT &#39;\u4FDD\u517B\u5468\u671F&#39;,
  \`start_time\` datetime DEFAULT NULL COMMENT &#39;\u5F00\u59CB\u65F6\u95F4&#39;,
  \`end_time\` datetime DEFAULT NULL COMMENT &#39;\u7ED3\u675F\u65F6\u95F4&#39;,
  \`maintain_status\` tinyint(4) NOT NULL COMMENT &#39;\u4FDD\u517B\u72B6\u6001&#39;,
  PRIMARY KEY (\`maintain_id\`)
) ENGINE=InnoDB AUTO_INCREMENT=900001 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci COMMENT=&#39;\u4FDD\u517B\u5DE5\u5355&#39;;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="\u7A0B\u5E8F\u4F9D\u8D56" tabindex="-1"><a class="header-anchor" href="#\u7A0B\u5E8F\u4F9D\u8D56" aria-hidden="true">#</a> \u7A0B\u5E8F\u4F9D\u8D56</h3><table><thead><tr><th>\u4F9D\u8D56</th><th>\u7248\u672C</th></tr></thead><tbody><tr><td>spring-boot-starter-web</td><td>2.6.1</td></tr><tr><td>mybatis-plus-boot-starter</td><td>3.5.2</td></tr><tr><td>HikariCP</td><td>4.0.3</td></tr><tr><td>mysql-connector-java</td><td>8.0.27</td></tr></tbody></table><h2 id="\u4EE3\u7801\u5B9E\u73B0" tabindex="-1"><a class="header-anchor" href="#\u4EE3\u7801\u5B9E\u73B0" aria-hidden="true">#</a> \u4EE3\u7801\u5B9E\u73B0</h2><p>MySQL\u63D2\u5165\u6570\u636E\u4E3B\u8981\u662F\u5728\u83B7\u53D6\u8FDE\u63A5\u3001\u5173\u95ED\u8FDE\u63A5\u3001\u91CA\u653E\u8D44\u6E90\u548C\u63D0\u4EA4\u4E8B\u52A1\u7B49\u65B9\u9762\u8F83\u8017\u80FD\uFF0C\u5982\u679C\u4F7F\u7528 for \u5FAA\u73AF\u8FDB\u884C\u5355\u6761\u63D2\u5165\u65F6\uFF0C\u6BCF\u6B21\u90FD\u5728\u83B7\u53D6\u8FDE\u63A5\u3001\u91CA\u653E\u8FDE\u63A5\u548C\u8D44\u6E90\u5173\u95ED\u7B49\u64CD\u4F5C\u4E0A\u82B1\u8D39\u65F6\u95F4\uFF0C\u5982\u679C\u6570\u636E\u91CF\u5927\u7684\u60C5\u51B5\u4E0B\u6781\u5176\u6D88\u8017\u8D44\u6E90\uFF0C\u4F1A\u5BFC\u81F4\u64CD\u4F5C\u65F6\u95F4\u8FC7\u957F\uFF0C\u5B9E\u9645\u4E0A\u8FD9\u4E9B\u8D44\u6E90\u90FD\u662F\u53EF\u4EE5\u590D\u7528\u8D77\u6765\uFF0C\u6240\u4EE5\u5927\u6279\u91CF\u6570\u636E\u63D2\u5165\u65F6\u5C3D\u91CF\u4F7F\u7528\u6279\u5904\u7406\uFF08\u6279\u91CF\u63D2\u5165\uFF09\uFF0C\u6279\u5904\u7406\u5BF9\u8D44\u6E90\u5229\u7528\u7387\u66F4\u9AD8\uFF0C\u6548\u7387\u4E5F\u5C31\u6BD4\u5355\u6761\u63D2\u5165\u66F4\u9AD8\u3002\u5F00\u542F\u6279\u5904\u7406\u9700\u8981\u5728 JDBC \u8FDE\u63A5\u4E0A\u914D\u7F6E\u6279\u5904\u7406\u5C5E\u6027 <code>rewriteBatchedStatements=true</code> \uFF0C\u6570\u636E\u5E93\u9A71\u52A8\u624D\u4F1A\u5E2E\u6211\u4EEC\u6279\u91CF\u6267\u884C SQL \u8BED\u53E5\u3002</p><p>\u867D\u7136\u786E\u5B9A\u4E86\u4F7F\u7528\u6279\u5904\u7406\u63D2\u5165\u7684\u65B9\u5F0F\uFF0C\u4F46\u8FD8\u53EF\u4EE5\u4ECE\u8FD9 3 \u4E2A\u7EF4\u5EA6\u8003\u8651\u8FD9\u4E2A\u95EE\u9898</p><ul><li>JDBC \u539F\u751F / \u6846\u67B6\u5C01\u88C5\u7684\u65B9\u6CD5</li><li>\u76F4\u63A5\u63D0\u4EA4 / \u4E8B\u52A1\u63D0\u4EA4</li></ul><h3 id="\u4E8B\u52A1\u4E0E\u6279\u91CF\u5904\u7406\u7684\u533A\u522B" tabindex="-1"><a class="header-anchor" href="#\u4E8B\u52A1\u4E0E\u6279\u91CF\u5904\u7406\u7684\u533A\u522B" aria-hidden="true">#</a> \u4E8B\u52A1\u4E0E\u6279\u91CF\u5904\u7406\u7684\u533A\u522B</h3><ul><li>\u4E8B\u52A1\u662F\u6307\u4E00\u4E2A\u5305\u542B\u591A\u4E2A\u6B65\u9AA4\u7684\u64CD\u4F5C\uFF0C\u8FD9\u4E9B\u64CD\u4F5C\u8981\u4E48\u5168\u90E8\u6210\u529F\uFF0C\u8981\u4E48\u5168\u90E8\u5931\u8D25\uFF1B\u4E8B\u52A1\u539F\u7406\u662F\u628A SQL \u8BED\u53E5\u5B58\u50A8\u5728\u6570\u636E\u5E93\u670D\u52A1\u5668\uFF0C\u6CA1\u6709\u63D0\u4EA4\u4E8B\u52A1\u7684\u6570\u636E\u5B58\u653E\u5728\u6570\u636E\u5E93\u7684\u4E34\u65F6\u8868\u7A7A\u95F4\uFF0C<strong>\u6D88\u8017\u7684\u662F\u6570\u636E\u5E93\u670D\u52A1\u5668\u7684\u5185\u5B58\u7A7A\u95F4</strong>\uFF0C\u5728\u6700\u540E\u63D0\u4EA4\u4E8B\u52A1\u7684\u65F6\u5019\u628A\u4E34\u65F6\u8868\u7A7A\u95F4\u7684\u6570\u636E\u63D0\u4EA4\u5230\u6570\u636E\u5E93\u670D\u52A1\u7AEF\u6267\u884C\u3002</li><li>\u6279\u5904\u7406\u662F\u6307\u628A\u591A\u4E2A SQL \u8BED\u53E5\u7F13\u5B58\u8D77\u6765\uFF0C\u6700\u7EC8\u4E00\u6B21\u6027\u63D0\u4EA4\u7ED9\u6570\u636E\u5E93\uFF1B\u628A SQL \u8BED\u53E5\u7F13\u5B58\u5728 JDBC \u5BA2\u6237\u7AEF\uFF0C<strong>\u4F1A\u6D88\u8017\u5BA2\u6237\u7AEF\u7684\u5185\u5B58</strong>\uFF0C\u5728\u6700\u540E\u63D0\u4EA4\u65F6\u628A\u5BA2\u6237\u7AEF\u7F13\u5B58\u7684 SQL \u8BED\u53E5\u63D0\u4EA4\u5230\u6570\u636E\u5E93\u670D\u52A1\u7AEF\u6267\u884C\u3002</li></ul><h3 id="\u524D\u7F6E\u51C6\u5907" tabindex="-1"><a class="header-anchor" href="#\u524D\u7F6E\u51C6\u5907" aria-hidden="true">#</a> \u524D\u7F6E\u51C6\u5907</h3><p>\u7531\u4E8E\u4F1A\u4F7F\u7528\u5230\u539F\u751F\u7684 JDBC\uFF0C\u9700\u8981\u81EA\u884C\u83B7\u53D6\u8FDE\u63A5\u3001\u521B\u5EFA\u8BED\u53E5\u96C6\uFF0C\u56E0\u6B64\u6211\u5C01\u88C5\u4E86\u4E00\u4E2A HikariCP \u7684\u5DE5\u5177\u7C7B\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HikariCPUtils</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">HikariDataSource</span> dataSource<span class="token punctuation">;</span>

    <span class="token comment">/*
     * \u521D\u59CB\u5316\u6570\u636E\u6E90
     */</span>
    <span class="token keyword">static</span> <span class="token punctuation">{</span>
        <span class="token class-name">Properties</span> properties <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// \u8BFB\u53D6\u914D\u7F6E\u6587\u4EF6</span>
        <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> <span class="token class-name">HikariCPUtils</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">&quot;hikaricp.properties&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            properties<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6309\u7167Hikaricp\u7684\u914D\u7F6E\u52A0\u8F7DHikaricp\u914D\u7F6E\u7C7B</span>
            <span class="token class-name">HikariConfig</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HikariConfig</span><span class="token punctuation">(</span>properties<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// \u6839\u636E\u914D\u7F6E\u751F\u6210\u8FDE\u63A5\u6C60</span>
            dataSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HikariDataSource</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u901A\u8FC7\u6570\u636E\u6E90\u83B7\u53D6\u8FDE\u63A5
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Connection</span> <span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">SQLException</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> dataSource<span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5173\u95ED\u8FDE\u63A5
     *
     * <span class="token keyword">@param</span> <span class="token parameter">connection</span> \u6570\u636E\u5E93\u8FDE\u63A5
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token class-name">Connection</span> connection<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>connection <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                connection<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5173\u95ED\u8BED\u53E5\u96C6\u548C\u8FDE\u63A5
     * \u7531\u4E8E\u7528\u4E86\u8FDE\u63A5\u6C60\uFF0C\u8FD9\u91CC\u7684\u5173\u95ED\u8FDE\u63A5\u5176\u5B9E\u4E0D\u662F\u9500\u6BC1\uFF0C\u800C\u662F\u4EA4\u8FD8\u7ED9\u8FDE\u63A5\u6C60
     *
     * <span class="token keyword">@param</span> <span class="token parameter">statement</span>  \u8BED\u53E5\u96C6
     * <span class="token keyword">@param</span> <span class="token parameter">connection</span> \u6570\u636E\u5E93\u8FDE\u63A5
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token class-name">Statement</span> statement<span class="token punctuation">,</span> <span class="token class-name">Connection</span> connection<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>statement <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                statement<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">close</span><span class="token punctuation">(</span>connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * \u5173\u95ED\u7ED3\u679C\u96C6\u3001\u8BED\u53E5\u96C6\u548C\u8FDE\u63A5
     *
     * <span class="token keyword">@param</span> <span class="token parameter">resultSet</span>  \u7ED3\u679C\u96C6
     * <span class="token keyword">@param</span> <span class="token parameter">statement</span>  \u8BED\u53E5\u96C6
     * <span class="token keyword">@param</span> <span class="token parameter">connection</span> \u6570\u636E\u5E93\u8FDE\u63A5
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token class-name">ResultSet</span> resultSet<span class="token punctuation">,</span> <span class="token class-name">Statement</span> statement<span class="token punctuation">,</span> <span class="token class-name">Connection</span> connection<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>resultSet <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                resultSet<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token function">close</span><span class="token punctuation">(</span>statement<span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>HikariCP \u72EC\u7ACB\u7684\u914D\u7F6E\u6587\u4EF6 <code>hikaricp.properties</code></p><div class="language-properties ext-properties line-numbers-mode"><pre class="language-properties"><code><span class="token comment"># \u8FDE\u63A5\u6C60\u540D</span>
<span class="token key attr-name">poolName</span><span class="token punctuation">=</span><span class="token value attr-value">JDBC-DataSource</span>
<span class="token comment"># \u6570\u636E\u5E93\u9A71\u52A8|\u4E0D\u586B\u5199HikariCp\u4F1A\u81EA\u52A8\u8BC6\u522B</span>
<span class="token key attr-name">driverClassName</span><span class="token punctuation">=</span><span class="token value attr-value">com.mysql.cj.jdbc.Driver</span>
<span class="token comment"># \u8BBF\u95EE\u6570\u636E\u5E93\u8FDE\u63A5</span>
<span class="token key attr-name">jdbcUrl</span><span class="token punctuation">=</span><span class="token value attr-value">jdbc:mysql://localhost:3306/test?useSSL=false&amp;allowPublicKeyRetrieval=true&amp;useUnicode=true&amp;characterEncoding=utf-8&amp;serverTimezone=GMT%2B8&amp;useServerPrepStmts=true&amp;rewriteBatchedStatements=true</span>
<span class="token comment"># \u6570\u636E\u5E93\u7528\u6237\u540D</span>
<span class="token key attr-name">username</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token comment"># \u6570\u636E\u5E93\u5BC6\u7801</span>
<span class="token key attr-name">password</span><span class="token punctuation">=</span><span class="token value attr-value">root</span>
<span class="token comment"># \u6700\u5927\u8FDE\u63A5\u6570</span>
<span class="token key attr-name">maximumPoolSize</span><span class="token punctuation">=</span><span class="token value attr-value">30</span>
<span class="token comment"># \u8FDE\u63A5\u6C60\u7A7A\u95F2\u8FDE\u63A5\u7684\u6700\u5C0F\u6570\u91CF</span>
<span class="token key attr-name">minimumIdle</span><span class="token punctuation">=</span><span class="token value attr-value">5</span>
<span class="token comment"># \u5F00\u542F\u4E8B\u52A1\u81EA\u52A8\u63D0\u4EA4</span>
<span class="token key attr-name">autoCommit</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment"># \u662F\u5426\u81EA\u5B9A\u4E49\u914D\u7F6E\uFF0C\u4E3Atrue\u65F6\u4E0B\u9762\u4E24\u4E2A\u53C2\u6570\u624D\u751F\u6548</span>
<span class="token key attr-name">dataSource.cachePrepStmts</span><span class="token punctuation">=</span><span class="token value attr-value">true</span>
<span class="token comment"># \u8FDE\u63A5\u6C60\u5927\u5C0F\u9ED8\u8BA425\uFF0C\u5B98\u65B9\u63A8\u8350250-500</span>
<span class="token key attr-name">dataSource.prepStmtCacheSize</span><span class="token punctuation">=</span><span class="token value attr-value">250</span>
<span class="token comment"># \u5355\u6761\u8BED\u53E5\u6700\u5927\u957F\u5EA6\u9ED8\u8BA4256\uFF0C\u5B98\u65B9\u63A8\u83502048</span>
<span class="token key attr-name">dataSource.prepStmtCacheSqlLimit</span><span class="token punctuation">=</span><span class="token value attr-value">2048</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="mybatis-\u6279\u5904\u7406\u4E8B\u52A1\u63D0\u4EA4" tabindex="-1"><a class="header-anchor" href="#mybatis-\u6279\u5904\u7406\u4E8B\u52A1\u63D0\u4EA4" aria-hidden="true">#</a> MyBatis \u6279\u5904\u7406\u4E8B\u52A1\u63D0\u4EA4</h3><p>\u4E3A\u4E86\u65B9\u4FBF\u5728 MyBatis \u4E2D\u4F7F\u7528\u4E8B\u52A1\uFF0C\u6211\u4EEC\u9700\u8981\u91CD\u65B0\u83B7\u53D6\u4E00\u4E2A SqlSession\uFF1B\u53E6\u5916\u4E3A\u4E86\u964D\u4F4E\u5185\u5B58\u538B\u529B\uFF0C\u6279\u5904\u7406\u91C7\u7528\u5206\u6279\u63D0\u4EA4\u7684\u65B9\u5F0F\uFF0C\u5373\u628A\u4E00\u4E2A\u5927\u96C6\u5408\u5207\u5206\u6210\u591A\u4E2A\u5C0F\u96C6\u5408\u6765\u63D0\u4EA4\uFF0C\u6700\u540E\u4E00\u6B21\u6027\u63D0\u4EA4\u4E8B\u52A1\uFF0C\u628A\u63D0\u4EA4\u5230\u6570\u636E\u5E93\u7684 SQL \u8BED\u53E5\u9012\u4EA4\u7ED9 MySQL \u670D\u52A1\u7AEF\u6267\u884C\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doImport</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Maintain</span><span class="token punctuation">&gt;</span></span> maintains<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">StopWatch</span> stopWatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StopWatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  stopWatch<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// \u6309\u6BCF\u4E00\u6279\u5927\u5C0F\u5207\u5272\u539F\u96C6\u5408</span>
  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Maintain</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> lists <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">splitList</span><span class="token punctuation">(</span>maintains<span class="token punctuation">,</span> BATCH_SIZE<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// \u5F00\u542F\u6279\u91CF\u5904\u7406\u6A21\u5F0F\u3001\u5173\u95ED\u81EA\u52A8\u63D0\u4EA4\u4E8B\u52A1</span>
  <span class="token keyword">try</span> <span class="token punctuation">(</span><span class="token class-name">SqlSession</span> sqlSession <span class="token operator">=</span> sqlSessionFactory<span class="token punctuation">.</span><span class="token function">openSession</span><span class="token punctuation">(</span><span class="token class-name">ExecutorType</span><span class="token punctuation">.</span>BATCH<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u7528\u8FD9\u4E2A\u521B\u5EFA\u51FA\u6765\u7684sqlSession\u83B7\u53D6Mapper\uFF0C\u5426\u5219\u914D\u7F6E\u4E0D\u751F\u6548</span>
    <span class="token class-name">MaintainMapper</span> maintainMapper <span class="token operator">=</span> sqlSession<span class="token punctuation">.</span><span class="token function">getMapper</span><span class="token punctuation">(</span><span class="token class-name">MaintainMapper</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Maintain</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">:</span> lists<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// \u6BCF\u6B21\u63D2\u5165\u4E00\u6279\u6570\u636E</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Maintain</span> maintain <span class="token operator">:</span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        maintainMapper<span class="token punctuation">.</span><span class="token function">insert</span><span class="token punctuation">(</span>maintain<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// \u6E05\u9664statementList</span>
      sqlSession<span class="token punctuation">.</span><span class="token function">flushStatements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// \u63D0\u4EA4\u4E8B\u52A1</span>
    sqlSession<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    exception<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    stopWatch<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MyBatis\u6279\u5904\u7406\u4E8B\u52A1\u63D2\u5165\u65B9\u5F0F\u82B1\u8D39\u65F6\u95F4 ==&gt; &quot;</span> <span class="token operator">+</span> stopWatch<span class="token punctuation">.</span><span class="token function">getLastTaskTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">List</span><span class="token punctuation">&lt;</span><span class="token class-name">Maintain</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> <span class="token function">splitList</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Maintain</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">,</span> <span class="token keyword">int</span> splitSize<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//\u5224\u65AD\u96C6\u5408\u662F\u5426\u4E3A\u7A7A</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">CollectionUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// \u8BA1\u7B97\u5206\u5272\u7684\u4EFD\u6570</span>
  <span class="token comment">// (\u603B\u6570+\u6BCF\u4E00\u4EFD\u7684\u6570\u91CF-1) / \u6BCF\u4E00\u4EFD\u7684\u6570\u91CF</span>
  <span class="token keyword">int</span> maxSize <span class="token operator">=</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> splitSize <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">/</span> splitSize<span class="token punctuation">;</span>
  <span class="token comment">//\u5F00\u59CB\u5206\u5272</span>
  <span class="token keyword">return</span>
    <span class="token comment">// \u751F\u6210\u4E00\u4E2A\u4ECE0\u5F00\u59CB\uFF0C\u957F\u5EA6\u4E3A\u5207\u5272\u4EFD\u6570\u7684\u5E8F\u5217</span>
    <span class="token class-name">Stream</span><span class="token punctuation">.</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> integer <span class="token operator">-&gt;</span> integer <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span>maxSize<span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">parallel</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// \u4ECE\u6570\u5B57\u8F6C\u6362\u6210\u96C6\u5408</span>
    <span class="token comment">// \u6BCF\u4E00\u4EFD\u96C6\u5408\u90FD\u8DF3\u8FC7\u524D(n*\u6BCF\u4E00\u4EFD\u6570\u91CF)\uFF0C\u7136\u540E\u53D6\u6BCF\u4E00\u4EFD\u6570\u91CF</span>
    <span class="token comment">// \u6BD4\u5982\uFF0C\u7B2C\u4E00\u4EFD\u96C6\u5408\u662F\u8DF3\u8FC7(0*1000=0)\u4E2A\u5143\u7D20\uFF0C\u5F80\u540E\u53D61000\u4E2A\u5143\u7D20\uFF0C\u5C31\u662F\u7B2C1\u4E2A-\u7B2C1000\u4E2A\u5143\u7D20\u7EC4\u6210\u4E86\u7B2C\u4E00\u4EFD\u96C6\u5408</span>
    <span class="token comment">// \u7B2C\u4E8C\u4EFD\u96C6\u5408\u662F\u8DF3\u8FC7(1*1000)\u4E2A\u5143\u7D20\uFF0C\u5F80\u540E\u53D61000\u4E2A\u5143\u7D20\uFF0C\u5C31\u662F\u7B2C1001\u4E2A-\u7B2C2000\u4E2A\u5143\u7D20\u7EC4\u6210\u4E86\u7B2C\u4E8C\u4EFD\u96C6\u5408</span>
    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>integer <span class="token operator">-&gt;</span> list<span class="token punctuation">.</span><span class="token function">parallelStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">skip</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">long</span><span class="token punctuation">)</span> integer <span class="token operator">*</span> splitSize<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">limit</span><span class="token punctuation">(</span>splitSize<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>subList <span class="token operator">-&gt;</span> <span class="token operator">!</span>subList<span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">collect</span><span class="token punctuation">(</span><span class="token class-name">Collectors</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-xml ext-xml line-numbers-mode"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>insert</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>insertBatchMaintain<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  insert into batch_maintain (maintain_num, maintain_name, equipment_num, maintain_type, functionary,
  maintain_duration, start_time, end_time, maintain_status)
  values
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>foreach</span> <span class="token attr-name">collection</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>maintainList<span class="token punctuation">&#39;</span></span> <span class="token attr-name">item</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>maintain<span class="token punctuation">&#39;</span></span> <span class="token attr-name">separator</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&#39;</span>,<span class="token punctuation">&#39;</span></span><span class="token punctuation">&gt;</span></span>
    (#{maintain.maintainNum}, #{maintain.maintainName}, #{maintain.equipmentNum}, #{maintain.maintainType},
    #{maintain.functionary}, #{maintain.maintainDuration}, #{maintain.startTime}, #{maintain.endTime},
    #{maintain.maintainStatus})
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>foreach</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>insert</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>\u6570\u636E\u91CF/\u63D2\u5165\u65F6\u95F4(\u6BEB\u79D2)</th><th>\u7B2C\u4E00\u6B21</th><th>\u7B2C\u4E8C\u6B21</th><th>\u7B2C\u4E09\u6B21</th></tr></thead><tbody><tr><td>5w\u6761</td><td>7698</td><td>7629</td><td>7493</td></tr><tr><td>10w\u6761</td><td>15694</td><td>15887</td><td>15339</td></tr><tr><td>20w\u6761</td><td>24564</td><td>22924</td><td>26506</td></tr><tr><td>40w\u6761</td><td>55419</td><td>57856</td><td>57416</td></tr></tbody></table><h3 id="mybatis-plus-\u6279\u5904\u7406\u4E8B\u52A1\u63D0\u4EA4" tabindex="-1"><a class="header-anchor" href="#mybatis-plus-\u6279\u5904\u7406\u4E8B\u52A1\u63D0\u4EA4" aria-hidden="true">#</a> MyBatis-Plus \u6279\u5904\u7406\u4E8B\u52A1\u63D0\u4EA4</h3><p>\u8FD9\u91CC\u6CA1\u6709\u663E\u5F0F\u5730\u63A7\u5236\u4E8B\u52A1\uFF0C\u4E3A\u4EC0\u4E48\u4E5F\u662F\u4E8B\u52A1\u63D0\u4EA4\u5462\uFF1F\u5BF9\u5E95\u5C42\u6E90\u7801\u67E5\u770B\u5230 <code>saveBatch()</code> \u65B9\u6CD5\u662F\u5229\u7528\u5206\u7247\u5904\u7406\uFF08\u9ED8\u8BA4 batchSize \u662F 1000\uFF09 + <strong>\u5206\u6279\u63D0\u4EA4\u4E8B\u52A1</strong>\uFF08\u5F53\u5904\u7406\u7684\u6570\u636E\u8FBE\u5230 batchSize \u65F6\u4F1A\u89E6\u53D1 <code>flushStatements()</code> \u65B9\u6CD5\uFF09\u7684\u64CD\u4F5C\uFF0C\u4ECE\u800C\u63D0\u9AD8\u6027\u80FD\u3002</p><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doImport</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Maintain</span><span class="token punctuation">&gt;</span></span> maintains<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">StopWatch</span> stopWatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StopWatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  stopWatch<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u4F7F\u7528MyBatis-Plus\u5C01\u88C5\u7684\u6279\u5904\u7406\u65B9\u6CD5</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>maintainService<span class="token punctuation">.</span><span class="token function">saveBatch</span><span class="token punctuation">(</span>maintains<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    exception<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    stopWatch<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;MyBatis-Plus\u6279\u5904\u7406\u63D2\u5165\u65B9\u5F0F\u82B1\u8D39\u65F6\u95F4 ==&gt; &quot;</span> <span class="token operator">+</span> stopWatch<span class="token punctuation">.</span><span class="token function">getLastTaskTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>\u6570\u636E\u91CF/\u63D2\u5165\u65F6\u95F4(\u6BEB\u79D2)</th><th>\u7B2C\u4E00\u6B21</th><th>\u7B2C\u4E8C\u6B21</th><th>\u7B2C\u4E09\u6B21</th></tr></thead><tbody><tr><td>5w\u6761</td><td>6703</td><td>6408</td><td>6445</td></tr><tr><td>10w\u6761</td><td>11355</td><td>11657</td><td>11493</td></tr><tr><td>20w\u6761</td><td>22735</td><td>22482</td><td>24238</td></tr><tr><td>40w\u6761</td><td>51405</td><td>51292</td><td>50074</td></tr></tbody></table><h3 id="jdbc-\u6279\u5904\u7406\u76F4\u63A5\u63D0\u4EA4" tabindex="-1"><a class="header-anchor" href="#jdbc-\u6279\u5904\u7406\u76F4\u63A5\u63D0\u4EA4" aria-hidden="true">#</a> JDBC \u6279\u5904\u7406\u76F4\u63A5\u63D0\u4EA4</h3><p>JDBC \u6279\u91CF\u63D0\u4EA4\u7684\u65B9\u5F0F\u662F</p><ol><li>\u4F7F\u7528 <code>addBatch()</code> \u65B9\u6CD5\u628A\u8BED\u53E5\u653E\u5230\u7F13\u5B58\u533A</li><li>\u8C03\u7528 <code>executeBatch()</code> \u65B9\u6CD5\u4E00\u6B21\u6027\u628A\u8FD9\u4E9B\u8BED\u53E5\u90FD\u63D0\u4EA4\u5230\u6570\u636E\u5E93</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doImport</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Maintain</span><span class="token punctuation">&gt;</span></span> maintains<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">StopWatch</span> stopWatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StopWatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token class-name">PreparedStatement</span> preparedStatement <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  stopWatch<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    connection <span class="token operator">=</span> <span class="token class-name">HikariCPUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;insert into batch_maintain (maintain_num, maintain_name, equipment_num, maintain_type, functionary, maintain_duration, start_time, end_time, maintain_status) values (?, ?, ?, ?, ?, ?, ?, ?, ?)&quot;</span><span class="token punctuation">;</span>
    preparedStatement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Maintain</span> maintain <span class="token operator">:</span> maintains<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getMaintainNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getMaintainName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setLong</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getEquipmentNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getMaintainType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getFunctionary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getMaintainDuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setTimestamp</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token class-name">Timestamp</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>maintain<span class="token punctuation">.</span><span class="token function">getStartTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token class-name">ZoneOffset</span><span class="token punctuation">.</span><span class="token function">ofHours</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setTimestamp</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token class-name">Timestamp</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>maintain<span class="token punctuation">.</span><span class="token function">getEndTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token class-name">ZoneOffset</span><span class="token punctuation">.</span><span class="token function">ofHours</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setBoolean</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getMaintainStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// \u63D0\u4EA4\u5230\u7F13\u5B58\u533A</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">addBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      count<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">%</span> BATCH_SIZE <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u4E00\u6B21\u6027\u63D0\u4EA4\u7F13\u5B58\u533A\u4E2D\u7684SQL\u8BED\u53E5</span>
        preparedStatement<span class="token punctuation">.</span><span class="token function">executeBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">executeBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    exception<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    stopWatch<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HikariCPUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>preparedStatement<span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;jdbc\u6279\u5904\u7406\u63D2\u5165\u65B9\u5F0F\u82B1\u8D39\u65F6\u95F4 ==&gt; &quot;</span> <span class="token operator">+</span> stopWatch<span class="token punctuation">.</span><span class="token function">getLastTaskTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>\u6570\u636E\u91CF/\u63D2\u5165\u65F6\u95F4(\u6BEB\u79D2)</th><th>\u7B2C\u4E00\u6B21</th><th>\u7B2C\u4E8C\u6B21</th><th>\u7B2C\u4E09\u6B21</th></tr></thead><tbody><tr><td>5w\u6761</td><td>3397</td><td>3350</td><td>3240</td></tr><tr><td>10w\u6761</td><td>9199</td><td>8993</td><td>9052</td></tr><tr><td>20w\u6761</td><td>17421</td><td>17817</td><td>17676</td></tr><tr><td>40w\u6761</td><td>31198</td><td>32074</td><td>32561</td></tr></tbody></table><h3 id="jdbc-\u6279\u5904\u7406\u4E8B\u52A1\u63D0\u4EA4" tabindex="-1"><a class="header-anchor" href="#jdbc-\u6279\u5904\u7406\u4E8B\u52A1\u63D0\u4EA4" aria-hidden="true">#</a> JDBC \u6279\u5904\u7406\u4E8B\u52A1\u63D0\u4EA4</h3><p>JDBC \u4E8B\u52A1\u63D0\u4EA4\u4F7F\u7528\u65B9\u5F0F\u4E5F\u5F88\u7B80\u5355</p><ol><li><code>connection.setAutoCommit(false)</code> \u8BBE\u7F6E\u624B\u52A8\u63D0\u4EA4</li><li><code>connection.commit()</code> \u6267\u884C\u6279\u5904\u7406\u540E\u63D0\u4EA4\u4E8B\u52A1</li></ol><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doImport</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Maintain</span><span class="token punctuation">&gt;</span></span> maintains<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token class-name">StopWatch</span> stopWatch <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StopWatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">Connection</span> connection <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token class-name">PreparedStatement</span> preparedStatement <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  stopWatch<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">try</span> <span class="token punctuation">{</span>
    connection <span class="token operator">=</span> <span class="token class-name">HikariCPUtils</span><span class="token punctuation">.</span><span class="token function">getConnection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// \u5F00\u542F\u4E8B\u52A1\u624B\u52A8\u63D0\u4EA4</span>
    connection<span class="token punctuation">.</span><span class="token function">setAutoCommit</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> sql <span class="token operator">=</span> <span class="token string">&quot;insert into batch_maintain (maintain_num, maintain_name, equipment_num, maintain_type, functionary, maintain_duration, start_time, end_time, maintain_status) values (?, ?, ?, ?, ?, ?, ?, ?, ?)&quot;</span><span class="token punctuation">;</span>
    preparedStatement <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">prepareStatement</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Maintain</span> maintain <span class="token operator">:</span> maintains<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getMaintainNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getMaintainName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setLong</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getEquipmentNum</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setInt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getMaintainType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getFunctionary</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setString</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getMaintainDuration</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setTimestamp</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">,</span> <span class="token class-name">Timestamp</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>maintain<span class="token punctuation">.</span><span class="token function">getStartTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token class-name">ZoneOffset</span><span class="token punctuation">.</span><span class="token function">ofHours</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setTimestamp</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token class-name">Timestamp</span><span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>maintain<span class="token punctuation">.</span><span class="token function">getEndTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toInstant</span><span class="token punctuation">(</span><span class="token class-name">ZoneOffset</span><span class="token punctuation">.</span><span class="token function">ofHours</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">setBoolean</span><span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">,</span> maintain<span class="token punctuation">.</span><span class="token function">getMaintainStatus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">addBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      count<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">%</span> BATCH_SIZE <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// \u4E00\u6B21\u6027\u63D0\u4EA4\u7F13\u5B58\u533A\u4E2D\u7684SQL\u8BED\u53E5</span>
        preparedStatement<span class="token punctuation">.</span><span class="token function">executeBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      preparedStatement<span class="token punctuation">.</span><span class="token function">executeBatch</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// \u63D0\u4EA4\u4E8B\u52A1</span>
    connection<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SQLException</span> exception<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    exception<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
    stopWatch<span class="token punctuation">.</span><span class="token function">stop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HikariCPUtils</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span>preparedStatement<span class="token punctuation">,</span> connection<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;jdbc\u6279\u5904\u7406\u4E8B\u52A1\u63D2\u5165\u65B9\u5F0F\u82B1\u8D39\u65F6\u95F4 ==&gt; &quot;</span> <span class="token operator">+</span> stopWatch<span class="token punctuation">.</span><span class="token function">getLastTaskTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><table><thead><tr><th>\u6570\u636E\u91CF/\u63D2\u5165\u65F6\u95F4(\u6BEB\u79D2)</th><th>\u7B2C\u4E00\u6B21</th><th>\u7B2C\u4E8C\u6B21</th><th>\u7B2C\u4E09\u6B21</th></tr></thead><tbody><tr><td>5w\u6761</td><td>3240</td><td>3428</td><td>3153</td></tr><tr><td>10w\u6761</td><td>6606</td><td>6281</td><td>7160</td></tr><tr><td>20w\u6761</td><td>12014</td><td>14157</td><td>14655</td></tr><tr><td>40w\u6761</td><td>23317</td><td>25490</td><td>22860</td></tr></tbody></table><h3 id="\u603B\u7ED3" tabindex="-1"><a class="header-anchor" href="#\u603B\u7ED3" aria-hidden="true">#</a> \u603B\u7ED3</h3><ul><li><p>\u4F7F\u7528 MyBatis \u7684\u65B9\u5F0F\u4F7F\u7528\u6279\u91CF\u63D0\u4EA4 insert \u8BED\u53E5\u800C\u4E0D\u662F\u6279\u91CF\u62FC\u63A5 insert \u8BED\u53E5\u7684 value\uFF0C\u4E3B\u8981\u7684\u8003\u91CF\u662F\u6570\u636E\u5E93\u670D\u52A1\u7AEF\u89E3\u6790\u957F\u7684 SQL \u8BED\u53E5\u4F1A\u66F4\u52A0\u8017\u65F6\u3002\u8BDA\u7136\u4F7F\u7528 insert \u8BED\u53E5\u62FC\u63A5 value \u7684\u8BDD\uFF0C\u63D0\u4EA4\u5230\u670D\u52A1\u5668\u4E0A\u7684 insert \u8BED\u53E5\u5C11\u4E86\uFF0C\u7F51\u7EDC\u8D1F\u8F7D\u5C11\u4E86\uFF0C\u6027\u80FD\u4E5F\u80FD\u63D0\u4E0A\u53BB\uFF0C<strong>\u4F46\u662F\u8FD9\u662F\u5EFA\u7ACB\u5728\u6570\u636E\u91CF\u4E0D\u5927\u7684\u60C5\u51B5\u4E0B</strong>\uFF0C\u5F53\u6570\u636E\u91CF\u53D8\u5927\uFF0C\u8FD9\u6761 insert \u8BED\u53E5\u4F1A\u53D8\u5F97\u5F88\u957F\uFF0C<code>innodb_buffer_pool_size</code> \u6709\u9650\u5236\uFF0C\u8FC7\u957F\u7684 SQL \u5728\u5199\u64CD\u4F5C\u7684\u65F6\u5019\u7531\u4E8E<strong>\u8D85\u8FC7\u5185\u5B58\u9608\u503C</strong>\uFF0C\u53D1\u751F\u4E86\u78C1\u76D8\u4EA4\u6362\u3002\u6240\u4EE5\u5355\u7EAF value \u62FC\u63A5\u65B9\u6848\u96BE\u4EE5\u7ECF\u53D7\u5927\u91CF\u6570\u636E\u7684\u8003\u9A8C\uFF0C\u53EA\u80FD\u5728\u7279\u5B9A\u6570\u91CF\u4E4B\u5185\u5B89\u5168\u7684\u63D0\u5347\u6027\u80FD\uFF0C\u8FD9\u4E48\u770B MyBatis-Plus \u9ED8\u8BA4\u65B9\u6848\u7684\u9009\u62E9\u4E5F\u6709\u4E00\u5B9A\u7684\u9053\u7406\u3002</p></li><li><p>\u4ECE\u7ED3\u679C\u770B JDBC \u539F\u751F\u8981\u6BD4 MyBatis-Plus \u66F4\u5FEB\uFF0C\u539F\u56E0\u53EF\u80FD\u662F MyBatis-Plus \u7684\u65B9\u6CD5\u5728\u5904\u7406\u6570\u636E\u63D2\u5165\u64CD\u4F5C\u65F6\uFF0C\u9700\u8981\u8FDB\u884C ORM \u8F6C\u6362\uFF0C\u6548\u7387\u4E00\u822C\uFF1B\u539F\u751F\u7684 JDBC \u76F4\u63A5\u4F7F\u7528 SQL \u8BED\u53E5\uFF0C\u65E0\u9700\u8F6C\u6362\uFF0C\u6548\u7387\u66F4\u9AD8\u3002</p></li><li><p>\u5728\u6279\u5904\u7406\u4E2D\uFF0C\u5C3D\u7BA1\u4F7F\u7528\u4E8B\u52A1\u548C\u4E0D\u4F7F\u7528\u4E8B\u52A1\u603B\u4F53\u4E0A\u65F6\u95F4\u5DEE\u8DDD\u4E0D\u5927\uFF08\u53EF\u80FD\u9700\u8981\u589E\u5927\u6D4B\u8BD5\u7684\u6570\u636E\u91CF\uFF09\uFF0C\u4F46\u8FD8\u662F\u8981\u6BD4\u4E0D\u4F7F\u7528\u4E8B\u52A1\u5FEB\u4E00\u70B9\u70B9\uFF1B\u800C\u5B9E\u9645\u4E0A\u5728\u5FAA\u73AF\u5355\u6761\u63D2\u5165\u65F6\u901F\u5EA6\u5DEE\u5F02\u66F4\u5927\uFF0C\u539F\u56E0\u662F\u5728\u5FAA\u73AF\u5355\u6761\u63D2\u5165\u65F6 MySQL \u628A\u6BCF\u4E00\u4E2A\u63D2\u5165\u64CD\u4F5C\u90FD\u770B\u6210\u662F\u4E00\u4E2A\u4E8B\u52A1\uFF0C\u8FD9\u610F\u5473\u7740\u6BCF\u4E00\u4E2A\u63D2\u5165\u64CD\u4F5C\u90FD\u9700\u8981\u628A\u65E5\u5FD7\u6570\u636E\u5199\u5165\u78C1\u76D8\uFF0C\u800C\u4F7F\u7528\u4E8B\u52A1\u63D0\u4EA4\u65F6\uFF0C\u8FD9\u4E9B\u6240\u6709\u7684\u63D2\u5165\u64CD\u4F5C\u90FD\u53EA\u8FDB\u884C\u4E00\u6B21\u65E5\u5FD7\u6570\u636E\u7684\u5199\u5165\uFF0CIO \u6B21\u6570\u66F4\u5C11\uFF0C\u6548\u7387\u4E5F\u5C31\u66F4\u9AD8\u3002</p></li><li><p>\u5176\u4E2D\u4F7F\u7528\u6279\u5904\u7406\u65F6\u975E\u5E38\u503C\u5F97\u8003\u8651\u4E00\u4E2A\u95EE\u9898\u5C31\u662F\u5206\u6279\u63D0\u4EA4\uFF0C\u867D\u7136\u8FD9\u4F1A\u6BD4\u76F4\u63A5\u6279\u5904\u7406\u8981\u6162\u4E00\u70B9\uFF0C\u4F46\u662F\u7531\u4E8E\u6570\u636E\u5E93\u6BCF\u6B21\u63A5\u6536\u7684 SQL \u8BED\u53E5\u7684\u6570\u91CF\u662F\u6709\u4E0A\u9650\u7684\uFF0C\u5982\u679C\u6279\u5904\u7406\u63D0\u4EA4\u7684\u6570\u91CF\u8D85\u51FA\u8FD9\u4E2A\u4E0A\u9650\uFF0C\u90A3\u4E48\u5F88\u53EF\u80FD\u5BFC\u81F4\u6570\u636E\u5E93\u62D2\u7EDD\u8FD9\u4E00\u6279\u6570\u636E\u5E76\u629B\u51FA\u5F02\u5E38\uFF0C\u67E5\u770B MySQL \u4E00\u6B21\u53D1\u9001\u7684\u6570\u636E\u5305\u7684\u5927\u5C0F\u4E0A\u9650\u7684\u8BED\u53E5\uFF1A <code>SHOW VARIABLES LIKE &#39;%max_allowed_packet%&#39;;</code> \u3002\u53E6\u5916\u628A\u5927\u91CF\u7684\u6570\u636E\u5206\u6210\u591A\u6279\u8FDB\u884C\u6279\u5904\u7406\u4E5F\u80FD\u6709\u6548\u964D\u4F4E JDBC \u5BA2\u6237\u7AEF\u7684\u5185\u5B58\u538B\u529B\u3002</p></li><li><p>\u5728\u5904\u7406\u5927\u6279\u91CF\u6570\u636E\u65F6\uFF0C<strong>\u5EFA\u8BAE\u4F7F\u7528\u539F\u751F JDBC \u6279\u91CF + \u5206\u6279 + \u4E8B\u52A1\u63D0\u4EA4</strong>\uFF0C\u65E2\u80FD\u4FDD\u8BC1\u6548\u7387\uFF0C\u53C8\u80FD\u5C3D\u53EF\u80FD\u907F\u514D\u51FA\u73B0\u5185\u5B58\u6CC4\u6F0F\u7B49\u95EE\u9898\u3002</p></li></ul><h2 id="\u53C2\u8003\u94FE\u63A5" tabindex="-1"><a class="header-anchor" href="#\u53C2\u8003\u94FE\u63A5" aria-hidden="true">#</a> \u53C2\u8003\u94FE\u63A5</h2>`,43),k={href:"https://dandelioncloud.cn/article/details/1482640589962424322",target:"_blank",rel:"noopener noreferrer"},r=t("\u53F7\u79F0\u5168\u7F51\u6700\u5FEB\u7684\u6570\u636E\u5E93\u8FDE\u63A5\u6C60HikariCP\u7684\u5DE5\u5177\u7C7B\u5F00\u53D1-HikariCPUtils"),d={href:"https://blog.csdn.net/LJFPHP/article/details/99708888",target:"_blank",rel:"noopener noreferrer"},m=t("mysql\u6279\u91CF\u63D2\u5165\u6570\u636E\uFF0C\u4E00\u6B21\u63D2\u5165\u591A\u5C11\u884C\u6570\u636E\u6548\u7387\u6700\u9AD8\uFF1F"),v={href:"https://cdn.modb.pro/db/175259",target:"_blank",rel:"noopener noreferrer"},b=t("MyBatis-Plus \u6279\u5904\u7406\u6709\u5751\uFF0C\u6211\u6559\u4F60\u6539\u9020"),h={href:"https://www.cnblogs.com/chenjianjx/archive/2012/08/14/2637914.html",target:"_blank",rel:"noopener noreferrer"},f=t("\u4ECB\u7ECDMySQL Jdbc\u9A71\u52A8\u7684rewriteBatchedStatements\u53C2\u6570");function y(S,g){const s=e("ExternalLinkIcon");return c(),o("div",null,[u,n("p",null,[n("a",k,[r,a(s)])]),n("p",null,[n("a",d,[m,a(s)])]),n("p",null,[n("a",v,[b,a(s)])]),n("p",null,[n("a",h,[f,a(s)])])])}var _=p(l,[["render",y],["__file","MySQL-batch-insert.html.vue"]]);export{_ as default};
